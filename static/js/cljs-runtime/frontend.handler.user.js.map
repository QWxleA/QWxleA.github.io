{"version":3,"sources":["frontend/handler/user.cljs"],"mappings":"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","names":["frontend.handler.user/set-preferred-format!","format","frontend.handler.config/set-config!","frontend.state/set-preferred-format!","frontend.handler.user/set-preferred-workflow!","workflow","frontend.state/set-preferred-workflow!","frontend.handler.user/parse-jwt","jwt","G__63928","clojure.string.split","cljs.core/second","js/atob","js/JSON.parse","cljs.core.js__GT_clj","frontend.handler.user/expired?","parsed-jwt","G__63932","cljs-time.coerce/from-long","cljs-time.core/before?","cljs-time.core/now","frontend.handler.user/almost-expired?","G__63937","cljs_time.core.hours","cljs-time.core/from-now","frontend.handler.user/email","G__63938","frontend.state/get-auth-id-token","frontend.handler.user/user-uuid","G__63939","frontend.handler.user/logged-in?","cljs.core/boolean","G__63940","cljs.core/not","frontend.handler.user/clear-tokens","frontend.state/set-auth-id-token","frontend.state/set-auth-access-token","frontend.state/set-auth-refresh-token","var_args","G__63946","frontend.handler.user/set-tokens!","js/Error","id-token","access-token","refresh-token","frontend.handler.user/login-callback","code","c__41861__auto__","cljs.core.async.chan","cljs.core.async.impl.dispatch/run","f__41862__auto__","switch__41838__auto__","state_63970","state_val_63971","inst_63950","inst_63951","inst_63952","inst_63953","cljs.core/PersistentHashMap","inst_63954","cljs.core.async.impl.ioc-helpers/take!","inst_63956","inst_63957","inst_63958","statearr-63972","statearr-63974","statearr-63978","inst_63960","inst_63961","inst_63962","inst_63963","inst_63964","statearr-63989","inst_63966","statearr-63990","inst_63968","cljs.core.async.impl.ioc-helpers/return-chan","statearr-63994","state-machine__41839__auto__","ret-value__41840__auto__","result__41841__auto__","cljs.core/keyword-identical?","ex__41842__auto__","e63995","statearr-63996","cljs.core/seq","statearr-63997","cljs.core/first","state__41863__auto__","statearr-64001","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","cljs_http.client.get","frontend.config/API-DOMAIN","cljs.core._EQ_","frontend.handler.user.set_tokens_BANG_","frontend.debug.pprint","frontend.handler.user/logout","frontend.handler.user/refresh-id-token&access-token","temp__5720__auto__","frontend.state/get-auth-refresh-token","state_64029","state_val_64030","inst_64004","inst_64005","inst_64006","inst_64007","inst_64008","inst_64010","inst_64011","inst_64012","statearr-64031","statearr-64033","statearr-64034","inst_64014","statearr-64035","statearr-64036","inst_64017","inst_64016","statearr-64037","statearr-64038","statearr-64039","inst_64027","statearr-64040","statearr-64041","inst_64021","inst_64022","inst_64023","inst_64024","inst_64025","statearr-64042","statearr-64043","statearr-64045","e64046","statearr-64047","statearr-64048","statearr-64054","cljs-http.client/unexceptional-status?","frontend.handler.user/stop-refresh","frontend.handler.user/refresh-tokens-loop","state_64114","state_val_64115","inst_64103","statearr-64116","statearr-64118","statearr-64120","statearr-64123","inst_64060","inst_64061","statearr-64125","statearr-64126","statearr-64128","statearr-64129","inst_64100","statearr-64131","statearr-64134","inst_64112","statearr-64136","inst_64058","inst_64091","inst_64092","inst_64093","inst_64094","inst_64096","statearr-64138","statearr-64139","inst_64064","inst_64075","inst_64076","statearr-64140","inst_64071","statearr-64143","statearr-64144","statearr-64145","statearr-64146","inst_64109","statearr-64147","inst_64078","statearr-64148","statearr-64149","statearr-64150","statearr-64151","e64152","statearr-64153","statearr-64155","statearr-64157","cljs.core.async/timeout","cljs-time.coerce/to-string"],"sourcesContent":["(ns frontend.handler.user\n  (:require [frontend.config :as config]\n            [frontend.handler.config :as config-handler]\n            [frontend.state :as state]\n            [frontend.debug :as debug]\n            [clojure.string :as string]\n            [cljs-time.core :as t]\n            [cljs-time.coerce :as tc]\n            [cljs-http.client :as http]\n            [cljs.core.async :as async :refer [go go-loop <! timeout]]))\n\n(defn set-preferred-format!\n  [format]\n  (when format\n    (config-handler/set-config! :preferred-format format)\n    (state/set-preferred-format! format)))\n\n(defn set-preferred-workflow!\n  [workflow]\n  (when workflow\n    (config-handler/set-config! :preferred-workflow workflow)\n    (state/set-preferred-workflow! workflow)))\n\n;;; userinfo, token, login/logout, ...\n\n(defn- parse-jwt [jwt]\n  (some-> jwt\n          (string/split \".\")\n          (second)\n          (js/atob)\n          (js/JSON.parse)\n          (js->clj :keywordize-keys true)))\n\n(defn- expired? [parsed-jwt]\n  (some->\n   (* 1000 (:exp parsed-jwt))\n   (tc/from-long)\n   (t/before? (t/now))))\n\n(defn- almost-expired?\n  \"return true when jwt will expire after 1h\"\n  [parsed-jwt]\n  (some->\n   (* 1000 (:exp parsed-jwt))\n   (tc/from-long)\n   (t/before? (-> 1 t/hours t/from-now))))\n\n(defn email []\n  (some->\n   (state/get-auth-id-token)\n   (parse-jwt)\n   (:email)))\n\n(defn user-uuid []\n  (some->\n   (state/get-auth-id-token)\n   (parse-jwt)\n   (:sub)))\n\n(defn logged-in? []\n  (boolean\n   (some->\n    (state/get-auth-id-token)\n    (parse-jwt)\n    (expired?)\n    (not))))\n\n(defn- clear-tokens []\n  (state/set-auth-id-token nil)\n  (state/set-auth-access-token nil)\n  (state/set-auth-refresh-token nil))\n\n(defn- set-tokens!\n  ([id-token access-token]\n   (state/set-auth-id-token id-token)\n   (state/set-auth-access-token access-token))\n  ([id-token access-token refresh-token]\n   (state/set-auth-id-token id-token)\n   (state/set-auth-access-token access-token)\n   (state/set-auth-refresh-token refresh-token)))\n\n(defn login-callback [code]\n  (go\n    (let [resp (<! (http/get (str \"https://\" config/API-DOMAIN \"/auth_callback?code=\" code)\n                             {:with-credentials? false}))]\n      (if (= 200 (:status resp))\n        (-> resp\n            :body\n            (as-> $ (set-tokens! (:id_token $) (:access_token $) (:refresh_token $))))\n        (debug/pprint \"login-callback\" resp)))))\n\n(defn logout []\n  (clear-tokens))\n\n(defn refresh-id-token&access-token\n  \"refresh id-token and access-token, if refresh_token expired, clear all tokens\n   return true if success, else false\"\n  []\n  (when-let [refresh-token (state/get-auth-refresh-token)]\n    (go\n      (let [resp (<! (http/get (str \"https://\" config/API-DOMAIN \"/auth_refresh_token?refresh_token=\" refresh-token)\n                               {:with-credentials? false}))]\n        (if (= 400 (:status resp))\n          ;; invalid refresh_token\n          (do\n            (clear-tokens)\n            false)\n          (do\n            (->\n             resp\n             (as-> $ (and (http/unexceptional-status? (:status $)) $))\n             :body\n             (as-> $ (set-tokens! (:id_token $) (:access_token $))))\n            true))))))\n\n;;; refresh tokens loop\n(def stop-refresh false)\n(defn refresh-tokens-loop []\n  (debug/pprint \"start refresh-tokens-loop\")\n  (go-loop []\n    (<! (timeout 60000))\n    (when (state/get-auth-refresh-token)\n      (let [id-token (state/get-auth-id-token)]\n        (when (or (nil? id-token)\n                  (-> id-token (parse-jwt) (almost-expired?)))\n          (debug/pprint (str \"refresh tokens... \" (tc/to-string(t/now))))\n          (refresh-id-token&access-token))))\n    (when-not stop-refresh\n      (recur))))\n"]}