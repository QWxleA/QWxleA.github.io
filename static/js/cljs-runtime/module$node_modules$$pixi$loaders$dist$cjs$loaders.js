shadow$provide.module$node_modules$$pixi$loaders$dist$cjs$loaders=function(global,require,module,exports){function _addSignalBinding(self,node){self._head?(self._tail._next=node,node._prev=self._tail):self._head=node;self._tail=node;node._owner=self;return node}function parseUri(str,opts){opts=opts||{};var JSCompiler_object_inline_key_4513="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");str={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}[opts.strictMode?"strict":"loose"].exec(str);var uri={};for(opts=14;opts--;)uri[JSCompiler_object_inline_key_4513[opts]]=str[opts]||"";uri.queryKey={};uri[JSCompiler_object_inline_key_4513[12]].replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(_t0,t1,t2){t1&&(uri.queryKey[t1]=t2)});return uri}function _noop(){}
function setExtMap(map,extname,val){extname&&0===extname.indexOf(".")&&(extname=extname.substring(1));extname&&(map[extname]=val)}function reqType(xhr){return xhr.toString().replace("object ","")}function _noop$1(){}function onlyOnce(fn){return function(){for(var arguments$1=arguments,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments$1[_i];if(null===fn)throw Error("Callback was already called.");arguments$1=fn;fn=null;arguments$1.apply(this,args)}}function encodeBinary(input){for(var output=
"",inx=0;inx<input.length;){for(var bytebuffer=[0,0,0],encodedCharIndexes=[0,0,0,0],jnx=0;jnx<bytebuffer.length;++jnx)bytebuffer[jnx]=inx<input.length?input.charCodeAt(inx++)&255:0;encodedCharIndexes[0]=bytebuffer[0]>>2;encodedCharIndexes[1]=(bytebuffer[0]&3)<<4|bytebuffer[1]>>4;encodedCharIndexes[2]=(bytebuffer[1]&15)<<2|bytebuffer[2]>>6;encodedCharIndexes[3]=bytebuffer[2]&63;switch(inx-(input.length-1)){case 2:encodedCharIndexes[3]=64;encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=
64}for(jnx=0;jnx<encodedCharIndexes.length;++jnx)output+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(encodedCharIndexes[jnx])}return output}Object.defineProperty(exports,"__esModule",{value:!0});var core=require("module$node_modules$$pixi$core$dist$cjs$core"),SignalBinding=function(){function SignalBinding(fn,once,thisArg){void 0===once&&(once=!1);this._fn=fn;this._once=once;this._thisArg=thisArg;this._next=this._prev=this._owner=null}SignalBinding.prototype.detach=
function(){if(null===this._owner)return!1;this._owner.detach(this);return!0};return SignalBinding}(),Signal=function(){function Signal(){this._head=this._tail=void 0}Signal.prototype.handlers=function(exists){void 0===exists&&(exists=!1);var node=this._head;if(exists)return!!node;for(exists=[];node;)exists.push(node),node=node._next;return exists};Signal.prototype.has=function(node){if(!(node instanceof SignalBinding))throw Error("MiniSignal#has(): First arg must be a SignalBinding object.");return node._owner===
this};Signal.prototype.dispatch=function(){for(var arguments$1=arguments,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments$1[_i];arguments$1=this._head;if(!arguments$1)return!1;for(;arguments$1;)arguments$1._once&&this.detach(arguments$1),arguments$1._fn.apply(arguments$1._thisArg,args),arguments$1=arguments$1._next;return!0};Signal.prototype.add=function(fn,thisArg){void 0===thisArg&&(thisArg=null);if("function"!==typeof fn)throw Error("MiniSignal#add(): First arg must be a Function.");return _addSignalBinding(this,
new SignalBinding(fn,!1,thisArg))};Signal.prototype.once=function(fn,thisArg){void 0===thisArg&&(thisArg=null);if("function"!==typeof fn)throw Error("MiniSignal#once(): First arg must be a Function.");return _addSignalBinding(this,new SignalBinding(fn,!0,thisArg))};Signal.prototype.detach=function(node){if(!(node instanceof SignalBinding))throw Error("MiniSignal#detach(): First arg must be a SignalBinding object.");if(node._owner!==this)return this;node._prev&&(node._prev._next=node._next);node._next&&
(node._next._prev=node._prev);node===this._head?(this._head=node._next,null===node._next&&(this._tail=null)):node===this._tail&&(this._tail=node._prev,this._tail._next=null);node._owner=null;return this};Signal.prototype.detachAll=function(){var node=this._head;if(!node)return this;for(this._head=this._tail=null;node;)node._owner=null,node=node._next;return this};return Signal}(),useXdr=!(!self.XDomainRequest||"withCredentials"in new XMLHttpRequest),tempAnchor=null;exports.LoaderResource=function(){function LoaderResource(name,
url,options){this._dequeue=_noop;this._onLoadBinding=null;this._elementTimer=0;this._boundXhrOnLoad=this._boundXhrOnAbort=this._boundXhrOnTimeout=this._boundXhrOnError=this._boundOnTimeout=this._boundOnProgress=this._boundOnError=this._boundComplete=null;if("string"!==typeof name||"string"!==typeof url)throw Error("Both name and url are required for constructing a resource.");options=options||{};this._flags=0;this._setFlag(LoaderResource.STATUS_FLAGS.DATA_URL,0===url.indexOf("data:"));this.name=name;
this.url=url;this.extension=this._getExtension();this.data=null;this.crossOrigin=!0===options.crossOrigin?"anonymous":options.crossOrigin;this.timeout=options.timeout||0;this.loadType=options.loadType||this._determineLoadType();this.xhrType=options.xhrType;this.metadata=options.metadata||{};this.xhr=this.error=null;this.children=[];this.type=LoaderResource.TYPE.UNKNOWN;this.progressChunk=0;this._dequeue=_noop;this._onLoadBinding=null;this._elementTimer=0;this._boundComplete=this.complete.bind(this);
this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundOnTimeout=this._onTimeout.bind(this);this._boundXhrOnError=this._xhrOnError.bind(this);this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this.onStart=new Signal;this.onProgress=new Signal;this.onComplete=new Signal;this.onAfterMiddleware=new Signal}LoaderResource.setExtensionLoadType=function(extname,
loadType){setExtMap(LoaderResource._loadTypeMap,extname,loadType)};LoaderResource.setExtensionXhrType=function(extname,xhrType){setExtMap(LoaderResource._xhrTypeMap,extname,xhrType)};Object.defineProperty(LoaderResource.prototype,"isDataUrl",{get:function(){return this._hasFlag(LoaderResource.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0});Object.defineProperty(LoaderResource.prototype,"isComplete",{get:function(){return this._hasFlag(LoaderResource.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0});
Object.defineProperty(LoaderResource.prototype,"isLoading",{get:function(){return this._hasFlag(LoaderResource.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0});LoaderResource.prototype.complete=function(){this._clearEvents();this._finish()};LoaderResource.prototype.abort=function(message){if(!this.error){this.error=Error(message);this._clearEvents();if(this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=LoaderResource.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);
this._finish()}};LoaderResource.prototype.load=function(cb){var _this=this;if(!this.isLoading)if(this.isComplete)cb&&setTimeout(function(){return cb(_this)},1);else{if(cb)this.onComplete.once(cb);this._setFlag(LoaderResource.STATUS_FLAGS.LOADING,!0);this.onStart.dispatch(this);if(!1===this.crossOrigin||"string"!==typeof this.crossOrigin)this.crossOrigin=this._determineCrossOrigin(this.url);switch(this.loadType){case LoaderResource.LOAD_TYPE.IMAGE:this.type=LoaderResource.TYPE.IMAGE;this._loadElement("image");
break;case LoaderResource.LOAD_TYPE.AUDIO:this.type=LoaderResource.TYPE.AUDIO;this._loadSourceElement("audio");break;case LoaderResource.LOAD_TYPE.VIDEO:this.type=LoaderResource.TYPE.VIDEO;this._loadSourceElement("video");break;default:useXdr&&this.crossOrigin?this._loadXdr():this._loadXhr()}}};LoaderResource.prototype._hasFlag=function(flag){return 0!==(this._flags&flag)};LoaderResource.prototype._setFlag=function(flag,value){this._flags=value?this._flags|flag:this._flags&~flag};LoaderResource.prototype._clearEvents=
function(){clearTimeout(this._elementTimer);this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1));this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,
!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))};LoaderResource.prototype._finish=function(){if(this.isComplete)throw Error("Complete called again for an already completed resource.");this._setFlag(LoaderResource.STATUS_FLAGS.COMPLETE,!0);this._setFlag(LoaderResource.STATUS_FLAGS.LOADING,
!1);this.onComplete.dispatch(this)};LoaderResource.prototype._loadElement=function(type){this.data=this.metadata.loadElement?this.metadata.loadElement:"image"===type&&"undefined"!==typeof self.Image?new Image:document.createElement(type);this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin);this.metadata.skipSource||(this.data.src=this.url);this.data.addEventListener("error",this._boundOnError,!1);this.data.addEventListener("load",this._boundComplete,!1);this.data.addEventListener("progress",
this._boundOnProgress,!1);this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))};LoaderResource.prototype._loadSourceElement=function(type){this.data=this.metadata.loadElement?this.metadata.loadElement:"audio"===type&&"undefined"!==typeof self.Audio?new Audio:document.createElement(type);if(null===this.data)this.abort("Unsupported element: "+type);else{this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin);if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=
Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var mimeTypes=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(type,this.url[i],Array.isArray(mimeTypes)?mimeTypes[i]:mimeTypes));else mimeTypes=this.metadata.mimeType,this.data.appendChild(this._createSource(type,this.url,Array.isArray(mimeTypes)?mimeTypes[0]:mimeTypes));this.data.addEventListener("error",this._boundOnError,!1);this.data.addEventListener("load",this._boundComplete,
!1);this.data.addEventListener("progress",this._boundOnProgress,!1);this.data.addEventListener("canplaythrough",this._boundComplete,!1);this.data.load();this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}};LoaderResource.prototype._loadXhr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xhr=this.xhr=new XMLHttpRequest;xhr.open("GET",this.url,!0);xhr.timeout=this.timeout;xhr.responseType=this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.JSON||
this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT?LoaderResource.XHR_RESPONSE_TYPE.TEXT:this.xhrType;xhr.addEventListener("error",this._boundXhrOnError,!1);xhr.addEventListener("timeout",this._boundXhrOnTimeout,!1);xhr.addEventListener("abort",this._boundXhrOnAbort,!1);xhr.addEventListener("progress",this._boundOnProgress,!1);xhr.addEventListener("load",this._boundXhrOnLoad,!1);xhr.send()};LoaderResource.prototype._loadXdr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());
var xdr=this.xhr=new self.XDomainRequest;xdr.timeout=this.timeout||5E3;xdr.onerror=this._boundXhrOnError;xdr.ontimeout=this._boundXhrOnTimeout;xdr.onprogress=this._boundOnProgress;xdr.onload=this._boundXhrOnLoad;xdr.open("GET",this.url,!0);setTimeout(function(){return xdr.send()},1)};LoaderResource.prototype._createSource=function(type,url,mime){mime||=type+"/"+this._getExtension(url);type=document.createElement("source");type.src=url;type.type=mime;return type};LoaderResource.prototype._onError=
function(event){this.abort("Failed to load element using: "+event.target.nodeName)};LoaderResource.prototype._onProgress=function(event){event&&event.lengthComputable&&this.onProgress.dispatch(this,event.loaded/event.total)};LoaderResource.prototype._onTimeout=function(){this.abort("Load timed out.")};LoaderResource.prototype._xhrOnError=function(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request failed. Status: "+xhr.status+', text: "'+xhr.statusText+'"')};LoaderResource.prototype._xhrOnTimeout=
function(){this.abort(reqType(this.xhr)+" Request timed out.")};LoaderResource.prototype._xhrOnAbort=function(){this.abort(reqType(this.xhr)+" Request was aborted by the user.")};LoaderResource.prototype._xhrOnLoad=function(){var xhr=this.xhr,text="",status="undefined"===typeof xhr.status?200:xhr.status;if(""===xhr.responseType||"text"===xhr.responseType||"undefined"===typeof xhr.responseType)text=xhr.responseText;0===status&&(0<text.length||xhr.responseType===LoaderResource.XHR_RESPONSE_TYPE.BUFFER)?
status=200:1223===status&&(status=204);if(2===(status/100|0)){if(this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.TEXT)this.data=text,this.type=LoaderResource.TYPE.TEXT;else if(this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(text),this.type=LoaderResource.TYPE.JSON}catch(e){this.abort("Error trying to parse loaded json: "+e);return}else if(this.xhrType===LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(self.DOMParser)this.data=(new DOMParser).parseFromString(text,"text/xml");
else{var div=document.createElement("div");div.innerHTML=text;this.data=div}this.type=LoaderResource.TYPE.XML}catch(e$1){this.abort("Error trying to parse loaded xml: "+e$1);return}else this.data=xhr.response||text;this.complete()}else this.abort("["+xhr.status+"] "+xhr.statusText+": "+xhr.responseURL)};LoaderResource.prototype._determineCrossOrigin=function(url,loc){if(0===url.indexOf("data:"))return"";if(self.origin!==self.location.origin)return"anonymous";loc=loc||self.location;tempAnchor||=document.createElement("a");
tempAnchor.href=url;url=parseUri(tempAnchor.href,{strictMode:!0});var samePort=!url.port&&""===loc.port||url.port===loc.port,protocol=url.protocol?url.protocol+":":"";return url.host===loc.hostname&&samePort&&protocol===loc.protocol?"":"anonymous"};LoaderResource.prototype._determineXhrType=function(){return LoaderResource._xhrTypeMap[this.extension]||LoaderResource.XHR_RESPONSE_TYPE.TEXT};LoaderResource.prototype._determineLoadType=function(){return LoaderResource._loadTypeMap[this.extension]||LoaderResource.LOAD_TYPE.XHR};
LoaderResource.prototype._getExtension=function(url){void 0===url&&(url=this.url);if(this.isDataUrl){var slashIndex=url.indexOf("/");url=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{slashIndex=url.indexOf("?");var hashStart=url.indexOf("#");url=url.substring(0,Math.min(-1<slashIndex?slashIndex:url.length,-1<hashStart?hashStart:url.length));url=url.substring(url.lastIndexOf(".")+1)}return url.toLowerCase()};LoaderResource.prototype._getMimeFromXhrType=function(type){switch(type){case LoaderResource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";
case LoaderResource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case LoaderResource.XHR_RESPONSE_TYPE.JSON:return"application/json";default:return"text/plain"}};return LoaderResource}();(function(LoaderResource){(function(STATUS_FLAGS){STATUS_FLAGS[STATUS_FLAGS.NONE=0]="NONE";STATUS_FLAGS[STATUS_FLAGS.DATA_URL=1]="DATA_URL";STATUS_FLAGS[STATUS_FLAGS.COMPLETE=2]="COMPLETE";STATUS_FLAGS[STATUS_FLAGS.LOADING=4]="LOADING"})(LoaderResource.STATUS_FLAGS||
(LoaderResource.STATUS_FLAGS={}));(function(TYPE){TYPE[TYPE.UNKNOWN=0]="UNKNOWN";TYPE[TYPE.JSON=1]="JSON";TYPE[TYPE.XML=2]="XML";TYPE[TYPE.IMAGE=3]="IMAGE";TYPE[TYPE.AUDIO=4]="AUDIO";TYPE[TYPE.VIDEO=5]="VIDEO";TYPE[TYPE.TEXT=6]="TEXT"})(LoaderResource.TYPE||(LoaderResource.TYPE={}));(function(LOAD_TYPE){LOAD_TYPE[LOAD_TYPE.XHR=1]="XHR";LOAD_TYPE[LOAD_TYPE.IMAGE=2]="IMAGE";LOAD_TYPE[LOAD_TYPE.AUDIO=3]="AUDIO";LOAD_TYPE[LOAD_TYPE.VIDEO=4]="VIDEO"})(LoaderResource.LOAD_TYPE||(LoaderResource.LOAD_TYPE=
{}));(function(XHR_RESPONSE_TYPE){XHR_RESPONSE_TYPE.DEFAULT="text";XHR_RESPONSE_TYPE.BUFFER="arraybuffer";XHR_RESPONSE_TYPE.BLOB="blob";XHR_RESPONSE_TYPE.DOCUMENT="document";XHR_RESPONSE_TYPE.JSON="json";XHR_RESPONSE_TYPE.TEXT="text"})(LoaderResource.XHR_RESPONSE_TYPE||(LoaderResource.XHR_RESPONSE_TYPE={}));LoaderResource._loadTypeMap={gif:LoaderResource.LOAD_TYPE.IMAGE,png:LoaderResource.LOAD_TYPE.IMAGE,bmp:LoaderResource.LOAD_TYPE.IMAGE,jpg:LoaderResource.LOAD_TYPE.IMAGE,jpeg:LoaderResource.LOAD_TYPE.IMAGE,
tif:LoaderResource.LOAD_TYPE.IMAGE,tiff:LoaderResource.LOAD_TYPE.IMAGE,webp:LoaderResource.LOAD_TYPE.IMAGE,tga:LoaderResource.LOAD_TYPE.IMAGE,svg:LoaderResource.LOAD_TYPE.IMAGE,"svg+xml":LoaderResource.LOAD_TYPE.IMAGE,mp3:LoaderResource.LOAD_TYPE.AUDIO,ogg:LoaderResource.LOAD_TYPE.AUDIO,wav:LoaderResource.LOAD_TYPE.AUDIO,mp4:LoaderResource.LOAD_TYPE.VIDEO,webm:LoaderResource.LOAD_TYPE.VIDEO};LoaderResource._xhrTypeMap={xhtml:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,html:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,
htm:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,xml:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,svg:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT,gif:LoaderResource.XHR_RESPONSE_TYPE.BLOB,png:LoaderResource.XHR_RESPONSE_TYPE.BLOB,bmp:LoaderResource.XHR_RESPONSE_TYPE.BLOB,jpg:LoaderResource.XHR_RESPONSE_TYPE.BLOB,jpeg:LoaderResource.XHR_RESPONSE_TYPE.BLOB,tif:LoaderResource.XHR_RESPONSE_TYPE.BLOB,tiff:LoaderResource.XHR_RESPONSE_TYPE.BLOB,
webp:LoaderResource.XHR_RESPONSE_TYPE.BLOB,tga:LoaderResource.XHR_RESPONSE_TYPE.BLOB,json:LoaderResource.XHR_RESPONSE_TYPE.JSON,text:LoaderResource.XHR_RESPONSE_TYPE.TEXT,txt:LoaderResource.XHR_RESPONSE_TYPE.TEXT,ttf:LoaderResource.XHR_RESPONSE_TYPE.BUFFER,otf:LoaderResource.XHR_RESPONSE_TYPE.BUFFER};LoaderResource.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw\x3d\x3d"})(exports.LoaderResource||(exports.LoaderResource={}));var AsyncQueueItem=function(){return function(data,
callback){this.data=data;this.callback=callback}}(),AsyncQueue=function(){function AsyncQueue(worker,concurrency){var _this=this;void 0===concurrency&&(concurrency=1);this.workers=0;this.error=this.drain=this.empty=this.unsaturated=this.saturated=_noop$1;this.paused=this.started=!1;this._tasks=[];this._insert=function(data,insertAtFront,callback){if(callback&&"function"!==typeof callback)throw Error("task callback must be a function");_this.started=!0;null==data&&_this.idle()?setTimeout(function(){return _this.drain()},
1):(data=new AsyncQueueItem(data,"function"===typeof callback?callback:_noop$1),insertAtFront?_this._tasks.unshift(data):_this._tasks.push(data),setTimeout(_this.process,1))};this.process=function(){for(;!_this.paused&&_this.workers<_this.concurrency&&_this._tasks.length;){var task=_this._tasks.shift();0===_this._tasks.length&&_this.empty();_this.workers+=1;_this.workers===_this.concurrency&&_this.saturated();_this._worker(task.data,onlyOnce(_this._next(task)))}};this._worker=worker;if(0===concurrency)throw Error("Concurrency must not be zero");
this.concurrency=concurrency;this.buffer=concurrency/4}AsyncQueue.prototype._next=function(task){var _this=this;return function(){for(var arguments$1=arguments,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments$1[_i];--_this.workers;task.callback.apply(task,args);null!=args[0]&&_this.error(args[0],task.data);_this.workers<=_this.concurrency-_this.buffer&&_this.unsaturated();_this.idle()&&_this.drain();_this.process()}};AsyncQueue.prototype.push=function(data,callback){this._insert(data,!1,callback)};
AsyncQueue.prototype.kill=function(){this.workers=0;this.drain=_noop$1;this.started=!1;this._tasks=[]};AsyncQueue.prototype.unshift=function(data,callback){this._insert(data,!0,callback)};AsyncQueue.prototype.length=function(){return this._tasks.length};AsyncQueue.prototype.running=function(){return this.workers};AsyncQueue.prototype.idle=function(){return 0===this._tasks.length+this.workers};AsyncQueue.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)};AsyncQueue.prototype.resume=function(){if(!1!==
this.paused){this.paused=!1;for(var w=1;w<=this.concurrency;w++)this.process()}};AsyncQueue.eachSeries=function(array,iterator,callback,deferNext){function next(err){err||i===len?callback&&callback(err):deferNext?setTimeout(function(){iterator(array[i++],next)},1):iterator(array[i++],next)}var i=0,len=array.length;next()};AsyncQueue.queue=function(worker,concurrency){return new AsyncQueue(worker,concurrency)};return AsyncQueue}(),rgxExtractUrlHash=/(#[\w-]+)?$/,Loader=function(){function Loader(baseUrl,
concurrency){var _this=this;void 0===baseUrl&&(baseUrl="");void 0===concurrency&&(concurrency=10);this._beforeMiddleware=[];this._afterMiddleware=[];this._resourcesParsing=[];this._boundLoadResource=function(r,d){return _this._loadResource(r,d)};this.resources={};this.baseUrl=baseUrl;this.progress=0;this.loading=!1;this.defaultQueryString="";this._beforeMiddleware=[];this._afterMiddleware=[];this._resourcesParsing=[];this._boundLoadResource=function(r,d){return _this._loadResource(r,d)};this._queue=
AsyncQueue.queue(this._boundLoadResource,concurrency);this._queue.pause();this.resources={};this.onProgress=new Signal;this.onError=new Signal;this.onLoad=new Signal;this.onStart=new Signal;this.onComplete=new Signal;for(baseUrl=0;baseUrl<Loader._plugins.length;++baseUrl){var plugin=Loader._plugins[baseUrl];concurrency=plugin.pre;plugin=plugin.use;concurrency&&this.pre(concurrency);plugin&&this.use(plugin)}this._protected=!1}Loader.prototype._add=function(name,url,options,callback){if(this.loading&&
(!options||!options.parentResource))throw Error("Cannot add resources while the loader is running.");if(this.resources[name])throw Error('Resource named "'+name+'" already exists.');url=this._prepareUrl(url);this.resources[name]=new exports.LoaderResource(name,url,options);if("function"===typeof callback)this.resources[name].onAfterMiddleware.once(callback);if(this.loading){url=options.parentResource;options=[];for(callback=0;callback<url.children.length;++callback)url.children[callback].isComplete||
options.push(url.children[callback]);var eachChunk=url.progressChunk*(options.length+1)/(options.length+2);url.children.push(this.resources[name]);url.progressChunk=eachChunk;for(callback=0;callback<options.length;++callback)options[callback].progressChunk=eachChunk;this.resources[name].progressChunk=eachChunk}this._queue.push(this.resources[name]);return this};Loader.prototype.pre=function(fn){this._beforeMiddleware.push(fn);return this};Loader.prototype.use=function(fn){this._afterMiddleware.push(fn);
return this};Loader.prototype.reset=function(){this.progress=0;this.loading=!1;this._queue.kill();this._queue.pause();for(var k in this.resources){var res=this.resources[k];res._onLoadBinding&&res._onLoadBinding.detach();res.isLoading&&res.abort("loader reset")}this.resources={};return this};Loader.prototype.load=function(cb){if("function"===typeof cb)this.onComplete.once(cb);if(this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{cb=100/this._queue._tasks.length;
for(var i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=cb;this._onStart();this._queue.resume()}return this};Object.defineProperty(Loader.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(concurrency){this._queue.concurrency=concurrency},enumerable:!1,configurable:!0});Loader.prototype._prepareUrl=function(url){var parsedUrl=parseUri(url,{strictMode:!0});url=parsedUrl.protocol||!parsedUrl.path||0===url.indexOf("//")?url:this.baseUrl.length&&
this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==url.charAt(0)?this.baseUrl+"/"+url:this.baseUrl+url;this.defaultQueryString&&(parsedUrl=rgxExtractUrlHash.exec(url)[0],url=url.substr(0,url.length-parsedUrl.length),url=-1!==url.indexOf("?")?url+("\x26"+this.defaultQueryString):url+("?"+this.defaultQueryString),url+=parsedUrl);return url};Loader.prototype._loadResource=function(resource,dequeue){var _this=this;resource._dequeue=dequeue;AsyncQueue.eachSeries(this._beforeMiddleware,function(fn,
next){fn.call(_this,resource,function(){next(resource.isComplete?{}:null)})},function(){resource.isComplete?_this._onLoad(resource):(resource._onLoadBinding=resource.onComplete.once(_this._onLoad,_this),resource.load())},!0)};Loader.prototype._onStart=function(){this.progress=0;this.loading=!0;this.onStart.dispatch(this)};Loader.prototype._onComplete=function(){this.progress=100;this.loading=!1;this.onComplete.dispatch(this,this.resources)};Loader.prototype._onLoad=function(resource){var _this=this;
resource._onLoadBinding=null;this._resourcesParsing.push(resource);resource._dequeue();AsyncQueue.eachSeries(this._afterMiddleware,function(fn,next){fn.call(_this,resource,next)},function(){resource.onAfterMiddleware.dispatch(resource);_this.progress=Math.min(100,_this.progress+resource.progressChunk);_this.onProgress.dispatch(_this,resource);resource.error?_this.onError.dispatch(resource.error,_this,resource):_this.onLoad.dispatch(_this,resource);_this._resourcesParsing.splice(_this._resourcesParsing.indexOf(resource),
1);_this._queue.idle()&&0===_this._resourcesParsing.length&&_this._onComplete()},!0)};Loader.prototype.destroy=function(){this._protected||this.reset()};Object.defineProperty(Loader,"shared",{get:function(){var shared=Loader._shared;shared||(shared=new Loader,shared._protected=!0,Loader._shared=shared);return shared},enumerable:!1,configurable:!0});Loader.registerPlugin=function(plugin){Loader._plugins.push(plugin);plugin.add&&plugin.add();return Loader};Loader._plugins=[];return Loader}();Loader.prototype.add=
function(name,url,options,callback){if(Array.isArray(name)){for(url=0;url<name.length;++url)this.add(name[url]);return this}"object"===typeof name&&(options=name,callback=url||options.callback||options.onComplete,url=options.url,name=options.name||options.key||options.url);"string"!==typeof url&&(callback=options,options=url,url=name);if("string"!==typeof url)throw Error("No url passed to add resource to loader.");"function"===typeof options&&(callback=options,options=null);return this._add(name,
url,options,callback)};global=function(){function AppLoaderPlugin(){}AppLoaderPlugin.init=function(options){options=Object.assign({sharedLoader:!1},options);this.loader=options.sharedLoader?Loader.shared:new Loader};AppLoaderPlugin.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};return AppLoaderPlugin}();require=function(){function TextureLoader(){}TextureLoader.add=function(){exports.LoaderResource.setExtensionLoadType("svg",exports.LoaderResource.LOAD_TYPE.XHR);exports.LoaderResource.setExtensionXhrType("svg",
exports.LoaderResource.XHR_RESPONSE_TYPE.TEXT)};TextureLoader.use=function(resource,next){!resource.data||resource.type!==exports.LoaderResource.TYPE.IMAGE&&"svg"!==resource.extension?next():core.Texture.fromLoader(resource.data,resource.url,resource.name,resource.metadata).then(function(texture){resource.texture=texture;next()}).catch(next)};return TextureLoader}();var Url=self.URL||self.webkitURL;Loader.registerPlugin({use:function(resource,next){if(resource.data&&resource.xhr&&resource.xhrType===
exports.LoaderResource.XHR_RESPONSE_TYPE.BLOB)if(!self.Blob||"string"===typeof resource.data){var type=resource.xhr.getResponseHeader("content-type");if(type&&0===type.indexOf("image")){resource.data=new Image;resource.data.src="data:"+type+";base64,"+encodeBinary(resource.xhr.responseText);resource.type=exports.LoaderResource.TYPE.IMAGE;resource.data.onload=function(){resource.data.onload=null;next()};return}}else if(0===resource.data.type.indexOf("image")){var src_1=Url.createObjectURL(resource.data);
resource.blob=resource.data;resource.data=new Image;resource.data.src=src_1;resource.type=exports.LoaderResource.TYPE.IMAGE;resource.data.onload=function(){Url.revokeObjectURL(src_1);resource.data.onload=null;next()};return}next()}});Loader.registerPlugin(require);exports.AppLoaderPlugin=global;exports.Loader=Loader;exports.TextureLoader=require}
//# sourceMappingURL=module$node_modules$$pixi$loaders$dist$cjs$loaders.js.map
