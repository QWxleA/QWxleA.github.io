{
"version":3,
"file":"module$frontend$utils.js",
"lineCount":223,
"mappings":"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",
"sources":["frontend/utils.js"],
"sourcesContent":["import path from 'goog:module$node_modules$path$path'\n\n// TODO split the capacitor abilities to a separate file for capacitor APIs\nimport { StatusBar, Style } from 'goog:module$node_modules$$capacitor$status_bar$dist$plugin_cjs'\nimport { Clipboard as CapacitorClipboard } from 'goog:module$node_modules$$capacitor$clipboard$dist$plugin_cjs'\n\nif (typeof window === 'undefined') {\n  global.window = {}\n}\n\n// Copy from https://github.com/primetwig/react-nestable/blob/dacea9dc191399a3520f5dc7623f5edebc83e7b7/dist/utils.js\nexport const closest = (target, selector) => {\n  // closest(e.target, '.field')\n  while (target) {\n    if (target.matches && target.matches(selector)) return target\n    target = target.parentNode\n  }\n  return null\n}\n\nexport const getOffsetRect = (elem) => {\n  // (1)\n  const box = elem.getBoundingClientRect(),\n    body = document.body,\n    docElem = document.documentElement,\n    // (2)\n    scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n    scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n\n    // (3)\n    clientTop = docElem.clientTop || body.clientTop || 0,\n    clientLeft = docElem.clientLeft || body.clientLeft || 0,\n\n    // (4)\n    top = box.top + scrollTop - clientTop,\n    left = box.left + scrollLeft - clientLeft;\n\n  return {\n    top: Math.round(top),\n    left: Math.round(left)\n  }\n}\n\n// jquery focus\nexport const focus = (elem) => {\n  return elem === document.activeElement &&\n    document.hasFocus() &&\n    !!(elem.type || elem.href || ~elem.tabIndex)\n}\n\n// copied from https://stackoverflow.com/a/32180863\nexport const timeConversion = (millisec) => {\n  let seconds = (millisec / 1000).toFixed(0),\n    minutes = (millisec / (1000 * 60)).toFixed(0),\n    hours = (millisec / (1000 * 60 * 60)).toFixed(1),\n    days = (millisec / (1000 * 60 * 60 * 24)).toFixed(1);\n\n  if (seconds < 60) {\n    return seconds + 's'\n  } else if (minutes < 60) {\n    return minutes + 'm'\n  } else if (hours < 24) {\n    return hours + 'h'\n  } else {\n    return days + 'd'\n  }\n}\n\nexport const getSelectionText = () => {\n  const selection = (window.getSelection() || '').toString().trim()\n  if (selection) {\n    return selection\n  }\n\n  // Firefox fix\n  const activeElement = window.document.activeElement\n  if (activeElement) {\n    if (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA') {\n      const el = activeElement\n      return el.value.slice(el.selectionStart || 0, el.selectionEnd || 0)\n    }\n  }\n\n  return ''\n}\n\n// Modified from https://github.com/GoogleChromeLabs/browser-nativefs\n// because shadow-cljs doesn't handle this babel transform\nexport const getFiles = async (dirHandle, recursive, cb, path = dirHandle.name) => {\n  const dirs = []\n  const files = []\n  for await (const entry of dirHandle.values()) {\n    const nestedPath = `${path}/${entry.name}`\n    if (entry.kind === 'file') {\n      cb(nestedPath, entry)\n      files.push(\n        entry.getFile().then((file) => {\n          Object.defineProperty(file, 'webkitRelativePath', {\n            configurable: true,\n            enumerable: true,\n            get: () => nestedPath,\n          })\n          Object.defineProperty(file, 'handle', {\n            configurable: true,\n            enumerable: true,\n            get: () => entry,\n          })\n          return file\n        })\n      )\n    } else if (entry.kind === 'directory' && recursive) {\n      cb(nestedPath, entry)\n      dirs.push(getFiles(entry, recursive, cb, nestedPath))\n    }\n  }\n  return [(await Promise.all(dirs)), (await Promise.all(files))]\n}\n\nexport const verifyPermission = async (handle, readWrite) => {\n  const options = {}\n  if (readWrite) {\n    options.mode = 'readwrite'\n  }\n  // Check if permission was already granted.\n  if ((await handle.queryPermission(options)) === 'granted') {\n    return\n  }\n  // Request permission. If the user grants permission, just return.\n  if ((await handle.requestPermission(options)) === 'granted') {\n    return\n  }\n  // The user didn't grant permission, throw an error.\n  throw new Error('Permission is not granted')\n}\n\n// NOTE: Need externs to prevent `options.recursive` been munged\n//       When building with release.\nexport const openDirectory = async (options = {}, cb) => {\n  options.recursive = options.recursive || false;\n  const handle = await window.showDirectoryPicker({\n    mode: 'readwrite'\n  });\n  const _ask = await verifyPermission(handle, true);\n  return [handle, getFiles(handle, options.recursive, cb)];\n};\n\nexport const writeFile = async (fileHandle, contents) => {\n  // Create a FileSystemWritableFileStream to write to.\n  const writable = await fileHandle.createWritable()\n\n  if (contents instanceof ReadableStream) {\n    await contents.pipeTo(writable)\n  } else {\n    // Write the contents of the file to the stream.\n    await writable.write(contents)\n    // Close the file and write the contents to disk.\n    await writable.close()\n  }\n}\n\nexport const nfsSupported = () => {\n  if ('chooseFileSystemEntries' in self) {\n    return 'chooseFileSystemEntries'\n  } else if ('showOpenFilePicker' in self) {\n    return 'showOpenFilePicker'\n  }\n  return false\n}\n\nconst inputTypes = [\n  window.HTMLInputElement,\n  window.HTMLSelectElement,\n  window.HTMLTextAreaElement,\n]\n\nexport const triggerInputChange = (node, value = '', name = 'change') => {\n\n  // only process the change on elements we know have a value setter in their constructor\n  if (inputTypes.indexOf(node.__proto__.constructor) > -1) {\n\n    const setValue = Object.getOwnPropertyDescriptor(node.__proto__, 'value').set\n    const event = new Event('change', {\n      bubbles: true\n    })\n\n    setValue.call(node, value)\n    node.dispatchEvent(event)\n  }\n}\n\n// Copied from https://github.com/google/diff-match-patch/issues/29#issuecomment-647627182\nexport const reversePatch = patch => {\n  return patch.map(patchObj => ({\n    diffs: patchObj.diffs.map(([op, val]) => [\n      op * -1, // The money maker\n      val\n    ]),\n    start1: patchObj.start2,\n    start2: patchObj.start1,\n    length1: patchObj.length2,\n    length2: patchObj.length1\n  }));\n};\n\n// Copied from https://github.com/sindresorhus/path-is-absolute/blob/main/index.js\nexport const win32 = path => {\n  // https://github.com/nodejs/node/blob/b3fcc245fb25539909ef1d5eaa01dbf92e168633/lib/path.js#L56\n  const splitDeviceRe = /^([a-zA-Z]:|[\\\\/]{2}[^\\\\/]+[\\\\/]+[^\\\\/]+)?([\\\\/])?([\\s\\S]*?)$/,\n    result = splitDeviceRe.exec(path),\n    device = result[1] || '',\n    isUnc = Boolean(device && device.charAt(1) !== ':');\n\n  // UNC paths are always absolute\n  return Boolean(result[2] || isUnc);\n};\n\nexport const ios = () => {\n  return [\n      'iPad Simulator',\n      'iPhone Simulator',\n      'iPod Simulator',\n      'iPad',\n      'iPhone',\n      'iPod'\n    ].includes(navigator.platform)\n    // iPad on iOS 13 detection\n    ||\n    (navigator.userAgent.includes(\"Mac\") && \"ontouchend\" in document)\n}\n\nexport const getClipText = (cb, errorHandler) => {\n  navigator.permissions.query({\n    name: \"clipboard-read\"\n  }).then((result) => {\n    if (result.state == \"granted\" || result.state == \"prompt\") {\n      navigator.clipboard.readText()\n        .then(text => {\n          cb(text);\n        })\n        .catch(err => {\n          errorHandler(err)\n        });\n    }\n  })\n}\n\n// TODO split the capacitor clipboard to a separate file for capacitor APIs\nexport const writeClipboard = (text, isHtml) => {\n    if (typeof navigator.permissions == \"undefined\") {\n        CapacitorClipboard.write({ string: text });\n        return\n    }\n    navigator.permissions.query({\n        name: \"clipboard-write\"\n    }).then((result) => {\n        if (result.state != \"granted\" && result.state != \"prompt\"){\n            console.debug(\"Copy without `clipboard-write` permission:\", text)\n            return\n        }\n        let promise_written = null\n        if (typeof ClipboardItem !== 'undefined') {\n            let blob = new Blob([text], {\n            type: [\"text/plain\"]\n            });\n            let data = [new ClipboardItem({\n                [\"text/plain\"]: blob\n            })];\n            if (isHtml) {\n                blob = new Blob([text], {\n                    type: [\"text/plain\", \"text/html\"]\n                })\n                data = [new ClipboardItem({\n                    [\"text/plain\"]: blob,\n                    [\"text/html\"]: blob\n                })];\n            }\n            promise_written = navigator.clipboard.write(data)\n        } else {\n            console.debug(\"Degraded copy without `ClipboardItem` support:\", text)\n            promise_written = navigator.clipboard.writeText(text)\n        }\n        promise_written.then(() => {\n            /* success */\n        }).catch(e => {\n            console.log(e, \"fail\")\n        })\n    })\n}\n\nexport const toPosixPath = (input) => {\n  return input && input.replace(/\\\\+/g, '/')\n}\n\nexport const nodePath = Object.assign({}, path, {\n  basename (input) {\n    input = toPosixPath(input)\n    return path.basename(input)\n  },\n\n  name (input) {\n    input = toPosixPath(input)\n    return path.parse(input).name\n  },\n\n  dirname (input) {\n    input = toPosixPath(input)\n    return path.dirname(input)\n  },\n\n  extname (input) {\n    input = toPosixPath(input)\n    return path.extname(input)\n  }\n})\n"],
"names":["window","global","closest","target","selector","matches","parentNode","getOffsetRect","elem","box","getBoundingClientRect","body","document","docElem","documentElement","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","top","left","Math","round","focus","activeElement","hasFocus","type","href","tabIndex","timeConversion","millisec","seconds","toFixed","minutes","hours","days","getSelectionText","selection","toString","getSelection","trim","tagName","el","value","slice","selectionStart","selectionEnd","getFiles","dirHandle","recursive","cb","path","name","dirs","files","entry","values","nestedPath","kind","push","getFile","then","file","Object","defineProperty","configurable","enumerable","get","Promise","all","verifyPermission","handle","readWrite","options","mode","queryPermission","requestPermission","Error","openDirectory","showDirectoryPicker","_ask","writeFile","fileHandle","contents","writable","createWritable","ReadableStream","pipeTo","write","close","nfsSupported","self","inputTypes","HTMLInputElement","HTMLSelectElement","HTMLTextAreaElement","triggerInputChange","node","indexOf","__proto__","constructor","setValue","getOwnPropertyDescriptor","set","event","Event","bubbles","call","dispatchEvent","reversePatch","patch","map","patchObj","diffs","op","val","start1","start2","length1","length2","win32","splitDeviceRe","result","exec","device","isUnc","Boolean","charAt","ios","includes","navigator","platform","userAgent","getClipText","errorHandler","permissions","query","state","clipboard","readText","text","catch","err","writeClipboard","isHtml","CapacitorClipboard","string","console","debug","promise_written","ClipboardItem","blob","Blob","data","writeText","e","log","toPosixPath","input","replace","nodePath","assign","basename","parse","dirname","extname","$jscomp$tmp$exports$module$name"]
}
