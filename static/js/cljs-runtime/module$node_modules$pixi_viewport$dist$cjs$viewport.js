shadow$provide.module$node_modules$pixi_viewport$dist$cjs$viewport=function(global,require,module$jscomp$0,exports$jscomp$0){function ease(ease,defaults){if(ease){if("function"===typeof ease)return ease;if("string"===typeof ease)return penner[ease]}else return penner[defaults]}function _optionalChain$1(ops){let lastAccessLHS=void 0,value=ops[0],i=1;for(;i<ops.length;){const op=ops[i],fn=ops[i+1];i+=2;if(("optionalAccess"===op||"optionalCall"===op)&&null==value)return;if("access"===op||"optionalAccess"===
op)lastAccessLHS=value,value=fn(value);else if("call"===op||"optionalCall"===op)value=fn((...args)=>value.call(lastAccessLHS,...args)),lastAccessLHS=void 0}return value}function _optionalChain(ops){let lastAccessLHS=void 0,value=ops[0],i=1;for(;i<ops.length;){const op=ops[i],fn=ops[i+1];i+=2;if(("optionalAccess"===op||"optionalCall"===op)&&null==value)return;if("access"===op||"optionalAccess"===op)lastAccessLHS=value,value=fn(value);else if("call"===op||"optionalCall"===op)value=fn((...args)=>value.call(lastAccessLHS,
...args)),lastAccessLHS=void 0}return value}Object.defineProperty(exports$jscomp$0,"__esModule",{value:!0});var math=require("module$node_modules$$pixi$math$dist$cjs$math");module$jscomp$0=require("module$node_modules$$pixi$display$dist$cjs$display");require=require("module$node_modules$$pixi$ticker$dist$cjs$ticker");class Plugin{constructor(parent){this.parent=parent;this.paused=!1}destroy(){}down(_e){return!1}move(_e){return!1}up(_e){return!1}wheel(_e){return!1}update(_delta){}resize(){}reset(){}pause(){this.paused=
!0}resume(){this.paused=!1}}var commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},penner=function(fn,basedir,module){return module={path:basedir,exports:{},require:function(path,base){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs");}},fn(module,module.exports),module.exports}(function(module,exports){(function(){var penner={linear:function(t,b,c,d){return c*
t/d+b},easeInQuad:function(t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(t,b,c,d){return 1>(t/=d/2)?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(t,b,c,d){return 1>(t/=d/2)?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeInQuart:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(t,b,c,d){return-c*((t=t/d-1)*t*
t*t-1)+b},easeInOutQuart:function(t,b,c,d){return 1>(t/=d/2)?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(t,b,c,d){return 1>(t/=d/2)?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(t,b,c,d){return-c/2*(Math.cos(Math.PI*
t/d)-1)+b},easeInExpo:function(t,b,c,d){return 0===t?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(t,b,c,d){return t===d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(t,b,c,d){return 1>(t/=d/2)?c/2*Math.pow(2,10*(t-1))+b:c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(t,b,c,d){return 1>(t/=d/2)?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=
2)*t)+1)+b},easeInElastic:function(t,b,c,d){var p=0;var a=c;0!==t&&(t/=d);p||=.3*d;a<Math.abs(c)?(a=c,c=p/4):c=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*--t)*Math.sin(2*(t*d-c)*Math.PI/p))+b},easeOutElastic:function(t,b,c,d){var p=0;var a=c;0!==t&&(t/=d);p||=.3*d;if(a<Math.abs(c)){a=c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin(2*(t*d-s)*Math.PI/p)+c+b},easeInOutElastic:function(t,b,c,d){var p=0;var a=c;0!==t&&(t/=d/2);p||=.3*d*1.5;if(a<Math.abs(c)){a=
c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return 1>t?-.5*a*Math.pow(2,10*--t)*Math.sin(2*(t*d-s)*Math.PI/p)+b:a*Math.pow(2,-10*--t)*Math.sin(2*(t*d-s)*Math.PI/p)*.5+c+b},easeInBack:function(t,b,c,d,s){void 0===s&&(s=1.70158);return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(t,b,c,d,s){void 0===s&&(s=1.70158);return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(t,b,c,d,s){void 0===s&&(s=1.70158);return 1>(t/=d/2)?c/2*t*t*(((s*=1.525)+1)*t-s)+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+
2)+b},easeInBounce:function(t,b,c,d){t=penner.easeOutBounce(d-t,0,c,d);return c-t+b},easeOutBounce:function(t,b,c,d){return(t/=d)<1/2.75?7.5625*c*t*t+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(t,b,c,d){if(t<d/2)return t=penner.easeInBounce(2*t,0,c,d),.5*t+b;t=penner.easeOutBounce(2*t-d,0,c,d);return.5*t+.5*c+b}};module.exports=penner}).call(commonjsGlobal)});const DEFAULT_ANIMATE_OPTIONS=
{removeOnInterrupt:!1,ease:"linear",time:1E3};class Animate extends Plugin{__init(){this.startWidth=null}__init2(){this.startHeight=null}__init3(){this.deltaWidth=null}__init4(){this.deltaHeight=null}__init5(){this.width=null}__init6(){this.height=null}__init7(){this.time=0}constructor(parent,options={}){super(parent);Animate.prototype.__init.call(this);Animate.prototype.__init2.call(this);Animate.prototype.__init3.call(this);Animate.prototype.__init4.call(this);Animate.prototype.__init5.call(this);
Animate.prototype.__init6.call(this);Animate.prototype.__init7.call(this);this.options=Object.assign({},DEFAULT_ANIMATE_OPTIONS,options);this.options.ease=ease(this.options.ease);this.setupPosition();this.setupZoom();this.time=0}setupPosition(){"undefined"!==typeof this.options.position?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=
!0}setupZoom(){this.height=this.width=null;"undefined"!==typeof this.options.scale?this.width=this.parent.screenWidth/this.options.scale:"undefined"!==typeof this.options.scaleX||"undefined"!==typeof this.options.scaleY?("undefined"!==typeof this.options.scaleX&&(this.width=this.parent.screenWidth/this.options.scaleX),"undefined"!==typeof this.options.scaleY&&(this.height=this.parent.screenHeight/this.options.scaleY)):("undefined"!==typeof this.options.width&&(this.width=this.options.width),"undefined"!==
typeof this.options.height&&(this.height=this.options.height));null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth);null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){this.options.removeOnInterrupt&&this.parent.plugins.remove("animate");return!1}complete(){this.parent.plugins.remove("animate");null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,
null===this.height);null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width);this.keepCenter||this.parent.moveCenter(this.options.position);this.parent.emit("animate-end",this.parent);this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(elapsed){if(!this.paused)if(this.time+=elapsed,this.time>=this.options.time)this.complete();else{elapsed=new math.Point(this.parent.scale.x,this.parent.scale.y);const percent=this.options.ease(this.time,
0,1,this.options.time);null!==this.width&&this.parent.fitWidth(this.startWidth+this.deltaWidth*percent,this.keepCenter,null===this.height);null!==this.height&&this.parent.fitHeight(this.startHeight+this.deltaHeight*percent,this.keepCenter,null===this.width);null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x);if(!this.keepCenter){const startX=this.startX,startY=this.startY,deltaX=this.deltaX,deltaY=this.deltaY,original=new math.Point(this.parent.x,
this.parent.y);this.parent.moveCenter(startX+deltaX*percent,startY+deltaY*percent);this.parent.emit("moved",{viewport:this.parent,original,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:elapsed,type:"animate"})}}}const DEFAULT_BOUNCE_OPTIONS={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class Bounce extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},DEFAULT_BOUNCE_OPTIONS,
options);this.ease=ease(this.options.ease,"easeInOutSine");this.options.sides?"all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?(this.right=this.left=!0,this.top=this.bottom=!1):"vertical"===this.options.sides?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right")):
this.left=this.top=this.right=this.bottom=!1;parent=this.options.underflow.toLowerCase();"center"===parent?this.underflowY=this.underflowX=0:(this.underflowX=-1!==parent.indexOf("left")?-1:-1!==parent.indexOf("right")?1:0,this.underflowY=-1!==parent.indexOf("top")?-1:-1!==parent.indexOf("bottom")?1:0);this.reset()}isActive(){return null!==this.toX||null!==this.toY}down(){this.toX=this.toY=null;return!1}up(){this.bounce();return!1}update(elapsed){if(!this.paused){this.bounce();if(this.toX){var toX=
this.toX;toX.time+=elapsed;this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"});toX.time>=this.options.time?(this.parent.x=toX.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(toX.time,toX.start,toX.delta,this.options.time)}this.toY&&(toX=this.toY,toX.time+=elapsed,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),toX.time>=this.options.time?(this.parent.y=toX.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=
this.ease(toX.time,toX.start,toX.delta,this.options.time))}}calcUnderflowX(){let x;switch(this.underflowX){case -1:x=0;break;case 1:x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return x}calcUnderflowY(){let y;switch(this.underflowY){case -1:y=0;break;case 1:y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return y}oob(){var box=this.options.bounceBox;
if(box){const x1="undefined"===typeof box.x?0:box.x,y1="undefined"===typeof box.y?0:box.y,width="undefined"===typeof box.width?this.parent.worldWidth:box.width;box="undefined"===typeof box.height?this.parent.worldHeight:box.height;return{left:this.parent.left<x1,right:this.parent.right>width,top:this.parent.top<y1,bottom:this.parent.bottom>box,topLeft:new math.Point(x1*this.parent.scale.x,y1*this.parent.scale.y),bottomRight:new math.Point(width*this.parent.scale.x-this.parent.screenWidth,box*this.parent.scale.y-
this.parent.screenHeight)}}return{left:0>this.parent.left,right:this.parent.right>this.parent.worldWidth,top:0>this.parent.top,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new math.Point(0,0),bottomRight:new math.Point(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(!this.paused){var decelerate=this.parent.plugins.get("decelerate",!0);if(decelerate&&(decelerate.x||decelerate.y)&&(decelerate.x&&
decelerate.percentChangeX===_optionalChain$1([decelerate,"access",_=>_.options,"optionalAccess",_2=>_2.friction])||decelerate.y&&decelerate.percentChangeY===_optionalChain$1([decelerate,"access",_3=>_3.options,"optionalAccess",_4=>_4.friction]))){var oob=this.oob();if(oob.left&&this.left||oob.right&&this.right)decelerate.percentChangeX=this.options.friction;if(oob.top&&this.top||oob.bottom&&this.bottom)decelerate.percentChangeY=this.options.friction}var drag=this.parent.plugins.get("drag",!0)||{},
pinch=this.parent.plugins.get("pinch",!0)||{};decelerate=decelerate||{};if(!(_optionalChain$1([drag,"optionalAccess",_5=>_5.active])||_optionalChain$1([pinch,"optionalAccess",_6=>_6.active])||this.toX&&this.toY||decelerate.x&&decelerate.y)){oob=oob||this.oob();drag=oob.topLeft;pinch=oob.bottomRight;if(!this.toX&&!decelerate.x){let x=null;oob.left&&this.left?x=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-drag.x:oob.right&&this.right&&(x=this.parent.screenWorldWidth<this.parent.screenWidth?
this.calcUnderflowX():-pinch.x);null!==x&&this.parent.x!==x&&(this.toX={time:0,start:this.parent.x,delta:x-this.parent.x,end:x},this.parent.emit("bounce-x-start",this.parent))}this.toY||decelerate.y||(decelerate=null,oob.top&&this.top?decelerate=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-drag.y:oob.bottom&&this.bottom&&(decelerate=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-pinch.y),null!==decelerate&&this.parent.y!==decelerate&&
(this.toY={time:0,start:this.parent.y,delta:decelerate-this.parent.y,end:decelerate},this.parent.emit("bounce-y-start",this.parent)))}}}reset(){this.toX=this.toY=null;this.bounce()}}const DEFAULT_CLAMP_OPTIONS={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class Clamp extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},DEFAULT_CLAMP_OPTIONS,options);this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction?
!0:null,this.options.right="x"===this.options.direction||"all"===this.options.direction?!0:null,this.options.top="y"===this.options.direction||"all"===this.options.direction?!0:null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction?!0:null);this.parseUnderflow();this.last={x:null,y:null,scaleX:null,scaleY:null};this.update()}parseUnderflow(){const clamp=this.options.underflow.toLowerCase();"none"===clamp?this.noUnderflow=!0:("center"===clamp?this.underflowX=this.underflowY=
0:(this.underflowX=-1!==clamp.indexOf("left")?-1:-1!==clamp.indexOf("right")?1:0,this.underflowY=-1!==clamp.indexOf("top")?-1:-1!==clamp.indexOf("bottom")?1:0),this.noUnderflow=!1)}move(){this.update();return!1}update(){if(!this.paused&&(this.parent.x!==this.last.x||this.parent.y!==this.last.y||this.parent.scale.x!==this.last.scaleX||this.parent.scale.y!==this.last.scaleY)){var original={x:this.parent.x,y:this.parent.y},decelerate=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==
this.options.right){var moved=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case -1:0!==this.parent.x&&(this.parent.x=0,moved=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,moved=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/
2,moved=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,decelerate.x=0,moved=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,decelerate.x=0,moved=!0);moved&&this.parent.emit("moved",
{viewport:this.parent,original,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){moved=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case -1:0!==this.parent.y&&(this.parent.y=0,moved=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,moved=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/
2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,moved=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,decelerate.y=0,moved=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+
this.parent.screenHeight,decelerate.y=0,moved=!0);moved&&this.parent.emit("moved",{viewport:this.parent,original,type:"clamp-y"})}this.last.x=this.parent.x;this.last.y=this.parent.y;this.last.scaleX=this.parent.scale.x;this.last.scaleY=this.parent.scale.y}}reset(){this.update()}}const DEFAULT_CLAMP_ZOOM_OPTIONS={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class ClampZoom extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},
DEFAULT_CLAMP_ZOOM_OPTIONS,options);this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){var width=this.parent.worldScreenWidth,height=this.parent.worldScreenHeight;null!==this.options.minWidth&&width<this.options.minWidth&&(width=this.parent.scale.x,this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/width,width=this.parent.worldScreenWidth,height=this.parent.worldScreenHeight,
this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}));null!==this.options.maxWidth&&width>this.options.maxWidth&&(width=this.parent.scale.x,this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/width,height=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}));null!==this.options.minHeight&&height<this.options.minHeight&&(width=this.parent.scale.y,this.parent.fitHeight(this.options.minHeight,!1,!1,
!0),this.parent.scale.x*=this.parent.scale.y/width,height=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}));null!==this.options.maxHeight&&height>this.options.maxHeight&&(width=this.parent.scale.y,this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/width,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}else if(this.options.minScale||this.options.maxScale){var JSCompiler_object_inline_y_4517=
width=null,JSCompiler_object_inline_y_4519=height=null;"number"===typeof this.options.minScale?JSCompiler_object_inline_y_4517=width=this.options.minScale:null!==this.options.minScale&&(JSCompiler_object_inline_y_4517=this.options.minScale,width="undefined"===typeof JSCompiler_object_inline_y_4517.x?null:JSCompiler_object_inline_y_4517.x,JSCompiler_object_inline_y_4517="undefined"===typeof JSCompiler_object_inline_y_4517.y?null:JSCompiler_object_inline_y_4517.y);"number"===typeof this.options.maxScale?
JSCompiler_object_inline_y_4519=height=this.options.maxScale:null!==this.options.maxScale&&(JSCompiler_object_inline_y_4519=this.options.maxScale,height="undefined"===typeof JSCompiler_object_inline_y_4519.x?null:JSCompiler_object_inline_y_4519.x,JSCompiler_object_inline_y_4519="undefined"===typeof JSCompiler_object_inline_y_4519.y?null:JSCompiler_object_inline_y_4519.y);let scaleX=this.parent.scale.x,scaleY=this.parent.scale.y;null!==width&&scaleX<width&&(scaleX=width);null!==height&&scaleX>height&&
(scaleX=height);null!==JSCompiler_object_inline_y_4517&&scaleY<JSCompiler_object_inline_y_4517&&(scaleY=JSCompiler_object_inline_y_4517);null!==JSCompiler_object_inline_y_4519&&scaleY>JSCompiler_object_inline_y_4519&&(scaleY=JSCompiler_object_inline_y_4519);if(scaleX!==this.parent.scale.x||scaleY!==this.parent.scale.y)this.parent.scale.set(scaleX,scaleY),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}reset(){this.clamp()}}const DEFAULT_DECELERATE_OPTIONS={friction:.98,bounce:.8,
minSpeed:.01};class Decelerate extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},DEFAULT_DECELERATE_OPTIONS,options);this.saved=[];this.timeSinceRelease=0;this.reset();this.parent.on("moved",data=>this.moved(data))}down(){this.saved=[];this.x=this.y=null;return!1}isActive(){return!(!this.x&&!this.y)}move(){if(this.paused)return!1;const count=this.parent.input.count();if(1===count||1<count&&!this.parent.plugins.get("pinch",!0))this.saved.push({x:this.parent.x,
y:this.parent.y,time:performance.now()}),60<this.saved.length&&this.saved.splice(0,30);return!1}moved(data){if(this.saved.length){const last=this.saved[this.saved.length-1];"clamp-x"===data.type?last.x===data.original.x&&(last.x=this.parent.x):"clamp-y"===data.type&&last.y===data.original.y&&(last.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){var now=performance.now();for(const save of this.saved)if(save.time>=now-100){now-=save.time;this.x=(this.parent.x-save.x)/now;
this.y=(this.parent.y-save.y)/now;this.percentChangeX=this.percentChangeY=this.options.friction;this.timeSinceRelease=0;break}}return!1}activate(options){options=options||{};"undefined"!==typeof options.x&&(this.x=options.x,this.percentChangeX=this.options.friction);"undefined"!==typeof options.y&&(this.y=options.y,this.percentChangeY=this.options.friction)}update(elapsed){if(!this.paused){var moved=this.x||this.y,ti=this.timeSinceRelease,tf=this.timeSinceRelease+elapsed;if(this.x){var k=this.percentChangeX;
this.parent.x+=16*this.x/Math.log(k)*(Math.pow(k,tf/16)-Math.pow(k,ti/16));this.x*=Math.pow(this.percentChangeX,elapsed/16)}this.y&&(k=this.percentChangeY,this.parent.y+=16*this.y/Math.log(k)*(Math.pow(k,tf/16)-Math.pow(k,ti/16)),this.y*=Math.pow(this.percentChangeY,elapsed/16));this.timeSinceRelease+=elapsed;this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.y=this.x=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&
(this.y=0));moved&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}}reset(){this.x=this.y=null}}const DEFAULT_DRAG_OPTIONS={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20};class Drag extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},DEFAULT_DRAG_OPTIONS,options);this.moved=!1;this.reverse=this.options.reverse?
1:-1;this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction;this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction;this.keyIsPressed=!1;this.parseUnderflow();this.mouseButtons(this.options.mouseButtons);this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(codes){window.addEventListener("keydown",e=>{codes.includes(e.code)&&(this.keyIsPressed=!0)});window.addEventListener("keyup",
e=>{codes.includes(e.code)&&(this.keyIsPressed=!1)})}mouseButtons(buttons){this.mouse=buttons&&"all"!==buttons?[-1!==buttons.indexOf("left"),-1!==buttons.indexOf("middle"),-1!==buttons.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const clamp=this.options.underflow.toLowerCase();"center"===clamp?this.underflowY=this.underflowX=0:(clamp.includes("left")?this.underflowX=-1:clamp.includes("right")?this.underflowX=1:this.underflowX=0,clamp.includes("top")?this.underflowY=-1:clamp.includes("bottom")?this.underflowY=
1:this.underflowY=0)}checkButtons(event){const isMouse="mouse"===event.data.pointerType,count=this.parent.input.count();if(1===count||1<count&&!this.parent.plugins.get("pinch",!0))if(!isMouse||this.mouse[event.data.button])return!0;return!1}checkKeyPress(event){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===event.data.pointerType}down(event){if(this.paused||!this.options.pressDrag)return!1;if(this.checkButtons(event)&&this.checkKeyPress(event))return this.last=
{x:event.data.global.x,y:event.data.global.y},this.current=event.data.pointerId,!0;this.last=null;return!1}get active(){return this.moved}move(event){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===event.data.pointerId){var x=event.data.global.x;const y=event.data.global.y;var count=this.parent.input.count();if(1===count||1<count&&!this.parent.plugins.get("pinch",!0)){count=x-this.last.x;const distY=y-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(count)||
this.yDirection&&this.parent.input.checkThreshold(distY))return x={x,y},this.xDirection&&(this.parent.x+=(x.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(x.y-this.last.y)*this.options.factor),this.last=x,this.moved||this.parent.emit("drag-start",{event,screen:new math.Point(this.last.x,this.last.y),world:this.parent.toWorld(new math.Point(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}else this.moved=
!1}return!1}up(event){if(this.paused)return!1;var touches=this.parent.input.touches;return 1===touches.length?(event=touches[0],event.last&&(this.last={x:event.last.x,y:event.last.y},this.current=event.id),this.moved=!1,!0):this.last&&this.moved?(touches=new math.Point(this.last.x,this.last.y),this.parent.emit("drag-end",{event,screen:touches,world:this.parent.toWorld(touches),viewport:this.parent}),this.last=null,this.moved=!1,!0):!1}wheel(event){if(this.paused)return!1;if(this.options.wheel){var wheel=
this.parent.plugins.get("wheel",!0);if(!wheel||!wheel.options.wheelZoom&&!event.ctrlKey)return wheel=event.deltaMode?this.options.lineHeight:1,this.xDirection&&(this.parent.x+=event.deltaX*wheel*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=event.deltaY*wheel*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||
event.preventDefault(),this.parent.options.stopPropagation&&event.stopPropagation(),!0}return!1}resume(){this.last=null;this.paused=!1}clamp(){const decelerate=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case -1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/
2}else 0>this.parent.left?(this.parent.x=0,decelerate.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,decelerate.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case -1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/
2}else 0>this.parent.top&&(this.parent.y=0,decelerate.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,decelerate.y=0)}}const DEFAULT_FOLLOW_OPTIONS={speed:0,acceleration:null,radius:null};class Follow extends Plugin{constructor(parent,target,options={}){super(parent);this.target=target;this.options=Object.assign({},DEFAULT_FOLLOW_OPTIONS,options);this.velocity={x:0,y:0}}update(elapsed){if(!this.paused){var center=
this.parent.center,toX=this.target.x,toY=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-center.y,2)+Math.pow(this.target.x-center.x,2))>this.options.radius)toY=Math.atan2(this.target.y-center.y,this.target.x-center.x),toX=this.target.x-Math.cos(toY)*this.options.radius,toY=this.target.y-Math.sin(toY)*this.options.radius;else return;var deltaX=toX-center.x,deltaY=toY-center.y;if(deltaX||deltaY)if(this.options.speed)if(this.options.acceleration){var angle=Math.atan2(toY-center.y,
toX-center.x);const distance=Math.sqrt(Math.pow(deltaX,2)+Math.pow(deltaY,2));distance&&(this.velocity=distance>(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration)?{x:Math.min(this.velocity.x+this.options.acceleration*elapsed,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*elapsed,this.options.speed)}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,
0)},elapsed=Math.cos(angle)*this.velocity.x,angle=Math.sin(angle)*this.velocity.y,this.parent.moveCenter(Math.abs(elapsed)>Math.abs(deltaX)?toX:center.x+elapsed,Math.abs(angle)>Math.abs(deltaY)?toY:center.y+angle),this.parent.emit("moved",{viewport:this.parent,type:"follow"}))}else angle=Math.atan2(toY-center.y,toX-center.x),elapsed=Math.cos(angle)*this.options.speed,angle=Math.sin(angle)*this.options.speed,this.parent.moveCenter(Math.abs(elapsed)>Math.abs(deltaX)?toX:center.x+elapsed,Math.abs(angle)>
Math.abs(deltaY)?toY:center.y+angle),this.parent.emit("moved",{viewport:this.parent,type:"follow"});else this.parent.moveCenter(toX,toY),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}}const MOUSE_EDGES_OPTIONS={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class MouseEdges extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},MOUSE_EDGES_OPTIONS,options);this.reverse=
this.options.reverse?1:-1;this.radiusSquared="number"===typeof this.options.radius?Math.pow(this.options.radius,2):null;this.resize()}resize(){const distance=this.options.distance;null!==distance?(this.top=this.left=distance,this.right=this.parent.worldScreenWidth-distance,this.bottom=this.parent.worldScreenHeight-distance):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.worldScreenWidth-this.options.right,this.bottom=
null===this.options.bottom?null:this.parent.worldScreenHeight-this.options.bottom)}down(){if(this.paused)return!1;this.options.allowButtons||(this.horizontal=this.vertical=null);return!1}move(event){if(this.paused||"mouse"!==event.data.pointerType&&1!==event.data.identifier||!this.options.allowButtons&&0!==event.data.buttons)return!1;var x=event.data.global.x;event=event.data.global.y;if(this.radiusSquared){const center=this.parent.toScreen(this.parent.center);Math.pow(center.x-x,2)+Math.pow(center.y-
event,2)>=this.radiusSquared?(x=Math.atan2(center.y-event,center.x-x),this.options.linear?(this.horizontal=Math.round(Math.cos(x))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(x))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(x)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(x)*this.options.speed*this.reverse*.06)):(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0)}else null!==
this.left&&x<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&x>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&event<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&event>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const decelerate=this.parent.plugins.get("decelerate",
!0);this.horizontal&&decelerate&&!this.options.noDecelerate&&decelerate.activate({x:this.horizontal*this.options.speed*this.reverse/(1E3/60)})}decelerateVertical(){const decelerate=this.parent.plugins.get("decelerate",!0);this.vertical&&decelerate&&!this.options.noDecelerate&&decelerate.activate({y:this.vertical*this.options.speed*this.reverse/(1E3/60)})}up(){if(this.paused)return!1;this.horizontal&&this.decelerateHorizontal();this.vertical&&this.decelerateVertical();this.horizontal=this.vertical=
null;return!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const center=this.parent.center;this.horizontal&&(center.x+=this.horizontal*this.options.speed);this.vertical&&(center.y+=this.vertical*this.options.speed);this.parent.moveCenter(center);this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const DEFAULT_PINCH_OPTIONS={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class Pinch extends Plugin{__init(){this.active=!1}__init2(){this.pinching=!1}__init3(){this.moved=
!1}constructor(parent,options={}){super(parent);Pinch.prototype.__init.call(this);Pinch.prototype.__init2.call(this);Pinch.prototype.__init3.call(this);this.options=Object.assign({},DEFAULT_PINCH_OPTIONS,options)}down(){return 2<=this.parent.input.count()?this.active=!0:!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(e){if(this.paused||!this.active)return!1;const x=e.data.global.x,y=e.data.global.y;var pointers=this.parent.input.touches;
if(2<=pointers.length){var first=pointers[0];const second=pointers[1];pointers=first.last&&second.last?Math.sqrt(Math.pow(second.last.x-first.last.x,2)+Math.pow(second.last.y-first.last.y,2)):null;first.id===e.data.pointerId?first.last={x,y,data:e.data}:second.id===e.data.pointerId&&(second.last={x,y,data:e.data});if(pointers){var oldPoint;e={x:first.last.x+(second.last.x-first.last.x)/2,y:first.last.y+(second.last.y-first.last.y)/2};this.options.center||(oldPoint=this.parent.toLocal(e));first=Math.sqrt(Math.pow(second.last.x-
first.last.x,2)+Math.pow(second.last.y-first.last.y,2));first=0===first?first=1E-10:first;first=(1-pointers/first)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=first);this.isAxisY()&&(this.parent.scale.y+=first);this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});(first=this.parent.plugins.get("clamp-zoom",!0))&&first.clamp();this.options.center?this.parent.moveCenter(this.options.center):(oldPoint=this.parent.toGlobal(oldPoint),
this.parent.x+=(e.x-oldPoint.x)*this.options.factor,this.parent.y+=(e.y-oldPoint.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"}));!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"}));this.lastCenter=e;this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);
return!0}return!1}up(){return this.pinching&&1>=this.parent.input.touches.length?(this.active=!1,this.lastCenter=null,this.moved=this.pinching=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}const DEFAULT_SNAP_OPTIONS={topLeft:!1,friction:.8,time:1E3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class Snap extends Plugin{constructor(parent,x,y,options={}){super(parent);this.options=Object.assign({},DEFAULT_SNAP_OPTIONS,options);this.ease=ease(options.ease,
"easeInOutSine");this.x=x;this.y=y;this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0;this.snapping={time:0};const current=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-current.x;this.deltaY=this.y-current.y;this.startX=current.x;this.startY=current.y;this.parent.emit("snap-start",this.parent)}wheel(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap");return!1}down(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):
this.options.interrupt&&(this.snapping=null);return!1}up(){if(0===this.parent.input.count()){const decelerate=this.parent.plugins.get("decelerate",!0);decelerate&&(decelerate.x||decelerate.y)&&(decelerate.percentChangeX=decelerate.percentChangeY=this.options.friction)}return!1}update(elapsed){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){var snapping=this.snapping;snapping.time+=elapsed;var x=this.startX;elapsed=this.startY;const deltaX=this.deltaX,deltaY=
this.deltaY;if(snapping.time>this.options.time){var finished=!0;x+=deltaX;elapsed+=deltaY}else snapping=this.ease(snapping.time,0,1,this.options.time),x+=deltaX*snapping,elapsed+=deltaY*snapping;this.options.topLeft?this.parent.moveCorner(x,elapsed):this.parent.moveCenter(x,elapsed);this.parent.emit("moved",{viewport:this.parent,type:"snap"});finished&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else finished=this.options.topLeft?
this.parent.corner:this.parent.center,finished.x===this.x&&finished.y===this.y||this.snapStart()}}const DEFAULT_SNAP_ZOOM_OPTIONS={width:0,height:0,time:1E3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class SnapZoom extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},DEFAULT_SNAP_ZOOM_OPTIONS,options);this.ease=ease(this.options.ease);this.yIndependent=this.xIndependent=!1;this.yScale=this.xScale=
0;0<this.options.width&&(this.xScale=parent.screenWidth/this.options.width,this.xIndependent=!0);0<this.options.height&&(this.yScale=parent.screenHeight/this.options.height,this.yIndependent=!0);this.xScale=this.xIndependent?this.xScale:this.yScale;this.yScale=this.yIndependent?this.yScale:this.xScale;0===this.options.time?(parent.container.scale.x=this.xScale,parent.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):options.forceStart&&this.createSnapping()}createSnapping(){const startWorldScreenWidth=
this.parent.worldScreenWidth,startWorldScreenHeight=this.parent.worldScreenHeight;this.snapping={time:0,startX:startWorldScreenWidth,startY:startWorldScreenHeight,deltaX:this.parent.screenWidth/this.xScale-startWorldScreenWidth,deltaY:this.parent.screenHeight/this.yScale-startWorldScreenHeight};this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null;0<this.options.width&&(this.xScale=this.parent.screenWidth/this.options.width);0<this.options.height&&(this.yScale=this.parent.screenHeight/
this.options.height);this.xScale=this.xIndependent?this.xScale:this.yScale;this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom");return!1}down(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null);return!1}update(elapsed){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count())){if(!this.options.center&&!this.options.noMove)var oldCenter=this.parent.center;
if(!this.snapping)this.parent.scale.x===this.xScale&&this.parent.scale.y===this.yScale||this.createSnapping();else if(this.snapping){var snapping=this.snapping;snapping.time+=elapsed;snapping.time>=this.options.time?(this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null):(snapping=this.snapping,elapsed=this.ease(snapping.time,snapping.startX,snapping.deltaX,this.options.time),
snapping=this.ease(snapping.time,snapping.startY,snapping.deltaY,this.options.time),this.parent.scale.x=this.parent.screenWidth/elapsed,this.parent.scale.y=this.parent.screenHeight/snapping);(elapsed=this.parent.plugins.get("clamp-zoom",!0))&&elapsed.clamp();this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(oldCenter))}}}resume(){this.snapping=null;super.resume()}}const DEFAULT_WHEEL_OPTIONS={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,
lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class Wheel extends Plugin{constructor(parent,options={}){super(parent);this.options=Object.assign({},DEFAULT_WHEEL_OPTIONS,options);this.keyIsPressed=!1;this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(codes){window.addEventListener("keydown",e=>{codes.includes(e.code)&&(this.keyIsPressed=!0)});window.addEventListener("keyup",e=>{codes.includes(e.code)&&(this.keyIsPressed=!1)})}checkKeyPress(){return!this.options.keyToPress||
this.keyIsPressed}down(){this.options.interrupt&&(this.smoothing=null);return!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const point=this.smoothingCenter;var change=this.smoothing,oldPoint;this.options.center||(oldPoint=this.parent.toLocal(point));this.isAxisX()&&(this.parent.scale.x+=change.x);this.isAxisY()&&(this.parent.scale.y+=change.y);this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});
(change=this.parent.plugins.get("clamp-zoom",!0))&&change.clamp();this.options.center?this.parent.moveCenter(this.options.center):(oldPoint=this.parent.toGlobal(oldPoint),this.parent.x+=point.x-oldPoint.x,this.parent.y+=point.y-oldPoint.y);this.parent.emit("moved",{viewport:this.parent,type:"wheel"});this.smoothingCount++;this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(e){if(!this.paused){var point=this.parent.input.getPointerPosition(e),change=Math.pow(2,-e.deltaY*(e.deltaMode?
this.options.lineHeight:1)/200*(1+this.options.percent)),oldPoint;this.options.center||(oldPoint=this.parent.toLocal(point));this.isAxisX()&&(this.parent.scale.x*=change);this.isAxisY()&&(this.parent.scale.y*=change);this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});(change=this.parent.plugins.get("clamp-zoom",!0))&&change.clamp();this.options.center?this.parent.moveCenter(this.options.center):(oldPoint=this.parent.toGlobal(oldPoint),this.parent.x+=point.x-oldPoint.x,this.parent.y+=point.y-
oldPoint.y);this.parent.emit("moved",{viewport:this.parent,type:"wheel"});this.parent.emit("wheel",{wheel:{dx:e.deltaX,dy:e.deltaY,dz:e.deltaZ},event:e,viewport:this.parent})}}wheel(e){if(this.paused||!this.checkKeyPress())return!1;if(e.ctrlKey&&this.options.trackpadPinch)this.pinch(e);else if(this.options.wheelZoom){const point=this.parent.input.getPointerPosition(e);var change=Math.pow(2,(this.options.reverse?-1:1)*-e.deltaY*(e.deltaMode?this.options.lineHeight:1)/500*(1+this.options.percent));
if(this.options.smooth)this.smoothing={x:((this.parent.scale.x+(this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0))*change-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+(this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0))*change-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=point;else{var oldPoint;this.options.center||(oldPoint=this.parent.toLocal(point));this.isAxisX()&&(this.parent.scale.x*=
change);this.isAxisY()&&(this.parent.scale.y*=change);this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});(change=this.parent.plugins.get("clamp-zoom",!0))&&change.clamp();this.options.center?this.parent.moveCenter(this.options.center):(oldPoint=this.parent.toGlobal(oldPoint),this.parent.x+=point.x-oldPoint.x,this.parent.y+=point.y-oldPoint.y)}this.parent.emit("moved",{viewport:this.parent,type:"wheel"});this.parent.emit("wheel",{wheel:{dx:e.deltaX,dy:e.deltaY,dz:e.deltaZ},event:e,viewport:this.parent})}return!this.parent.options.passiveWheel}}
class InputManager{constructor(viewport){this.viewport=viewport;this.touches=[];this.addListeners()}addListeners(){this.viewport.interactive=!0;this.viewport.forceHitArea||(this.viewport.hitArea=new math.Rectangle(0,0,this.viewport.worldWidth,this.viewport.worldHeight));this.viewport.on("pointerdown",this.down,this);this.viewport.on("pointermove",this.move,this);this.viewport.on("pointerup",this.up,this);this.viewport.on("pointerupoutside",this.up,this);this.viewport.on("pointercancel",this.up,this);
this.viewport.on("pointerout",this.up,this);this.wheelFunction=e=>this.handleWheel(e);this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel});this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(event){if(!this.viewport.pause&&this.viewport.worldVisible){"mouse"===event.data.pointerType?this.isMouseDown=!0:this.get(event.data.pointerId)||this.touches.push({id:event.data.pointerId,
last:null});if(1===this.count()){this.last=event.data.global.clone();const decelerate=this.viewport.plugins.get("decelerate",!0),bounce=this.viewport.plugins.get("bounce",!0);decelerate&&decelerate.isActive()||bounce&&bounce.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(event)&&this.viewport.options.stopPropagation&&event.stopPropagation()}}clear(){this.isMouseDown=!1;this.touches=[];this.last=null}checkThreshold(change){return Math.abs(change)>=
this.viewport.threshold?!0:!1}move(event){if(!this.viewport.pause&&this.viewport.worldVisible){var stop=this.viewport.plugins.move(event);if(this.clickedAvailable&&this.last){const distY=event.data.global.y-this.last.y;if(this.checkThreshold(event.data.global.x-this.last.x)||this.checkThreshold(distY))this.clickedAvailable=!1}stop&&this.viewport.options.stopPropagation&&event.stopPropagation()}}up(event){if(!this.viewport.pause&&this.viewport.worldVisible){"mouse"===event.data.pointerType&&(this.isMouseDown=
!1);"mouse"!==event.data.pointerType&&this.remove(event.data.pointerId);var stop=this.viewport.plugins.up(event);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1);stop&&this.viewport.options.stopPropagation&&event.stopPropagation()}}getPointerPosition(event){const point=new math.Point;this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(point,
event.clientX,event.clientY):(point.x=event.clientX,point.y=event.clientY);return point}handleWheel(event){if(!this.viewport.pause&&this.viewport.worldVisible&&(!this.viewport.options.interaction||this.viewport.options.interaction.interactionDOMElement===event.target)){var point=this.viewport.toLocal(this.getPointerPosition(event));this.viewport.left<=point.x&&point.x<=this.viewport.right&&this.viewport.top<=point.y&&point.y<=this.viewport.bottom&&this.viewport.plugins.wheel(event)&&!this.viewport.options.passiveWheel&&
event.preventDefault()}}pause(){this.touches=[];this.isMouseDown=!1}get(id){for(const touch of this.touches)if(touch.id===id)return touch;return null}remove(id){for(let i=0;i<this.touches.length;i++)if(this.touches[i].id===id){this.touches.splice(i,1);break}}count(){return(this.isMouseDown?1:0)+this.touches.length}}const PLUGIN_ORDER="drag pinch wheel follow mouse-edges decelerate animate bounce snap-zoom clamp-zoom snap clamp".split(" ");class PluginManager{constructor(viewport){this.viewport=viewport;
this.list=[];this.plugins={}}add(name,plugin,index=PLUGIN_ORDER.length){this.plugins[name]=plugin;plugin=PLUGIN_ORDER.indexOf(name);-1!==plugin&&PLUGIN_ORDER.splice(plugin,1);PLUGIN_ORDER.splice(index,0,name);this.sort()}get(name,ignorePaused){return ignorePaused&&_optionalChain([this,"access",_=>_.plugins,"access",_2=>_2[name],"optionalAccess",_3=>_3.paused])?null:this.plugins[name]}update(elapsed){for(const plugin of this.list)plugin.update(elapsed)}resize(){for(const plugin of this.list)plugin.resize()}reset(){for(const plugin of this.list)plugin.reset()}removeAll(){this.plugins=
{};this.sort()}remove(name){this.plugins[name]&&(delete this.plugins[name],this.viewport.emit(`${name}-remove`),this.sort())}pause(name){_optionalChain([this,"access",_4=>_4.plugins,"access",_5=>_5[name],"optionalAccess",_6=>_6.pause,"call",_7=>_7()])}resume(name){_optionalChain([this,"access",_8=>_8.plugins,"access",_9=>_9[name],"optionalAccess",_10=>_10.resume,"call",_11=>_11()])}sort(){this.list=[];for(const plugin of PLUGIN_ORDER)this.plugins[plugin]&&this.list.push(this.plugins[plugin])}down(event){let stop=
!1;for(const plugin of this.list)plugin.down(event)&&(stop=!0);return stop}move(event){let stop=!1;for(const plugin of this.viewport.plugins.list)plugin.move(event)&&(stop=!0);return stop}up(event){let stop=!1;for(const plugin of this.list)plugin.up(event)&&(stop=!0);return stop}wheel(e){let result=!1;for(const plugin of this.list)plugin.wheel(e)&&(result=!0);return result}}const DEFAULT_VIEWPORT_OPTIONS={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,
threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:require.Ticker.shared};class Viewport extends module$jscomp$0.Container{__init(){this._disableOnContextMenu=e=>e.preventDefault()}constructor(options={}){super();Viewport.prototype.__init.call(this);this.options=Object.assign({},{divWheel:document.body},DEFAULT_VIEWPORT_OPTIONS,options);this.screenWidth=this.options.screenWidth;this.screenHeight=this.options.screenHeight;this._worldWidth=
this.options.worldWidth;this._worldHeight=this.options.worldHeight;this.forceHitArea=this.options.forceHitArea;this.threshold=this.options.threshold;this.options.divWheel=this.options.divWheel||document.body;this.options.disableOnContextMenu&&this.options.divWheel.addEventListener("contextmenu",this._disableOnContextMenu);this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction));this.input=new InputManager(this);this.plugins=
new PluginManager(this)}destroy(options){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction);this.options.disableOnContextMenu&&this.options.divWheel.removeEventListener("contextmenu",this._disableOnContextMenu);this.input.destroy();super.destroy(options)}update(elapsed){this.pause||(this.plugins.update(elapsed),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=
!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this.hitArea=this._hitAreaDefault=new math.Rectangle(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport=
{x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(screenWidth=window.innerWidth,screenHeight=window.innerHeight,worldWidth,worldHeight){this.screenWidth=screenWidth;this.screenHeight=screenHeight;"undefined"!==typeof worldWidth&&(this._worldWidth=worldWidth);"undefined"!==typeof worldHeight&&(this._worldHeight=worldHeight);this.plugins.resize();this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(value){this._worldWidth=
value;this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(value){this._worldHeight=value;this.plugins.resize()}getVisibleBounds(){return new math.Rectangle(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(x,y){return 2===arguments.length?this.toLocal(new math.Point(x,y)):this.toLocal(x)}toScreen(x,y){return 2===arguments.length?this.toGlobal(new math.Point(x,y)):this.toGlobal(x)}get worldScreenWidth(){return this.screenWidth/
this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new math.Point(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(value){this.moveCenter(value)}moveCenter(...args){if("number"===typeof args[0]){var x=args[0];args=args[1]}else x=args[0].x,args=args[0].y;x=(this.worldScreenWidth/2-x)*this.scale.x;
args=(this.worldScreenHeight/2-args)*this.scale.y;if(this.x!==x||this.y!==args)this.position.set(x,args),this.plugins.reset(),this.dirty=!0;return this}get corner(){return new math.Point(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(value){this.moveCorner(value)}moveCorner(...args){let x;1===args.length?(x=-args[0].x*this.scale.x,args=-args[0].y*this.scale.y):(x=-args[0]*this.scale.x,args=-args[1]*this.scale.y);if(x!==this.x||args!==this.y)this.position.set(x,args),this.plugins.reset(),this.dirty=
!0;return this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(width){return this.screenWidth/width}findFitHeight(height){return this.screenHeight/height}findFit(width,height){return Math.min(this.screenWidth/width,this.screenHeight/height)}findCover(width,height){return Math.max(this.screenWidth/width,this.screenHeight/height)}fitWidth(width=this.worldWidth,center,scaleY=!0,noClamp){let save;center&&
(save=this.center);this.scale.x=this.screenWidth/width;scaleY&&(this.scale.y=this.scale.x);width=this.plugins.get("clamp-zoom",!0);!noClamp&&width&&width.clamp();center&&save&&this.moveCenter(save);return this}fitHeight(height=this.worldHeight,center,scaleX=!0,noClamp){let save;center&&(save=this.center);this.scale.y=this.screenHeight/height;scaleX&&(this.scale.x=this.scale.y);height=this.plugins.get("clamp-zoom",!0);!noClamp&&height&&height.clamp();center&&save&&this.moveCenter(save);return this}fitWorld(center){let save;
center&&(save=this.center);this.scale.x=this.screenWidth/this.worldWidth;this.scale.y=this.screenHeight/this.worldHeight;this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const clampZoom=this.plugins.get("clamp-zoom",!0);clampZoom&&clampZoom.clamp();center&&save&&this.moveCenter(save);return this}fit(center,width=this.worldWidth,height=this.worldHeight){let save;center&&(save=this.center);this.scale.x=this.screenWidth/width;this.scale.y=this.screenHeight/height;this.scale.x<
this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;(width=this.plugins.get("clamp-zoom",!0))&&width.clamp();center&&save&&this.moveCenter(save);return this}setZoom(scale,center){let save;center&&(save=this.center);this.scale.set(scale);(scale=this.plugins.get("clamp-zoom",!0))&&scale.clamp();center&&save&&this.moveCenter(save);return this}zoomPercent(percent,center){return this.setZoom(this.scale.x+this.scale.x*percent,center)}zoom(change,center){this.fitWidth(change+this.worldScreenWidth,
center);return this}get scaled(){return this.scale.x}set scaled(scale){this.setZoom(scale,!0)}snapZoom(options){this.plugins.add("snap-zoom",new SnapZoom(this,options));return this}OOB(){return{left:0>this.left,right:this.right>this.worldWidth,top:0>this.top,bottom:this.bottom>this.worldHeight,cornerPoint:new math.Point(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(value){this.x=
-value*this.scale.x+this.screenWidth;this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(value){this.x=-value*this.scale.x;this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(value){this.y=-value*this.scale.y;this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(value){this.y=-value*this.scale.y+this.screenHeight;this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(value){this._dirty=value}get forceHitArea(){return this._forceHitArea}set forceHitArea(value){value?
this.hitArea=this._forceHitArea=value:(this._forceHitArea=null,this.hitArea=new math.Rectangle(0,0,this.worldWidth,this.worldHeight))}drag(options){this.plugins.add("drag",new Drag(this,options));return this}clamp(options){this.plugins.add("clamp",new Clamp(this,options));return this}decelerate(options){this.plugins.add("decelerate",new Decelerate(this,options));return this}bounce(options){this.plugins.add("bounce",new Bounce(this,options));return this}pinch(options){this.plugins.add("pinch",new Pinch(this,
options));return this}snap(x,y,options){this.plugins.add("snap",new Snap(this,x,y,options));return this}follow(target,options){this.plugins.add("follow",new Follow(this,target,options));return this}wheel(options){this.plugins.add("wheel",new Wheel(this,options));return this}animate(options){this.plugins.add("animate",new Animate(this,options));return this}clampZoom(options){this.plugins.add("clamp-zoom",new ClampZoom(this,options));return this}mouseEdges(options){this.plugins.add("mouse-edges",new MouseEdges(this,
options));return this}get pause(){return!!this._pause}set pause(value){this._pause=value;this.lastViewport=null;this.zooming=this.moving=!1;value&&this.input.pause()}ensureVisible(x,y,width,height,resizeToFit){resizeToFit&&(width>this.worldScreenWidth||height>this.worldScreenHeight)&&(this.fit(!0,width,height),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));resizeToFit=!1;x<this.left?(this.left=x,resizeToFit=!0):x+width>this.right&&(this.right=x+width,resizeToFit=!0);y<this.top?(this.top=
y,resizeToFit=!0):y+height>this.bottom&&(this.bottom=y+height,resizeToFit=!0);resizeToFit&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}exports$jscomp$0.Animate=Animate;exports$jscomp$0.Bounce=Bounce;exports$jscomp$0.Clamp=Clamp;exports$jscomp$0.ClampZoom=ClampZoom;exports$jscomp$0.Decelerate=Decelerate;exports$jscomp$0.Drag=Drag;exports$jscomp$0.Follow=Follow;exports$jscomp$0.InputManager=InputManager;exports$jscomp$0.MouseEdges=MouseEdges;exports$jscomp$0.Pinch=Pinch;exports$jscomp$0.Plugin=
Plugin;exports$jscomp$0.PluginManager=PluginManager;exports$jscomp$0.Snap=Snap;exports$jscomp$0.SnapZoom=SnapZoom;exports$jscomp$0.Viewport=Viewport;exports$jscomp$0.Wheel=Wheel}
//# sourceMappingURL=module$node_modules$pixi_viewport$dist$cjs$viewport.js.map
