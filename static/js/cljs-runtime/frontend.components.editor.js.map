{"version":3,"sources":["frontend/components/editor.cljs"],"mappings":"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","names":["rum.core/lazy-build","rum.core/build-defc","frontend.components.editor/commands","rum.core/reactive","id","format","matched","frontend.util/react","frontend.commands/*matched-commands","frontend.commands/*show-commands","frontend.ui/auto-complete","item","cljs.core.get","frontend.commands/*first-command-group","cljs.core/first","command-name","command-doc","doc","frontend.state/show-command-doc?","cljs.core/vector?","frontend.ui/tippy","frontend.components.svg.help_circle","chosen-item","command","cljs.core/reset!","frontend.commands/*current-command","command-steps","cljs.core.into","restore-slash?","cljs.core/contains?","cljs.core/fn?","cljs.core/set","cljs.core.map","frontend.handler.editor/insert-command!","frontend.state/pub-event!","frontend.components.editor/block-commands","frontend.commands/*show-block-commands","frontend.commands/*matched-block-commands","chosen","frontend.commands/angle-bracket","frontend.components.editor/in-sidebar?","el","cljs.core/not","js/document","frontend.components.editor/page-search","state","frontend.handler.editor/*selected-text","frontend.state/sub","pos","frontend.state/get-editor-last-pos","input","goog.dom/getElement","current-pos","frontend.util.cursor/pos","edit-content","or__5043__auto__","sidebar?","q","cljs.core/deref","logseq.graph_parser.util.safe_subs","cljs.core/count","matched-pages","clojure.string/blank?","frontend.handler.editor/get-matched-pages","frontend.util/page-name-sanity-lc","G__50867","clojure.string/trim","cljs.core/empty?","cljs.core/cons","cljs.core.remove","cljs.core/nil?","cljs.core.sort_by","m","goog.string/caseInsensitiveStartsWith","cljs.core/rest","frontend.handler.page/on-chosen-handler","frontend.handler.page/page-not-exists-handler","page-name","chosen?","frontend.components.block/page-preview-trigger","frontend.components.search/highlight-exact-query","rum.core/build-defcs","frontend.components.editor/block-search-auto-complete","cljs.core.assoc","cljs.core.atom","vec__50884","cljs.core.nth","result","edit-block","_","promesa.core.bind","___28360__auto__","promesa.protocols/-promise","matched-blocks","frontend.handler.editor/get-matched-blocks","_edit-block","rum.core/react","chosen-handler","frontend.handler.editor/block-on-chosen-handler","non-exist-block-handler","frontend.handler.editor/block-non-exist-handler","p__50875","map__50876","cljs.core/--destructure-map","page","uuid","repo","frontend.db/get-page-format","block","frontend.db.model/query-block-by-uuid","content","frontend.components.search/block-search-result-item","vec__50887","frontend.components.editor/block-search","frontend.state/clear-search-result!","_format","frontend.state/get-edit-block","cljs.core.subs","frontend.components.editor/template-search","matched-templates","frontend.handler.editor/get-matched-templates","non-exist-handler","_state","frontend.state/set-editor-show-template-search!","frontend.handler.editor/template-on-chosen-handler","p__50894","vec__50895","template","_block-db-id","daiquiri.interpreter/interpret","frontend.components.editor/input","rum.core.local","frontend.mixins.event_mixin","frontend.mixins.on_key_down","e","input-value","input-option","frontend.state/state","cljs.core/seq","frontend.util/stop","vec__50929","map__50932","_id","on-submit","frontend.commands/*slash-caret-pos","G__50933","G__50934","G__50935","temp__5720__auto__","map__50916","iter__5520__auto__","s__50918","cljs.core/LazySeq","cljs.core/chunked-seq?","c__5518__auto__","size__5519__auto__","b__50920","cljs.core/chunk-buffer","i__50919","map__50922","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__50917","cljs.core/chunk-rest","map__50924","placeholder","type","autoFocus","input-item","cljs.core.merge","G__50923","G__50925","cljs.core/name","cljs.core.swap_BANG_","cljs.core/assoc","frontend.util/evalue","frontend.util/chrome?","cljs.core.dissoc","frontend.ui.button","G__50926","G__50927","G__50928","p__50936","map__50937","daiquiri.core/create-element","daiquiri.interpreter/element-attributes","daiquiri.util/join-classes","frontend.components.editor/absolute-modal","rum.core/static","cp","set-default-width?","top","left","rect","max-height","max-width","offset-top","vw-height","js/window.innerHeight","to-max-height","delta-height","x__5128__auto__","y__5129__auto__","right-sidebar?","editing-key","cljs.core/keys","*el","rum.core/use-ref","rum.core.use_effect_BANG_","cnt","and__5041__auto__","js/document.querySelector","rum.core/deref","ofx","y-overflow-vh?","pos-rect","frontend.util.cursor.get_caret_pos","frontend.state/get-input","y-diff","cljs.core/int?","editor","cljs.core._EQ_","frontend.components.editor/transition-cp","G__50940","G__50941","frontend.ui/css-transition","rum.core/mark-sync-update","frontend.components.editor/image-uploader","files","frontend.handler.editor/upload-asset","frontend.handler.editor/*asset-uploading?","uploading?","processing","frontend.handler.editor/*asset-uploading-process","frontend.ui/loading","frontend.util.format","frontend.components.editor/set-up-key-down!","frontend.handler.editor/keydown-not-matched-handler","frontend.components.editor/set-up-key-up!","input-id","search-timeout","frontend.mixins/on-key-up","frontend.handler.editor/keyup-handler","frontend.components.editor/search-timeout","frontend.components.editor/setup-key-listener!","map__50944","frontend.handler.editor/get-state","frontend.components.editor/starts-with?","clojure.string/starts-with?","frontend.components.editor/get-editor-style-class","clojure.string/includes?","G__50953","cljs.core/Keyword","frontend.components.editor/editor-row-height-unchanged?","last-key","frontend.state/get-last-key-code","cljs.core.not_EQ_","frontend.util.keycode/enter","frontend.util.keycode/enter-code","cljs.core.into_array","s__50955","b__50957","i__50956","vec__50958","iter__50954","vec__50963","frontend.components.editor/mock-textarea","e50967","frontend.handler.editor/handle-last-input","js/Error","_e","frontend.state/set-state!","idx","c","cljs.core.map_indexed","cljs.core/vector","clojure.string.split","frontend.components.editor/mock-textarea-wrapper","frontend.state/sub-edit-content","frontend.components.editor/animated-modal","key","component","*pos","G__50970","G__50971","frontend.components.editor/modals","G__50973","frontend.ui/transition-group","frontend.commands/*angle-bracket-caret-pos","frontend.components.datetime/date-picker","_pos","frontend.handler.editor/handle-command-input","frontend.extensions.zotero/zotero-search","p__50975","map__50976","frontend.components.editor/box","cljs.core/random-uuid","frontend.state/set-editor-args!","frontend.modules.shortcut.core/mixin","frontend.handler.editor.lifecycle/lifecycle","_config","heading-class","frontend.mobile.footer/audio-record-cp","frontend.ui/ls-textarea","frontend.state/enable-grammarly?","frontend.handler.editor/editor-on-click!","frontend.handler.editor/editor-on-change!","frontend.handler.editor/editor-on-paste!","cljs.core/chunk-first"],"sourcesContent":["(ns frontend.components.editor\n  (:require [clojure.string :as string]\n            [goog.string :as gstring]\n            [frontend.commands :as commands\n             :refer [*angle-bracket-caret-pos *first-command-group *matched-block-commands *matched-commands *show-block-commands *show-commands *slash-caret-pos]]\n            [frontend.components.block :as block]\n            [frontend.components.datetime :as datetime-comp]\n            [frontend.components.search :as search]\n            [frontend.components.svg :as svg]\n            [frontend.db :as db]\n            [frontend.db.model :as db-model]\n            [frontend.extensions.zotero :as zotero]\n            [frontend.handler.editor :as editor-handler :refer [get-state]]\n            [frontend.handler.editor.lifecycle :as lifecycle]\n            [frontend.handler.page :as page-handler]\n            [frontend.mixins :as mixins]\n            [frontend.modules.shortcut.core :as shortcut]\n            [frontend.state :as state]\n            [frontend.ui :as ui]\n            [frontend.util :as util]\n            [frontend.util.cursor :as cursor]\n            [frontend.util.keycode :as keycode]\n            [logseq.graph-parser.util :as gp-util]\n            [goog.dom :as gdom]\n            [promesa.core :as p]\n            [rum.core :as rum]\n            [frontend.mobile.footer :as footer]))\n\n(rum/defc commands < rum/reactive\n  [id format]\n  (let [matched (util/react *matched-commands)]\n    (when (util/react *show-commands)\n      (ui/auto-complete\n       matched\n       {:get-group-name\n        (fn [item]\n          (get *first-command-group (first item)))\n\n        :item-render\n        (fn [item]\n          (let [command-name (first item)\n                command-doc (get item 2)\n                doc (when (state/show-command-doc?) command-doc)]\n            (cond\n              (string? doc)\n              [:div {:title doc}\n               command-name]\n\n              (vector? doc)\n              [:div.has-help\n               command-name\n               (ui/tippy\n                {:html doc\n                 :interactive true\n                 :fixed-position? true\n                 :position \"right\"}\n\n                [:small (svg/help-circle)])]\n\n              :else\n              [:div command-name])))\n\n        :on-chosen\n        (fn [chosen-item]\n          (let [command (first chosen-item)]\n            (reset! commands/*current-command command)\n            (let [command-steps (get (into {} matched) command)\n                  restore-slash? (or\n                                  (contains? #{\"Today\" \"Yesterday\" \"Tomorrow\" \"Current time\"} command)\n                                  (and\n                                   (not (fn? command-steps))\n                                   (not (contains? (set (map first command-steps)) :editor/input))\n                                   (not (contains? #{\"Date picker\" \"Template\" \"Deadline\" \"Scheduled\" \"Upload an image\"} command))))]\n              (editor-handler/insert-command! id command-steps\n                                              format\n                                              {:restore? restore-slash?})\n              (state/pub-event! [:instrument {:type :editor/command-triggered\n                                              :payload {:command command}}]))))\n        :class\n        \"black\"}))))\n\n(rum/defc block-commands < rum/reactive\n  [id format]\n  (when (util/react *show-block-commands)\n    (let [matched (util/react *matched-block-commands)]\n      (ui/auto-complete\n       (map first matched)\n       {:on-chosen (fn [chosen]\n                     (editor-handler/insert-command! id (get (into {} matched) chosen)\n                                                     format\n                                                     {:last-pattern commands/angle-bracket}))\n        :class     \"black\"}))))\n\n(defn- in-sidebar? [el]\n  (not (.contains (.getElementById js/document \"left-container\") el)))\n\n(rum/defc page-search < rum/reactive\n  {:will-unmount (fn [state] (reset! editor-handler/*selected-text nil) state)}\n  \"Embedded page searching popup\"\n  [id format]\n  (when (state/sub :editor/show-page-search?)\n    (let [pos (state/get-editor-last-pos)\n          input (gdom/getElement id)]\n      (when input\n        (let [current-pos (cursor/pos input)\n              edit-content (or (state/sub [:editor/content id]) \"\")\n              sidebar? (in-sidebar? input)\n              q (or\n                 @editor-handler/*selected-text\n                 (when (state/sub :editor/show-page-search-hashtag?)\n                   (gp-util/safe-subs edit-content pos current-pos))\n                 (when (> (count edit-content) current-pos)\n                   (gp-util/safe-subs edit-content pos current-pos))\n                 \"\")\n              matched-pages (when-not (string/blank? q)\n                              (editor-handler/get-matched-pages q))\n              matched-pages (cond\n                              (contains? (set (map util/page-name-sanity-lc matched-pages)) (util/page-name-sanity-lc (string/trim q)))  ;; if there's a page name fully matched\n                              matched-pages\n\n                              (string/blank? q)\n                              nil\n\n                              (empty? matched-pages)\n                              (cons (str \"New page: \" q) matched-pages)\n\n                              ;; reorder, shortest and starts-with first.\n                              :else\n                              (let [matched-pages (remove nil? matched-pages)\n                                    matched-pages (sort-by\n                                                   (fn [m]\n                                                     [(not (gstring/caseInsensitiveStartsWith m q)) (count m)])\n                                                   matched-pages)]\n                                (if (gstring/caseInsensitiveStartsWith (first matched-pages) q)\n                                  (cons (first matched-pages)\n                                        (cons  (str \"New page: \" q) (rest matched-pages)))\n                                  (cons (str \"New page: \" q) matched-pages))))]\n          (ui/auto-complete\n           matched-pages\n           {:on-chosen   (page-handler/on-chosen-handler input id q pos format)\n            :on-enter    #(page-handler/page-not-exists-handler input id q current-pos)\n            :item-render (fn [page-name chosen?]\n                           [:div.preview-trigger-wrapper\n                            (block/page-preview-trigger\n                             {:children        [:div (search/highlight-exact-query page-name q)]\n                              :open?           chosen?\n                              :manual?         true\n                              :fixed-position? true\n                              :tippy-distance  24\n                              :tippy-position  (if sidebar? \"left\" \"right\")}\n                             page-name)])\n            :empty-placeholder [:div.text-gray-500.text-sm.px-4.py-2 \"Search for a page\"]\n            :class       \"black\"}))))))\n\n(rum/defcs block-search-auto-complete < rum/reactive\n  {:init (fn [state]\n           (assoc state ::result (atom nil)))\n   :did-update (fn [state]\n                 (let [result (::result state)\n                       [edit-block _ _ q] (:rum/args state)]\n                   (p/let [matched-blocks (when-not (string/blank? q)\n                                            (editor-handler/get-matched-blocks q (:block/uuid edit-block)))]\n                     (reset! result matched-blocks)))\n                 state)}\n  [state _edit-block input id q format]\n  (let [result (rum/react (get state ::result))\n        chosen-handler (editor-handler/block-on-chosen-handler input id q format)\n        non-exist-block-handler (editor-handler/block-non-exist-handler input)]\n    (when result\n      (ui/auto-complete\n       result\n       {:on-chosen   chosen-handler\n        :on-enter    non-exist-block-handler\n        :empty-placeholder   [:div.text-gray-500.pl-4.pr-4 \"Search for a block\"]\n        :item-render (fn [{:block/keys [page uuid]}]  ;; content returned from search engine is normalized\n                       (let [page (or (:block/original-name page)\n                                      (:block/name page))\n                             repo (state/sub :git/current-repo)\n                             format (db/get-page-format page)\n                             block (db-model/query-block-by-uuid uuid)\n                             content (:block/content block)]\n                         [:.py-2 (search/block-search-result-item repo uuid format content q :block)]))\n        :class       \"black\"}))))\n\n(rum/defcs block-search < rum/reactive\n  {:will-unmount (fn [state]\n                   (reset! editor-handler/*selected-text nil)\n                   (state/clear-search-result!)\n                   state)}\n  [state id _format]\n  (when (state/sub :editor/show-block-search?)\n    (let [pos (state/get-editor-last-pos)\n          input (gdom/getElement id)\n          [id format] (:rum/args state)\n          current-pos (cursor/pos input)\n          edit-content (state/sub [:editor/content id])\n          edit-block (state/get-edit-block)\n          q (or\n             @editor-handler/*selected-text\n             (when (> (count edit-content) current-pos)\n               (subs edit-content pos current-pos)))]\n      (when input\n        (block-search-auto-complete edit-block input id q format)))))\n\n(rum/defc template-search < rum/reactive\n  {:will-unmount (fn [state] (reset! editor-handler/*selected-text nil) state)}\n  [id _format]\n  (when (state/sub :editor/show-template-search?)\n    (let [pos (state/get-editor-last-pos)\n          input (gdom/getElement id)]\n      (when input\n        (let [current-pos (cursor/pos input)\n              edit-content (state/sub [:editor/content id])\n              q (or\n                 (when (>= (count edit-content) current-pos)\n                   (subs edit-content pos current-pos))\n                 \"\")\n              matched-templates (editor-handler/get-matched-templates q)\n              non-exist-handler (fn [_state]\n                                  (state/set-editor-show-template-search! false))]\n          (ui/auto-complete\n           matched-templates\n           {:on-chosen   (editor-handler/template-on-chosen-handler id)\n            :on-enter    non-exist-handler\n            :empty-placeholder [:div.text-gray-500.px-4.py-2.text-sm \"Search for a template\"]\n            :item-render (fn [[template _block-db-id]]\n                           template)\n            :class       \"black\"}))))))\n\n(rum/defcs input < rum/reactive\n  (rum/local {} ::input-value)\n  (mixins/event-mixin\n   (fn [state]\n     (mixins/on-key-down\n      state\n      {;; enter\n       13 (fn [state e]\n            (let [input-value (get state ::input-value)\n                  input-option (get @state/state :editor/show-input)]\n              (when (seq @input-value)\n                ;; no new line input\n                (util/stop e)\n                (let [[_id on-submit] (:rum/args state)\n                      {:keys [pos]} @*slash-caret-pos\n                      command (:command (first input-option))]\n                  (on-submit command @input-value pos))\n                (reset! input-value nil))))})))\n  [state _id on-submit]\n  (when-let [input-option (state/sub :editor/show-input)]\n    (let [{:keys [pos]} (util/react *slash-caret-pos)\n          input-value (get state ::input-value)]\n      (when (seq input-option)\n        (let [command (:command (first input-option))]\n          [:div.p-2.rounded-md.shadow-lg\n           (for [{:keys [id placeholder type autoFocus] :as input-item} input-option]\n             [:div.my-3 {:key id}\n              [:input.form-input.block.w-full.pl-2.sm:text-sm.sm:leading-5\n               (merge\n                (cond->\n                 {:key           (str \"modal-input-\" (name id))\n                  :id            (str \"modal-input-\" (name id))\n                  :type          (or type \"text\")\n                  :on-change     (fn [e]\n                                   (swap! input-value assoc id (util/evalue e)))\n                  :auto-complete (if (util/chrome?) \"chrome-off\" \"off\")}\n                  placeholder\n                  (assoc :placeholder placeholder)\n                  autoFocus\n                  (assoc :auto-focus true))\n                (dissoc input-item :id))]])\n           (ui/button\n            \"Submit\"\n            :on-click\n            (fn [e]\n              (util/stop e)\n              (on-submit command @input-value pos)))])))))\n\n(rum/defc absolute-modal < rum/static\n  [cp set-default-width? {:keys [top left rect]}]\n  (let [max-height 370\n        max-width 300\n        offset-top 24\n        vw-height js/window.innerHeight\n        to-max-height (if (and (seq rect) (> vw-height max-height))\n                        (let [delta-height (- vw-height (+ (:top rect) top offset-top))]\n                          (if (< delta-height max-height)\n                            (- (max (* 2 offset-top) delta-height) 16)\n                            max-height))\n                        max-height)\n        right-sidebar? (:ui/sidebar-open? @state/state)\n        editing-key    (first (keys (:editor/editing? @state/state)))\n        *el (rum/use-ref nil)\n        _ (rum/use-effect! (fn []\n                             (when-let [^js/HTMLElement cnt\n                                        (and right-sidebar? editing-key\n                                             (js/document.querySelector \"#main-content-container\"))]\n                               (when (.contains cnt (js/document.querySelector (str \"#\" editing-key)))\n                                 (let [el  (rum/deref *el)\n                                       ofx (- (.-scrollWidth cnt) (.-clientWidth cnt))]\n                                   (when (> ofx 0)\n                                     (set! (.-transform (.-style el)) (str \"translateX(-\" (+ ofx 20) \"px)\")))))))\n                           [right-sidebar? editing-key])\n        y-overflow-vh? (< to-max-height 130)\n        to-max-height (if y-overflow-vh? max-height to-max-height)\n        pos-rect (when (and (seq rect) editing-key)\n                   (:rect (cursor/get-caret-pos (state/get-input))))\n        y-diff (when pos-rect (- (:height pos-rect) (:height rect)))]\n    [:div.absolute.rounded-md.shadow-lg.absolute-modal\n     {:ref *el\n      :class (if y-overflow-vh? \"is-overflow-vh-y\" \"\")\n      :on-mouse-down (fn [e]\n                       (.stopPropagation e))\n      :style (merge\n              {:top        (+ top offset-top (if (int? y-diff) y-diff 0))\n               :max-height to-max-height\n               :max-width 700\n               ;; TODO: auto responsive fixed size\n               :width \"fit-content\"\n               :z-index    11}\n              (when set-default-width?\n                {:width max-width})\n              (let [^js/HTMLElement editor\n                    (js/document.querySelector \".editor-wrapper\")]\n                (if (<= (.-clientWidth editor) (+ left (if set-default-width? max-width 500)))\n                  {:right 0}\n                  {:left (if (and y-diff (= y-diff 0)) left 0)})))}\n     cp]))\n\n(rum/defc transition-cp < rum/reactive\n  [cp set-default-width? pos]\n  (when pos\n    (when-let [pos (rum/react pos)]\n      (ui/css-transition\n       {:class-names \"fade\"\n        :timeout     {:enter 500\n                      :exit  300}}\n       (absolute-modal cp set-default-width? pos)))))\n\n(rum/defc image-uploader < rum/reactive\n  [id format]\n  [:div.image-uploader\n   [:input\n    {:id        \"upload-file\"\n     :type      \"file\"\n     :on-change (fn [e]\n                  (let [files (.-files (.-target e))]\n                    (editor-handler/upload-asset id files format editor-handler/*asset-uploading? false)))\n     :hidden    true}]\n   #_:clj-kondo/ignore\n   (when-let [uploading? (util/react editor-handler/*asset-uploading?)]\n     (let [processing (util/react editor-handler/*asset-uploading-process)]\n       (transition-cp\n        [:div.flex.flex-row.align-center.rounded-md.shadow-sm.bg-base-2.px-1.py-1\n         (ui/loading\n          (util/format \"Uploading %s%\" (util/format \"%2d\" processing)))]\n        false\n        *slash-caret-pos)))])\n\n(defn- set-up-key-down!\n  [state format]\n  (mixins/on-key-down\n   state\n   {}\n   {:not-matched-handler (editor-handler/keydown-not-matched-handler format)}))\n\n(defn- set-up-key-up!\n  [state input input-id search-timeout]\n  (mixins/on-key-up\n   state\n   {}\n   (editor-handler/keyup-handler state input input-id search-timeout)))\n\n(def search-timeout (atom nil))\n\n(defn- setup-key-listener!\n  [state]\n  (let [{:keys [id format]} (get-state)\n        input-id id\n        input (gdom/getElement input-id)]\n    (set-up-key-down! state format)\n    (set-up-key-up! state input input-id search-timeout)))\n\n(def starts-with? clojure.string/starts-with?)\n\n(defn get-editor-style-class\n  \"Get textarea css class according to it's content\"\n  [content format]\n  (let [content (if content (str content) \"\")]\n    ;; as the function is binding to the editor content, optimization is welcome\n    (str\n     (if (or (> (.-length content) 1000)\n             (string/includes? content \"\\n\"))\n       \"multiline-block\"\n       \"uniline-block\")\n     \" \"\n     (case format\n       :markdown\n       (cond\n         (starts-with? content \"# \") \"h1\"\n         (starts-with? content \"## \") \"h2\"\n         (starts-with? content \"### \") \"h3\"\n         (starts-with? content \"#### \") \"h4\"\n         (starts-with? content \"##### \") \"h5\"\n         (starts-with? content \"###### \") \"h6\"\n         (and (starts-with? content \"---\\n\") (.endsWith content \"\\n---\")) \"page-properties\"\n         :else \"normal-block\")\n       ;; other formats\n       (cond\n         (and (starts-with? content \"---\\n\") (.endsWith content \"\\n---\")) \"page-properties\"\n         :else \"normal-block\")))))\n\n(defn editor-row-height-unchanged?\n  \"Check if the row height of editor textarea is changed, which happens when font-size changed\"\n  []\n  ;; FIXME: assuming enter key is the only trigger of the height changing (under markdown editing of headlines)\n  ;; FIXME: looking for an elegant & robust way to track the change of font-size, or wait for our own WYSIWYG text area\n  (let [last-key (state/get-last-key-code)]\n    (and (not= keycode/enter (:key-code last-key))\n         (not= keycode/enter-code (:code last-key)))))\n\n(rum/defc mock-textarea <\n  rum/static\n  {:did-update\n   (fn [state]\n     (when-not (:editor/on-paste? @state/state)\n       (try (editor-handler/handle-last-input)\n            (catch js/Error _e\n              nil)))\n     (state/set-state! :editor/on-paste? false)\n     state)}\n  [content]\n  [:div#mock-text\n   {:style {:width \"100%\"\n            :height \"100%\"\n            :position \"absolute\"\n            :visibility \"hidden\"\n            :top 0\n            :left 0}}\n   (let [content (str content \"0\")]\n     (for [[idx c] (map-indexed\n                    vector\n                    (string/split content \"\"))]\n       (if (= c \"\\n\")\n         [:span {:id (str \"mock-text_\" idx)\n                 :key idx} \"0\" [:br]]\n         [:span {:id (str \"mock-text_\" idx)\n                 :key idx} c])))])\n\n(rum/defc mock-textarea-wrapper < rum/reactive\n  []\n  (let [content (state/sub-edit-content)]\n    (mock-textarea content)))\n\n(defn animated-modal\n  [key component set-default-width? *pos]\n  (when *pos\n    (ui/css-transition\n     {:key key\n      :class-names {:enter \"origin-top-left opacity-0 transform scale-95\"\n                    :enter-done \"origin-top-left transition opacity-100 transform scale-100\"\n                    :exit \"origin-top-left transition opacity-0 transform scale-95\"}\n      :timeout {:enter 0\n                :exit 150}}\n     (fn [_]\n       (absolute-modal\n        component\n        set-default-width?\n        *pos)))))\n\n(rum/defc modals < rum/reactive\n  \"React to atom changes, find and render the correct modal\"\n  [id format]\n  (ui/transition-group\n   (cond\n     (and (util/react *show-commands)\n          (not (state/sub :editor/show-page-search?))\n          (not (state/sub :editor/show-block-search?))\n          (not (state/sub :editor/show-template-search?))\n          (not (state/sub :editor/show-input))\n          (not (state/sub :editor/show-zotero))\n          (not (state/sub :editor/show-date-picker?)))\n     (animated-modal \"commands\" (commands id format) true (util/react *slash-caret-pos))\n\n     (and (util/react *show-block-commands) @*angle-bracket-caret-pos)\n     (animated-modal \"block-commands\" (block-commands id format) true (util/react *angle-bracket-caret-pos))\n\n     (state/sub :editor/show-page-search?)\n     (animated-modal \"page-search\" (page-search id format) true (util/react *slash-caret-pos))\n\n     (state/sub :editor/show-block-search?)\n     (animated-modal \"block-search\" (block-search id format) false (util/react *slash-caret-pos))\n\n     (state/sub :editor/show-template-search?)\n     (animated-modal \"template-search\" (template-search id format) true (util/react *slash-caret-pos))\n\n     (state/sub :editor/show-date-picker?)\n     (animated-modal \"date-picker\" (datetime-comp/date-picker id format nil) false (util/react *slash-caret-pos))\n\n     (state/sub :editor/show-input)\n     (animated-modal \"input\" (input id\n                                    (fn [command m _pos]\n                                      (editor-handler/handle-command-input command id format m)))\n                     true (util/react *slash-caret-pos))\n\n     (state/sub :editor/show-zotero)\n     (animated-modal \"zotero-search\" (zotero/zotero-search id) false (util/react *slash-caret-pos))\n\n     :else\n     nil)))\n\n(rum/defcs box < rum/reactive\n  {:init (fn [state]\n           (assoc state ::heading-level (:heading-level (first (:rum/args state)))\n                  ::id (str (random-uuid))))\n   :did-mount (fn [state]\n                (state/set-editor-args! (:rum/args state))\n                state)}\n  (mixins/event-mixin setup-key-listener!)\n  (shortcut/mixin :shortcut.handler/block-editing-only)\n  lifecycle/lifecycle\n  [state {:keys [format block]} id _config]\n  (let [content (state/sub-edit-content)\n        heading-class (get-editor-style-class content format)]\n    [:div.editor-inner {:class (if block \"block-editor\" \"non-block-editor\")}\n\n     (when (= (state/sub :editor/record-status) \"RECORDING\")\n       [:div#audio-record-toolbar\n        (footer/audio-record-cp)])\n\n     (ui/ls-textarea\n      {:id                id\n       :cacheMeasurements (editor-row-height-unchanged?) ;; check when content updated (as the content variable is binded)\n       :default-value     (or content \"\")\n       :minRows           (if (state/enable-grammarly?) 2 1)\n       :on-click          (editor-handler/editor-on-click! id)\n       :on-change         (editor-handler/editor-on-change! block id search-timeout)\n       :on-paste          (editor-handler/editor-on-paste! id)\n       :auto-focus        false\n       :class             heading-class})\n\n     (mock-textarea-wrapper)\n     (modals id format)\n\n     (when format\n       (image-uploader id format))]))\n"]}