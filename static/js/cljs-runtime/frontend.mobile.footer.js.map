{"version":3,"sources":["frontend/mobile/footer.cljs"],"mappings":";AAYA,4CAAA,AAAAA,oBAAAC,oBAAA,pFAAUG,+FAAoBC,gBAAgBC;AAA9C,AAAA,AAAA,OAAAJ,6BAAA,SAAA,eAEmB,WAAKK;AAAL,AACE,AAACC,mBAAUD;;AACX,QAACF,gDAAAA,kDAAAA;eAJtB,iBAAA,CAAA,oEAAA,AAAAF,oEAAA,AAAAA,tIAKO,kDAAA,lDAACM,6CAAEH,oDACLI,oEACA,oDAAA,2CAAA,uDAAA,2CAAA,jMAACC,+CAAQL,8MAAwBM;GAPtC,KAAA;AASA,2DAAA,3DAAMC,8HACHC;AADH,AAEE,IAAMC,UAAQ,uBAAA,vBAACC,eAAKF;IACdA,cAAQ,sBAAA,tBAACG,cAAIH;AADnB,AAEE,iEAAA,1DAACI,wHAAwBH,QAAQD;;AAErC,AAAKK,4CAAc,6CAAA,7CAACC;AACpB,yCAAA,AAAApB,oBAAAqB,qBAAA,lFAAWC,6FASRE;AATH,AAAA,AAAA,GAUM,mJAAA,nJAACf,6CAAE,mBAAA,nBAACwB;AACN,iDAAA,1CAAC7B;AAAD,AAAqB,AAAI,AAAC8B;;AACD,OAACC,sBAAOhB,0CAAc,AAACiB;GADhD;;AAXJ,OAAAlC,6BAAA,MAAA,aAAA,8BAAA,CAcK,0CAAA,1CAACE;AAAD,AAAqB,AAAI,gEAAA,hEAAC+B,sBAAOhB;;AACR,+BAAA,8FAAA,7HAACkB;;AACD,OAACC;kBAhB/B,AAAApC,6BAAA,MAAA,6DAAA,cAAA,CAAA,AAAAC,9HAcK,6DAKYmC,gGACX,AAACzB,yDAAyB,6EAAA,5EAAG,cAAA,AAAA0B,bAAG,AAACH,6BAAcjB;;GApBrD,qGAAA,2CAAA,7DAA6BI,2HACf,WAAKC;AAAL,AACE,IAAMC,OAAK,AAAA,+GAAsBD;eAAjC,XACME;AADN,AACgB,OAACC,wBAAmBF;;IAC9BG,WAAS,qBAAA,rBAACC,YAAeH;AAF/B,AAGE,2DAAA,pDAACI,8CAAMN,8GAAiBI;GAL1C,iEAMe,WAAKJ;AAAL,AACE,AAACO,cAAiB,AAAA,sIAAYP;;AAC9B,4DAAA,rDAACQ,+CAAOR;mBARzB;AAsBA,gCAAA,AAAAxB,oBAAAC,oBAAA,xEAAUuC;AAAV,AAAA,AAAA,oBAEQ,iBAAAC,oBAAK,mBAAA,nBAACR;AAAN,AAAA,oBAAAQ;AACK,OAACC;;AADND;;;AAFR,AAAA,OAAAvC,6BAAA,MAAA,aAAA,8CAAA,CAKK,AAACoB,yCACD,0CAAA,1CAAClB;AAAD,AACE,AAAI,oBAAU,AAACuC;AAAX;AAAA,AACE,2CAAA,3CAACC;;;AACH,sCAAA,mFAAA,lHAACC;GAHP,UAKA,oFAAA,pFAACzC,0CAAmB0C,mDACpB,0CAAA,1CAAC1C;AAAD,AACE,IAAM2C,OAAK,iBAAAC,mBAAI,AAACC;AAAL,AAAA,oBAAAD;AAAAA;;AACI,OAACE,0BAAkB,AAACC;;;AADnC,AAEE,0DAAA,GAAA,2CAAA,yDAAA,mEAAA,KAAA,uFAAA,zTAACC,qJAEOL;GALZ;;AAZL;;GAAA,6GAAA,1BAAmBxB","names":["rum.core/lazy-build","rum.core/build-defc","daiquiri.core/create-element","daiquiri.interpreter/interpret","frontend.mobile.footer/mobile-bar-command","command-handler","icon","e","frontend.util/stop","cljs.core._EQ_","frontend.components.svg/circle-stop","frontend.ui.icon","frontend.ui/icon-size","frontend.mobile.footer/seconds->minutes:seconds","seconds","minutes","cljs.core/quot","cljs.core/mod","frontend.util.format","frontend.mobile.footer/*record-start","cljs.core.atom","rum.core/build-defcs","frontend.mobile.footer/audio-record-cp","rum.core/reactive","state","comp","callback","rum.core/request-render","interval","js/setInterval","cljs.core.assoc","js/clearInterval","cljs.core.dissoc","frontend.state/sub","frontend.mobile.record/start-recording","cljs.core/reset!","js/Date.now","frontend.state/set-state!","frontend.mobile.record/stop-recording","cljs.core/deref","frontend.mobile.footer/footer","and__5041__auto__","frontend.state/get-current-repo","frontend.mobile.util/native-ipad?","frontend.state/set-left-sidebar-open!","frontend.state/pub-event!","frontend.state/toggle-document-mode!","page","or__5043__auto__","frontend.state/get-current-page","clojure.string/lower-case","frontend.date.journal_name","frontend.handler.editor/api-insert-new-block!"],"sourcesContent":["(ns frontend.mobile.footer\n  (:require [clojure.string :as string]\n            [frontend.components.svg :as svg]\n            [frontend.date :as date]\n            [frontend.handler.editor :as editor-handler]\n            [frontend.mobile.record :as record]\n            [frontend.mobile.util :as mobile-util]\n            [frontend.state :as state]\n            [frontend.ui :as ui]\n            [frontend.util :as util]\n            [rum.core :as rum]))\n\n(rum/defc mobile-bar-command [command-handler icon]\n  [:button.bottom-action\n   {:on-mouse-down (fn [e]\n                     (util/stop e)\n                     (command-handler))}\n   (if (= icon \"player-stop\")\n     svg/circle-stop\n     (ui/icon icon {:style {:fontSize ui/icon-size}}))])\n\n(defn seconds->minutes:seconds\n  [seconds]\n  (let [minutes (quot seconds 60)\n        seconds (mod seconds 60)]\n    (util/format \"%02d:%02d\" minutes seconds)))\n\n(def *record-start (atom nil))\n(rum/defcs audio-record-cp < rum/reactive\n  {:did-mount (fn [state]\n                (let [comp (:rum/react-component state)\n                      callback #(rum/request-render comp)\n                      interval (js/setInterval callback 1000)]\n                  (assoc state ::interval interval)))\n   :will-mount (fn [state]\n                 (js/clearInterval (::interval state))\n                 (dissoc state ::interval))}\n  [state]\n  (if (= (state/sub :editor/record-status) \"NONE\")\n    (mobile-bar-command #(do (record/start-recording)\n                             (reset! *record-start (js/Date.now))) \"microphone\")\n    [:div.flex.flex-row.items-center\n     (mobile-bar-command #(do (reset! *record-start nil)\n                              (state/set-state! :mobile/show-recording-bar? false)\n                              (record/stop-recording))\n                         \"player-stop\")\n     [:div.timer.ml-2\n      {:on-click record/stop-recording}\n      (seconds->minutes:seconds (/ (- (js/Date.now) @*record-start) 1000))]]))\n\n(rum/defc footer < rum/reactive\n  []\n  (when (and (state/sub :mobile/show-tabbar?)\n             (state/get-current-repo))\n    [:div.cp__footer.w-full.bottom-0.justify-between\n     (audio-record-cp)\n     (mobile-bar-command\n      #(do (when-not (mobile-util/native-ipad?)\n             (state/set-left-sidebar-open! false))\n           (state/pub-event! [:go/search]))\n      \"search\")\n     (mobile-bar-command state/toggle-document-mode! \"notes\")\n     (mobile-bar-command\n      #(let [page (or (state/get-current-page)\n                      (string/lower-case (date/journal-name)))]\n         (editor-handler/api-insert-new-block!\n          \"\"\n          {:page page\n           :edit-block? true\n           :replace-empty-target? true}))\n      \"edit\")]))\n"]}