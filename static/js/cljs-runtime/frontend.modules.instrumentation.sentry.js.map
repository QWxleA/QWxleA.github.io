{"version":3,"sources":["frontend/modules/instrumentation/sentry.cljs"],"mappings":"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","names":["frontend.modules.instrumentation.sentry/config","frontend.util.format","frontend.mobile.util/native-android?","frontend.mobile.util/native-ios?","frontend.version/version","frontend.config/dev?","frontend.util/electron?","frontend.mobile.util/is-native-platform?","frontend.config/publishing?","js/module$node_modules$posthog_js$dist$module.SentryIntegration","js/module$node_modules$posthog_js$dist$module","js/module$node_modules$$sentry$tracing$dist$index.BrowserTracing","event","e101837","temp__5720__auto__","vec__101838","cljs.core.nth","_","query-and-fragment","cljs.core/re-matches","seq__101841","cljs.core/seq","chunk__101842","count__101843","i__101844","cljs.core/chunked-seq?","c__4679__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","value","seq__101878","chunk__101879","count__101880","i__101881","seq__101894","chunk__101895","count__101896","i__101897","frame","cljs.core/not-empty","vec__101888","vec__101891","vec__101908","vec__101915","filename","e","js/console.error","frontend.modules.instrumentation.sentry/init","config","cljs.core/clj->js","js/module$node_modules$$sentry$react$dist$index.init"],"sourcesContent":["(ns frontend.modules.instrumentation.sentry\n  (:require [frontend.version :refer [version]]\n            [frontend.util :as util]\n            [frontend.config :as config]\n            [\"@sentry/react\" :as Sentry]\n            [\"@sentry/tracing\" :refer [BrowserTracing]]\n            [\"posthog-js\" :as posthog]\n            [frontend.mobile.util :as mobile-util]))\n\n(def config\n  {:dsn \"https://636e9174ffa148c98d2b9d3369661683@o416451.ingest.sentry.io/5311485\"\n   :release (util/format \"logseq%s@%s\" (cond\n                                         (mobile-util/native-android?) \"-android\"\n                                         (mobile-util/native-ios?) \"-ios\"\n                                         :else \"\")\n                         version)\n   :environment (if config/dev? \"development\" \"production\")\n   :initialScope {:tags\n                  {:platform (cond\n                               (util/electron?) \"electron\"\n                               (mobile-util/is-native-platform?) \"mobile\"\n                               :else \"web\")\n                   :publishing config/publishing?}}\n   :integrations [(new posthog/SentryIntegration posthog \"logseq\" 5311485)\n                  (new BrowserTracing)]\n   :debug config/dev?\n   :tracesSampleRate 1.0\n   :beforeSend (fn [^js event]\n                 (try\n                   (when-let [[_ _ query-and-fragment]\n                              (re-matches #\"file://.*?/(app/electron|static/index)\\.html(.*)\" (.. event -request -url))]\n                     (set! (.. event -request -url) (str \"http://localhost/electron.html\" query-and-fragment)))\n                   (doseq [value (.. event -exception -values)]\n                     (doseq [frame (.. value -stacktrace -frames)]\n                       (when (not-empty (.. frame -filename))\n                         (when-let [[_ filename]\n                                    (re-matches #\"file://.*?/app/(js/.*\\.js)\" (.. frame -filename))]\n                           (set! (.. frame -filename) (str \"/static/\" filename))\n                           ;; NOTE: No idea of why there's a 2-line offset.\n                           (set! (.. frame -lineno) (- (.. frame -lineno) 2))))))\n                   (catch :default e\n                     (js/console.error e)))\n                 event)})\n\n(defn init []\n  (when-not config/dev?\n    (let [config (clj->js config)]\n     (Sentry/init config))))\n"]}