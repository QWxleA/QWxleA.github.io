{"version":3,"sources":["frontend/modules/instrumentation/sentry.cljs"],"mappings":"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","names":["frontend.modules.instrumentation.sentry/config","frontend.util.format","frontend.mobile.util/native-android?","frontend.mobile.util/native-ios?","frontend.version/version","frontend.config/dev?","frontend.util/electron?","frontend.mobile.util/native-platform?","frontend.config/publishing?","js/module$node_modules$posthog_js$dist$module.SentryIntegration","js/module$node_modules$posthog_js$dist$module","js/module$node_modules$$sentry$tracing$dist$index.BrowserTracing","event","e61256","temp__5720__auto__","vec__61257","cljs.core.nth","_","query-and-fragment","cljs.core/re-matches","seq__61260","cljs.core/seq","chunk__61261","count__61262","i__61263","cljs.core/chunked-seq?","c__5565__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","value","seq__61305","chunk__61306","count__61307","i__61308","seq__61324","chunk__61325","count__61326","i__61327","frame","cljs.core/not-empty","vec__61316","vec__61320","vec__61337","vec__61340","filename","e","js/console.error","frontend.modules.instrumentation.sentry/init","config","cljs.core/clj->js","js/module$node_modules$$sentry$react$dist$index.init"],"sourcesContent":["(ns frontend.modules.instrumentation.sentry\n  (:require [frontend.version :refer [version]]\n            [frontend.util :as util]\n            [frontend.config :as config]\n            [\"@sentry/react\" :as Sentry]\n            [\"@sentry/tracing\" :refer [BrowserTracing]]\n            [\"posthog-js\" :as posthog]\n            [frontend.mobile.util :as mobile-util]))\n\n(def config\n  {:dsn \"https://636e9174ffa148c98d2b9d3369661683@o416451.ingest.sentry.io/5311485\"\n   :release (util/format \"logseq%s@%s\" (cond\n                                         (mobile-util/native-android?) \"-android\"\n                                         (mobile-util/native-ios?) \"-ios\"\n                                         :else \"\")\n                         version)\n   :environment (if config/dev? \"development\" \"production\")\n   :initialScope {:tags\n                  {:platform (cond\n                               (util/electron?) \"electron\"\n                               (mobile-util/native-platform?) \"mobile\"\n                               :else \"web\")\n                   :publishing config/publishing?}}\n   :integrations [(new posthog/SentryIntegration posthog \"logseq\" 5311485)\n                  (new BrowserTracing)]\n   :debug config/dev?\n   :tracesSampleRate 1.0\n   :beforeSend (fn [^js event]\n                 (try\n                   (when-let [[_ _ query-and-fragment]\n                              (re-matches #\"file://.*?/(app/electron|static/index)\\.html(.*)\" (.. event -request -url))]\n                     (set! (.. event -request -url) (str \"http://localhost/electron.html\" query-and-fragment)))\n                   (doseq [value (.. event -exception -values)]\n                     (doseq [frame (.. value -stacktrace -frames)]\n                       (when (not-empty (.. frame -filename))\n                         (when-let [[_ filename]\n                                    (re-matches #\"file://.*?/app/(js/.*\\.js)\" (.. frame -filename))]\n                           (set! (.. frame -filename) (str \"/static/\" filename))\n                           ;; NOTE: No idea of why there's a 2-line offset.\n                           (set! (.. frame -lineno) (- (.. frame -lineno) 2))))))\n                   (catch :default e\n                     (js/console.error e)))\n                 event)})\n\n(defn init []\n  (when-not config/dev?\n    (let [config (clj->js config)]\n     (Sentry/init config))))\n"]}