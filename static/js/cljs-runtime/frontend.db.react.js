goog.provide('frontend.db.react');
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33343#","p1__33343#",1685563827,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Symbol(null,"p1__33343#","p1__33343#",1685563827,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33343_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),p1__33343_SHARP_);
}),cljs.core.uuid_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33345#","p1__33345#",433462862,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Symbol(null,"p1__33345#","p1__33345#",433462862,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33345_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),p1__33345_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33350#","p1__33350#",-2145984042,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Symbol(null,"p1__33350#","p1__33350#",-2145984042,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33350_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),p1__33350_SHARP_);
}),cljs.core.uuid_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33351#","p1__33351#",-1248826017,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Symbol(null,"p1__33351#","p1__33351#",-1248826017,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33351_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),p1__33351_SHARP_);
}),cljs.core.uuid_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33354#","p1__33354#",-901342408,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Symbol(null,"p1__33354#","p1__33354#",-901342408,null)))),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Symbol(null,"%","%",-950237169,null)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33354_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),p1__33354_SHARP_);
})], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33356#","p1__33356#",2108467480,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Symbol(null,"p1__33356#","p1__33356#",2108467480,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33356_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),p1__33356_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33369#","p1__33369#",-849523397,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Symbol(null,"p1__33369#","p1__33369#",-849523397,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33369_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),p1__33369_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33370#","p1__33370#",320818530,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Symbol(null,"p1__33370#","p1__33370#",320818530,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33370_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),p1__33370_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33371#","p1__33371#",2066526907,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Symbol(null,"p1__33371#","p1__33371#",2066526907,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33371_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),p1__33371_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__33374#","p1__33374#",901618489,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Symbol(null,"p1__33374#","p1__33374#",901618489,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__33374_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),p1__33374_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","or","cljs.spec.alpha/or",-831679639,null),new cljs.core.Keyword(null,"block","block",664686210),new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword(null,"page-blocks","page-blocks",1869088690),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword(null,"block-and-children","block-and-children",-1704740034),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Keyword(null,"block-direct-children","block-direct-children",-339838656),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Keyword(null,"journals","journals",-1915761091),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Keyword(null,"page->pages","page->pages",-1318891992),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Keyword(null,"page<-pages","page<-pages",-1333370234),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Keyword(null,"page<-blocks-or-block<-blocks","page<-blocks-or-block<-blocks",-1655594354),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Keyword(null,"page-unlinked-refs","page-unlinked-refs",-816566385),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Keyword(null,"block<-block-ids","block<-block-ids",-1800303244),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Keyword(null,"custom","custom",340151948),new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137)),cljs.spec.alpha.or_spec_impl(new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"block","block",664686210),new cljs.core.Keyword(null,"page-blocks","page-blocks",1869088690),new cljs.core.Keyword(null,"block-and-children","block-and-children",-1704740034),new cljs.core.Keyword(null,"block-direct-children","block-direct-children",-339838656),new cljs.core.Keyword(null,"journals","journals",-1915761091),new cljs.core.Keyword(null,"page->pages","page->pages",-1318891992),new cljs.core.Keyword(null,"page<-pages","page<-pages",-1333370234),new cljs.core.Keyword(null,"page<-blocks-or-block<-blocks","page<-blocks-or-block<-blocks",-1655594354),new cljs.core.Keyword(null,"page-unlinked-refs","page-unlinked-refs",-816566385),new cljs.core.Keyword(null,"block<-block-ids","block<-block-ids",-1800303244),new cljs.core.Keyword(null,"custom","custom",340151948)], null),new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137)], null),new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137)], null),null));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","affected-keys","frontend.db.react/affected-keys",1966619951),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword("cljs.spec.alpha","kind-form","cljs.spec.alpha/kind-form",-1047104697),null,new cljs.core.Keyword("cljs.spec.alpha","cpred","cljs.spec.alpha/cpred",-693471218),(function (G__33384){
return cljs.core.coll_QMARK_(G__33384);
}),new cljs.core.Keyword("cljs.spec.alpha","conform-all","cljs.spec.alpha/conform-all",45201917),true,new cljs.core.Keyword("cljs.spec.alpha","describe","cljs.spec.alpha/describe",1883026911),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912))], null),null));
if((typeof frontend !== 'undefined') && (typeof frontend.db !== 'undefined') && (typeof frontend.db.react !== 'undefined') && (typeof frontend.db.react.query_state !== 'undefined')){
} else {
frontend.db.react.query_state = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);
}
if((typeof frontend !== 'undefined') && (typeof frontend.db !== 'undefined') && (typeof frontend.db.react !== 'undefined') && (typeof frontend.db.react.query_components !== 'undefined')){
} else {
frontend.db.react.query_components = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);
}
frontend.db.react.set_new_result_BANG_ = (function frontend$db$react$set_new_result_BANG_(k,new_result){
var temp__5720__auto__ = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,new cljs.core.Keyword(null,"result","result",1415092211)], null));
if(cljs.core.truth_(temp__5720__auto__)){
var result_atom = temp__5720__auto__;
return cljs.core.reset_BANG_(result_atom,new_result);
} else {
return null;
}
});
frontend.db.react.swap_new_result_BANG_ = (function frontend$db$react$swap_new_result_BANG_(k,f){
var temp__5720__auto__ = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,new cljs.core.Keyword(null,"result","result",1415092211)], null));
if(cljs.core.truth_(temp__5720__auto__)){
var result_atom = temp__5720__auto__;
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(result_atom,f);
} else {
return null;
}
});
frontend.db.react.kv = (function frontend$db$react$kv(key,value){
return cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword("db","id","db/id",-1388397098),(-1),new cljs.core.Keyword("db","ident","db/ident",-737096),key,key,value]);
});
frontend.db.react.remove_key_BANG_ = (function frontend$db$react$remove_key_BANG_(repo_url,key){
frontend.db.utils.transact_BANG_.cljs$core$IFn$_invoke$arity$2(repo_url,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("db.fn","retractEntity","db.fn/retractEntity",-1423535441),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("db","ident","db/ident",-737096),key], null)], null)], null));

return frontend.db.react.set_new_result_BANG_(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [repo_url,new cljs.core.Keyword(null,"kv","kv",-1099920440),key], null),null);
});
frontend.db.react.clear_query_state_BANG_ = (function frontend$db$react$clear_query_state_BANG_(){
return cljs.core.reset_BANG_(frontend.db.react.query_state,cljs.core.PersistentArrayMap.EMPTY);
});
frontend.db.react.clear_query_state_without_refs_and_embeds_BANG_ = (function frontend$db$react$clear_query_state_without_refs_and_embeds_BANG_(){
var state = cljs.core.deref(frontend.db.react.query_state);
var state__$1 = cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p__33398){
var vec__33399 = p__33398;
var vec__33402 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33399,(0),null);
var _repo = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33402,(0),null);
var k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33402,(1),null);
var _v = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33399,(1),null);
return cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"custom","custom",340151948),null,new cljs.core.Keyword("block","block","block/block",851743253),null,new cljs.core.Keyword(null,"blocks","blocks",-610462153),null], null), null),k);
}),state));
return cljs.core.reset_BANG_(frontend.db.react.query_state,state__$1);
});
frontend.db.react.add_q_BANG_ = (function frontend$db$react$add_q_BANG_(k,query,inputs,result_atom,transform_fn,query_fn,inputs_fn){
cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4(frontend.db.react.query_state,cljs.core.assoc,k,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,"query","query",-1288509510),query,new cljs.core.Keyword(null,"inputs","inputs",865803858),inputs,new cljs.core.Keyword(null,"result","result",1415092211),result_atom,new cljs.core.Keyword(null,"transform-fn","transform-fn",1106801327),transform_fn,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760),query_fn,new cljs.core.Keyword(null,"inputs-fn","inputs-fn",-1909882296),inputs_fn], null));

return result_atom;
});
frontend.db.react.remove_q_BANG_ = (function frontend$db$react$remove_q_BANG_(k){
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(frontend.db.react.query_state,cljs.core.dissoc,k);
});
frontend.db.react.add_query_component_BANG_ = (function frontend$db$react$add_query_component_BANG_(key,component){
if(cljs.core.truth_((function (){var and__5041__auto__ = key;
if(cljs.core.truth_(and__5041__auto__)){
return component;
} else {
return and__5041__auto__;
}
})())){
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4(frontend.db.react.query_components,cljs.core.assoc,component,key);
} else {
return null;
}
});
frontend.db.react.remove_query_component_BANG_ = (function frontend$db$react$remove_query_component_BANG_(component){
var temp__5720__auto___33781 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_components),component);
if(cljs.core.truth_(temp__5720__auto___33781)){
var query_33782 = temp__5720__auto___33781;
var matched_queries_33783 = cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__33411_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(query_33782,p1__33411_SHARP_);
}),cljs.core.vals(cljs.core.deref(frontend.db.react.query_components)));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((1),cljs.core.count(matched_queries_33783))){
frontend.db.react.remove_q_BANG_(query_33782);
} else {
}
} else {
}

return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(frontend.db.react.query_components,cljs.core.dissoc,component);
});
frontend.db.react.remove_custom_query_BANG_ = (function frontend$db$react$remove_custom_query_BANG_(repo,query){
return frontend.db.react.remove_q_BANG_(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [repo,new cljs.core.Keyword(null,"custom","custom",340151948),query], null));
});
frontend.db.react.query_entity_in_component = (function frontend$db$react$query_entity_in_component(var_args){
var G__33415 = arguments.length;
switch (G__33415) {
case 1:
return frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$1 = (function (id_or_lookup_ref){
return frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$2(frontend.state.get_current_repo(),id_or_lookup_ref);
}));

(frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$2 = (function (repo,id_or_lookup_ref){
var k = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"entity","entity",-450970276),id_or_lookup_ref], null);
var result_atom = new cljs.core.Keyword(null,"result","result",1415092211).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),k));
var temp__5720__auto___33786 = frontend.db.react._STAR_query_component_STAR_;
if(cljs.core.truth_(temp__5720__auto___33786)){
var component_33787 = temp__5720__auto___33786;
frontend.db.react.add_query_component_BANG_(k,component_33787);
} else {
}

var temp__5720__auto__ = frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo);
if(cljs.core.truth_(temp__5720__auto__)){
var db = temp__5720__auto__;
var result = (datascript.core.entity.cljs$core$IFn$_invoke$arity$2 ? datascript.core.entity.cljs$core$IFn$_invoke$arity$2(db,id_or_lookup_ref) : datascript.core.entity.call(null,db,id_or_lookup_ref));
var result_atom__$1 = (function (){var or__5043__auto__ = result_atom;
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
})();
(result_atom__$1.state = result);

return frontend.db.react.add_q_BANG_(k,null,null,result_atom__$1,cljs.core.identity,cljs.core.identity,cljs.core.identity);
} else {
return null;
}
}));

(frontend.db.react.query_entity_in_component.cljs$lang$maxFixedArity = 2);

frontend.db.react.get_query_cached_result = (function frontend$db$react$get_query_cached_result(k){
return new cljs.core.Keyword(null,"result","result",1415092211).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),k));
});
frontend.db.react.q = (function frontend$db$react$q(var_args){
var args__5772__auto__ = [];
var len__5766__auto___33799 = arguments.length;
var i__5767__auto___33800 = (0);
while(true){
if((i__5767__auto___33800 < len__5766__auto___33799)){
args__5772__auto__.push((arguments[i__5767__auto___33800]));

var G__33801 = (i__5767__auto___33800 + (1));
i__5767__auto___33800 = G__33801;
continue;
} else {
}
break;
}

var argseq__5773__auto__ = ((((4) < args__5772__auto__.length))?(new cljs.core.IndexedSeq(args__5772__auto__.slice((4)),(0),null)):null);
return frontend.db.react.q.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),argseq__5773__auto__);
});

(frontend.db.react.q.cljs$core$IFn$_invoke$arity$variadic = (function (repo,k,p__33453,query,inputs){
var map__33454 = p__33453;
var map__33454__$1 = cljs.core.__destructure_map(map__33454);
var use_cache_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__33454__$1,new cljs.core.Keyword(null,"use-cache?","use-cache?",-81331778),true);
var transform_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__33454__$1,new cljs.core.Keyword(null,"transform-fn","transform-fn",1106801327),cljs.core.identity);
var query_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33454__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
var inputs_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33454__$1,new cljs.core.Keyword(null,"inputs-fn","inputs-fn",-1909882296));
var disable_reactive_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33454__$1,new cljs.core.Keyword(null,"disable-reactive?","disable-reactive?",-1162731342));
if(cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),k)){
} else {
throw (new Error("Assert failed: (s/valid? :frontend.db.react/react-query-keys k)"));
}

var kv_QMARK_ = ((cljs.core.vector_QMARK_(k)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"kv","kv",-1099920440),cljs.core.first(k))));
var k__$1 = cljs.core.vec(cljs.core.cons(repo,k));
var temp__5720__auto__ = frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo);
if(cljs.core.truth_(temp__5720__auto__)){
var db = temp__5720__auto__;
var result_atom = frontend.db.react.get_query_cached_result(k__$1);
var temp__5720__auto___33805__$1 = frontend.db.react._STAR_query_component_STAR_;
if(cljs.core.truth_(temp__5720__auto___33805__$1)){
var component_33806 = temp__5720__auto___33805__$1;
frontend.db.react.add_query_component_BANG_(k__$1,component_33806);
} else {
}

if(cljs.core.truth_((function (){var and__5041__auto__ = use_cache_QMARK_;
if(cljs.core.truth_(and__5041__auto__)){
return result_atom;
} else {
return and__5041__auto__;
}
})())){
return result_atom;
} else {
var result = (cljs.core.truth_(query_fn)?(query_fn.cljs$core$IFn$_invoke$arity$3 ? query_fn.cljs$core$IFn$_invoke$arity$3(db,null,null) : query_fn.call(null,db,null,null)):(cljs.core.truth_(inputs_fn)?(function (){var inputs__$1 = (inputs_fn.cljs$core$IFn$_invoke$arity$0 ? inputs_fn.cljs$core$IFn$_invoke$arity$0() : inputs_fn.call(null));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs__$1);
})():((kv_QMARK_)?(function (){var G__33481 = db;
var G__33482 = cljs.core.last(k__$1);
return (datascript.core.entity.cljs$core$IFn$_invoke$arity$2 ? datascript.core.entity.cljs$core$IFn$_invoke$arity$2(G__33481,G__33482) : datascript.core.entity.call(null,G__33481,G__33482));
})():((cljs.core.seq(inputs))?cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs):(datascript.core.q.cljs$core$IFn$_invoke$arity$2 ? datascript.core.q.cljs$core$IFn$_invoke$arity$2(query,db) : datascript.core.q.call(null,query,db))
))));
var result__$1 = (transform_fn.cljs$core$IFn$_invoke$arity$1 ? transform_fn.cljs$core$IFn$_invoke$arity$1(result) : transform_fn.call(null,result));
var result_atom__$1 = (function (){var or__5043__auto__ = result_atom;
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
})();
(result_atom__$1.state = result__$1);

if(cljs.core.truth_(disable_reactive_QMARK_)){
return result_atom__$1;
} else {
return frontend.db.react.add_q_BANG_(k__$1,query,inputs,result_atom__$1,transform_fn,query_fn,inputs_fn);
}
}
} else {
return null;
}
}));

(frontend.db.react.q.cljs$lang$maxFixedArity = (4));

/** @this {Function} */
(frontend.db.react.q.cljs$lang$applyTo = (function (seq33435){
var G__33436 = cljs.core.first(seq33435);
var seq33435__$1 = cljs.core.next(seq33435);
var G__33437 = cljs.core.first(seq33435__$1);
var seq33435__$2 = cljs.core.next(seq33435__$1);
var G__33438 = cljs.core.first(seq33435__$2);
var seq33435__$3 = cljs.core.next(seq33435__$2);
var G__33439 = cljs.core.first(seq33435__$3);
var seq33435__$4 = cljs.core.next(seq33435__$3);
var self__5751__auto__ = this;
return self__5751__auto__.cljs$core$IFn$_invoke$arity$variadic(G__33436,G__33437,G__33438,G__33439,seq33435__$4);
}));

frontend.db.react.get_current_page = (function frontend$db$react$get_current_page(){
var match = new cljs.core.Keyword(null,"route-match","route-match",-1450985937).cljs$core$IFn$_invoke$arity$1(cljs.core.deref(frontend.state.state));
var route_name = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(match,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"data","data",-232669377),new cljs.core.Keyword(null,"name","name",1843675177)], null));
var page = (function (){var G__33510 = route_name;
var G__33510__$1 = (((G__33510 instanceof cljs.core.Keyword))?G__33510.fqn:null);
switch (G__33510__$1) {
case "page":
return cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(match,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"path-params","path-params",-48130597),new cljs.core.Keyword(null,"name","name",1843675177)], null));

break;
case "file":
return cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(match,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"path-params","path-params",-48130597),new cljs.core.Keyword(null,"path","path",-188191168)], null));

break;
default:
return frontend.date.journal_name.cljs$core$IFn$_invoke$arity$0();

}
})();
if(cljs.core.truth_(page)){
var page_name = (frontend.util.page_name_sanity_lc.cljs$core$IFn$_invoke$arity$1 ? frontend.util.page_name_sanity_lc.cljs$core$IFn$_invoke$arity$1(page) : frontend.util.page_name_sanity_lc.call(null,page));
return frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("block","name","block/name",1619760316),page_name], null));
} else {
return null;
}
});
/**
 * Get affected queries through transaction datoms.
 */
frontend.db.react.get_affected_queries_keys = (function frontend$db$react$get_affected_queries_keys(p__33521){
var map__33522 = p__33521;
var map__33522__$1 = cljs.core.__destructure_map(map__33522);
var tx_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33522__$1,new cljs.core.Keyword(null,"tx-data","tx-data",934159761));
var db_before = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33522__$1,new cljs.core.Keyword(null,"db-before","db-before",-553691536));
var _PERCENT_ = (function (){var blocks = cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"v","v",21465059),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (datom){
return cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword("block","left","block/left",-443712566),null,new cljs.core.Keyword("block","parent","block/parent",-918309064),null,new cljs.core.Keyword("block","page","block/page",822314108),null], null), null),new cljs.core.Keyword(null,"a","a",-2123407586).cljs$core$IFn$_invoke$arity$1(datom));
}),tx_data)));
var refs = cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"v","v",21465059),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (datom){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("block","refs","block/refs",-1214495349),new cljs.core.Keyword(null,"a","a",-2123407586).cljs$core$IFn$_invoke$arity$1(datom));
}),tx_data)));
var other_blocks = cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"e","e",1381269198),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (datom){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("block",cljs.core.namespace(new cljs.core.Keyword(null,"a","a",-2123407586).cljs$core$IFn$_invoke$arity$1(datom)));
}),tx_data));
var blocks__$1 = cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(blocks,other_blocks));
var affected_keys = cljs.core.concat.cljs$core$IFn$_invoke$arity$variadic(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic((function (block_id){
var block_id__$1 = (cljs.core.truth_((function (){var and__5041__auto__ = typeof block_id === 'string';
if(and__5041__auto__){
return frontend.util.uuid_string_QMARK_(block_id);
} else {
return and__5041__auto__;
}
})())?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("block","uuid","block/uuid",-1991494552),block_id], null):block_id);
var temp__5720__auto__ = frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$1(block_id__$1);
if(cljs.core.truth_(temp__5720__auto__)){
var block = temp__5720__auto__;
var page_id = (function (){var or__5043__auto__ = (cljs.core.truth_(new cljs.core.Keyword("block","name","block/name",1619760316).cljs$core$IFn$_invoke$arity$1(block))?new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(block):null);
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","page","block/page",822314108).cljs$core$IFn$_invoke$arity$1(block));
}
})();
var blocks__$2 = new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(block)], null)], null);
var others = (cljs.core.truth_(page_id)?(function (){var db_after_parent_uuid = new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","parent","block/parent",-918309064).cljs$core$IFn$_invoke$arity$1(block));
var db_before_parent_uuid = new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","parent","block/parent",-918309064).cljs$core$IFn$_invoke$arity$1((function (){var G__33529 = db_before;
var G__33530 = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("block","uuid","block/uuid",-1991494552),new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(block)], null);
return (datascript.core.entity.cljs$core$IFn$_invoke$arity$2 ? datascript.core.entity.cljs$core$IFn$_invoke$arity$2(G__33529,G__33530) : datascript.core.entity.call(null,G__33529,G__33530));
})()));
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),page_id], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),page_id], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),db_after_parent_uuid], null),(cljs.core.truth_((function (){var and__5041__auto__ = db_before_parent_uuid;
if(cljs.core.truth_(and__5041__auto__)){
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(db_before_parent_uuid,db_after_parent_uuid);
} else {
return and__5041__auto__;
}
})())?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),db_before_parent_uuid], null):null)], null);
})():null);
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(blocks__$2,others);
} else {
return null;
}
}),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([blocks__$1], 0)),(function (){var temp__5720__auto__ = new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(frontend.db.react.get_current_page());
if(cljs.core.truth_(temp__5720__auto__)){
var current_page_id = temp__5720__auto__;
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),current_page_id], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),current_page_id], null)], null);
} else {
return null;
}
})(),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (ref){
var entity = frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$1(ref);
if(cljs.core.truth_(new cljs.core.Keyword("block","name","block/name",1619760316).cljs$core$IFn$_invoke$arity$1(entity))){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),ref], null);
} else {
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","page","block/page",822314108).cljs$core$IFn$_invoke$arity$1(entity))], null);
}
}),refs)], 0));
var others = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (v){
return cljs.core.vec(cljs.core.rest(v));
}),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (ks){
return cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),null,new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),null], null), null),cljs.core.second(ks));
}),cljs.core.keys(cljs.core.deref(frontend.db.react.query_state))));
return cljs.core.set(frontend.util.concat_without_nil.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([affected_keys,others], 0)));
})();
if(cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","affected-keys","frontend.db.react/affected-keys",1966619951),_PERCENT_)){
} else {
throw (new Error("Assert failed: (s/valid? :frontend.db.react/affected-keys %)"));
}

return _PERCENT_;
});
frontend.db.react.execute_query_BANG_ = (function frontend$db$react$execute_query_BANG_(graph,db,k,tx,p__33541){
var map__33542 = p__33541;
var map__33542__$1 = cljs.core.__destructure_map(map__33542);
var query = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33542__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var inputs = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33542__$1,new cljs.core.Keyword(null,"inputs","inputs",865803858));
var transform_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33542__$1,new cljs.core.Keyword(null,"transform-fn","transform-fn",1106801327));
var query_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33542__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
var inputs_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33542__$1,new cljs.core.Keyword(null,"inputs-fn","inputs-fn",-1909882296));
var result = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33542__$1,new cljs.core.Keyword(null,"result","result",1415092211));
var new_result = (function (){var G__33543 = (cljs.core.truth_(query_fn)?(function (){var result__$1 = (query_fn.cljs$core$IFn$_invoke$arity$3 ? query_fn.cljs$core$IFn$_invoke$arity$3(db,tx,result) : query_fn.call(null,db,tx,result));
if(cljs.core.coll_QMARK_(result__$1)){
return cljs.core.doall.cljs$core$IFn$_invoke$arity$1(result__$1);
} else {
return result__$1;
}
})():(cljs.core.truth_(inputs_fn)?(function (){var inputs__$1 = (inputs_fn.cljs$core$IFn$_invoke$arity$0 ? inputs_fn.cljs$core$IFn$_invoke$arity$0() : inputs_fn.call(null));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs__$1);
})():(((query instanceof cljs.core.Keyword))?frontend.db.utils.get_key_value.cljs$core$IFn$_invoke$arity$2(graph,query):((cljs.core.seq(inputs))?cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs):(datascript.core.q.cljs$core$IFn$_invoke$arity$2 ? datascript.core.q.cljs$core$IFn$_invoke$arity$2(query,db) : datascript.core.q.call(null,query,db))
))));
return (transform_fn.cljs$core$IFn$_invoke$arity$1 ? transform_fn.cljs$core$IFn$_invoke$arity$1(G__33543) : transform_fn.call(null,G__33543));
})();
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new_result,result)){
return null;
} else {
return frontend.db.react.set_new_result_BANG_(k,new_result);
}
});
/**
 * Re-compute corresponding queries (from tx) and refresh the related react components.
 */
frontend.db.react.refresh_BANG_ = (function frontend$db$react$refresh_BANG_(repo_url,p__33549){
var map__33551 = p__33549;
var map__33551__$1 = cljs.core.__destructure_map(map__33551);
var tx = map__33551__$1;
var tx_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33551__$1,new cljs.core.Keyword(null,"tx-data","tx-data",934159761));
var tx_meta = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33551__$1,new cljs.core.Keyword(null,"tx-meta","tx-meta",1159283194));
if(cljs.core.truth_((function (){var and__5041__auto__ = repo_url;
if(cljs.core.truth_(and__5041__auto__)){
return ((cljs.core.seq(tx_data)) && (cljs.core.not(new cljs.core.Keyword(null,"skip-refresh?","skip-refresh?",878432095).cljs$core$IFn$_invoke$arity$1(tx_meta))));
} else {
return and__5041__auto__;
}
})())){
var db = frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo_url);
var affected_keys = frontend.db.react.get_affected_queries_keys(tx);
var seq__33555 = cljs.core.seq(cljs.core.deref(frontend.db.react.query_state));
var chunk__33556 = null;
var count__33557 = (0);
var i__33558 = (0);
while(true){
if((i__33558 < count__33557)){
var vec__33596 = chunk__33556.cljs$core$IIndexed$_nth$arity$2(null,i__33558);
var k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33596,(0),null);
var cache = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33596,(1),null);
var custom_QMARK__33826 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"custom","custom",340151948),cljs.core.second(k));
var kv_QMARK__33827 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"kv","kv",-1099920440),cljs.core.second(k));
if(cljs.core.truth_((function (){var and__5041__auto__ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(k),repo_url);
if(and__5041__auto__){
var or__5043__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(affected_keys,cljs.core.vec(cljs.core.rest(k)));
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return ((custom_QMARK__33826) || (kv_QMARK__33827));
}
} else {
return and__5041__auto__;
}
})())){
var map__33602_33829 = cache;
var map__33602_33830__$1 = cljs.core.__destructure_map(map__33602_33829);
var query_33831 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33602_33830__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var query_fn_33832 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33602_33830__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
if(cljs.core.truth_((function (){var or__5043__auto__ = query_33831;
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return query_fn_33832;
}
})())){
try{var f_33834 = ((function (seq__33555,chunk__33556,count__33557,i__33558,map__33602_33829,map__33602_33830__$1,query_33831,query_fn_33832,custom_QMARK__33826,kv_QMARK__33827,vec__33596,k,cache,db,affected_keys,map__33551,map__33551__$1,tx,tx_data,tx_meta){
return (function (){
return frontend.db.react.execute_query_BANG_(repo_url,db,k,tx,cache);
});})(seq__33555,chunk__33556,count__33557,i__33558,map__33602_33829,map__33602_33830__$1,query_33831,query_fn_33832,custom_QMARK__33826,kv_QMARK__33827,vec__33596,k,cache,db,affected_keys,map__33551,map__33551__$1,tx,tx_data,tx_meta))
;
if(((custom_QMARK__33826) && (((cljs.core.not(new cljs.core.Keyword(null,"cards-query?","cards-query?",1220374615).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(query_33831)))) && (cljs.core.not(frontend.state.edit_in_query_component())))))){
cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2(frontend.state.get_reactive_custom_queries_chan(),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [f_33834,query_33831], null));
} else {
f_33834();
}
}catch (e33604){if((e33604 instanceof Error)){
var e_33853 = e33604;
console.error(e_33853);
} else {
throw e33604;

}
}} else {
}
} else {
}


var G__33854 = seq__33555;
var G__33855 = chunk__33556;
var G__33856 = count__33557;
var G__33857 = (i__33558 + (1));
seq__33555 = G__33854;
chunk__33556 = G__33855;
count__33557 = G__33856;
i__33558 = G__33857;
continue;
} else {
var temp__5720__auto__ = cljs.core.seq(seq__33555);
if(temp__5720__auto__){
var seq__33555__$1 = temp__5720__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__33555__$1)){
var c__5565__auto__ = cljs.core.chunk_first(seq__33555__$1);
var G__33858 = cljs.core.chunk_rest(seq__33555__$1);
var G__33859 = c__5565__auto__;
var G__33860 = cljs.core.count(c__5565__auto__);
var G__33861 = (0);
seq__33555 = G__33858;
chunk__33556 = G__33859;
count__33557 = G__33860;
i__33558 = G__33861;
continue;
} else {
var vec__33621 = cljs.core.first(seq__33555__$1);
var k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33621,(0),null);
var cache = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__33621,(1),null);
var custom_QMARK__33864 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"custom","custom",340151948),cljs.core.second(k));
var kv_QMARK__33865 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"kv","kv",-1099920440),cljs.core.second(k));
if(cljs.core.truth_((function (){var and__5041__auto__ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(k),repo_url);
if(and__5041__auto__){
var or__5043__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(affected_keys,cljs.core.vec(cljs.core.rest(k)));
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return ((custom_QMARK__33864) || (kv_QMARK__33865));
}
} else {
return and__5041__auto__;
}
})())){
var map__33624_33868 = cache;
var map__33624_33869__$1 = cljs.core.__destructure_map(map__33624_33868);
var query_33870 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33624_33869__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var query_fn_33871 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__33624_33869__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
if(cljs.core.truth_((function (){var or__5043__auto__ = query_33870;
if(cljs.core.truth_(or__5043__auto__)){
return or__5043__auto__;
} else {
return query_fn_33871;
}
})())){
try{var f_33872 = ((function (seq__33555,chunk__33556,count__33557,i__33558,map__33624_33868,map__33624_33869__$1,query_33870,query_fn_33871,custom_QMARK__33864,kv_QMARK__33865,vec__33621,k,cache,seq__33555__$1,temp__5720__auto__,db,affected_keys,map__33551,map__33551__$1,tx,tx_data,tx_meta){
return (function (){
return frontend.db.react.execute_query_BANG_(repo_url,db,k,tx,cache);
});})(seq__33555,chunk__33556,count__33557,i__33558,map__33624_33868,map__33624_33869__$1,query_33870,query_fn_33871,custom_QMARK__33864,kv_QMARK__33865,vec__33621,k,cache,seq__33555__$1,temp__5720__auto__,db,affected_keys,map__33551,map__33551__$1,tx,tx_data,tx_meta))
;
if(((custom_QMARK__33864) && (((cljs.core.not(new cljs.core.Keyword(null,"cards-query?","cards-query?",1220374615).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(query_33870)))) && (cljs.core.not(frontend.state.edit_in_query_component())))))){
cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2(frontend.state.get_reactive_custom_queries_chan(),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [f_33872,query_33870], null));
} else {
f_33872();
}
}catch (e33627){if((e33627 instanceof Error)){
var e_33874 = e33627;
console.error(e_33874);
} else {
throw e33627;

}
}} else {
}
} else {
}


var G__33876 = cljs.core.next(seq__33555__$1);
var G__33877 = null;
var G__33878 = (0);
var G__33879 = (0);
seq__33555 = G__33876;
chunk__33556 = G__33877;
count__33557 = G__33878;
i__33558 = G__33879;
continue;
}
} else {
return null;
}
}
break;
}
} else {
return null;
}
});
frontend.db.react.set_key_value = (function frontend$db$react$set_key_value(repo_url,key,value){
if(cljs.core.truth_(value)){
return frontend.db.utils.transact_BANG_.cljs$core$IFn$_invoke$arity$2(repo_url,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [frontend.db.react.kv(key,value)], null));
} else {
return frontend.db.react.remove_key_BANG_(repo_url,key);
}
});
frontend.db.react.sub_key_value = (function frontend$db$react$sub_key_value(var_args){
var G__33639 = arguments.length;
switch (G__33639) {
case 1:
return frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$1 = (function (key){
return frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$2(frontend.state.get_current_repo(),key);
}));

(frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$2 = (function (repo_url,key){
if(cljs.core.truth_(frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo_url))){
var m = (function (){var G__33644 = frontend.db.react.q.cljs$core$IFn$_invoke$arity$variadic(repo_url,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"kv","kv",-1099920440),key], null),cljs.core.PersistentArrayMap.EMPTY,key,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([key], 0));
if((G__33644 == null)){
return null;
} else {
return frontend.util.react(G__33644);
}
})();
var temp__5718__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(m,key);
if(cljs.core.truth_(temp__5718__auto__)){
var result = temp__5718__auto__;
return result;
} else {
return m;
}
} else {
return null;
}
}));

(frontend.db.react.sub_key_value.cljs$lang$maxFixedArity = 2);

frontend.db.react.run_custom_queries_when_idle_BANG_ = (function frontend$db$react$run_custom_queries_when_idle_BANG_(){
var chan = frontend.state.get_reactive_custom_queries_chan();
var c__27595__auto___33898 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__27596__auto__ = (function (){var switch__27572__auto__ = (function (state_33683){
var state_val_33684 = (state_33683[(1)]);
if((state_val_33684 === (7))){
var inst_33652 = (state_33683[(7)]);
var inst_33653 = (state_33683[(2)]);
var inst_33654 = [cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("custom-query","failed","custom-query/failed",310909234)),"\n",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_33652)].join('');
var inst_33655 = console.error(inst_33654);
var inst_33656 = console.error(inst_33653);
var state_33683__$1 = (function (){var statearr_33685 = state_33683;
(statearr_33685[(8)] = inst_33655);

return statearr_33685;
})();
var statearr_33686_33905 = state_33683__$1;
(statearr_33686_33905[(2)] = inst_33656);

(statearr_33686_33905[(1)] = (6));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (1))){
var state_33683__$1 = state_33683;
var statearr_33687_33908 = state_33683__$1;
(statearr_33687_33908[(2)] = null);

(statearr_33687_33908[(1)] = (2));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (4))){
var inst_33650 = (state_33683[(2)]);
var inst_33651 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(inst_33650,(0),null);
var inst_33652 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(inst_33650,(1),null);
var state_33683__$1 = (function (){var statearr_33688 = state_33683;
(statearr_33688[(7)] = inst_33652);

(statearr_33688[(9)] = inst_33651);

return statearr_33688;
})();
var statearr_33689_33914 = state_33683__$1;
(statearr_33689_33914[(2)] = null);

(statearr_33689_33914[(1)] = (5));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (6))){
var inst_33678 = (state_33683[(2)]);
var state_33683__$1 = (function (){var statearr_33690 = state_33683;
(statearr_33690[(10)] = inst_33678);

return statearr_33690;
})();
var statearr_33691_33919 = state_33683__$1;
(statearr_33691_33919[(2)] = null);

(statearr_33691_33919[(1)] = (2));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (3))){
var inst_33681 = (state_33683[(2)]);
var state_33683__$1 = state_33683;
return cljs.core.async.impl.ioc_helpers.return_chan(state_33683__$1,inst_33681);
} else {
if((state_val_33684 === (12))){
var inst_33652 = (state_33683[(7)]);
var inst_33651 = (state_33683[(9)]);
var inst_33669 = (state_33683[(2)]);
var inst_33670 = cljs.core.PersistentVector.EMPTY_NODE;
var inst_33671 = [inst_33651,inst_33652];
var inst_33672 = (new cljs.core.PersistentVector(null,2,(5),inst_33670,inst_33671,null));
var inst_33673 = cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2(chan,inst_33672);
var state_33683__$1 = (function (){var statearr_33694 = state_33683;
(statearr_33694[(11)] = inst_33669);

return statearr_33694;
})();
var statearr_33695_33931 = state_33683__$1;
(statearr_33695_33931[(2)] = inst_33673);

(statearr_33695_33931[(1)] = (11));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (2))){
var state_33683__$1 = state_33683;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_33683__$1,(4),chan);
} else {
if((state_val_33684 === (11))){
var inst_33675 = (state_33683[(2)]);
var _ = (function (){var statearr_33698 = state_33683;
(statearr_33698[(4)] = cljs.core.rest((state_33683[(4)])));

return statearr_33698;
})();
var state_33683__$1 = state_33683;
var statearr_33699_33933 = state_33683__$1;
(statearr_33699_33933[(2)] = inst_33675);

(statearr_33699_33933[(1)] = (6));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (9))){
var inst_33651 = (state_33683[(9)]);
var inst_33665 = (inst_33651.cljs$core$IFn$_invoke$arity$0 ? inst_33651.cljs$core$IFn$_invoke$arity$0() : inst_33651.call(null));
var state_33683__$1 = state_33683;
var statearr_33700_33935 = state_33683__$1;
(statearr_33700_33935[(2)] = inst_33665);

(statearr_33700_33935[(1)] = (11));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (5))){
var _ = (function (){var statearr_33706 = state_33683;
(statearr_33706[(4)] = cljs.core.cons((8),(state_33683[(4)])));

return statearr_33706;
})();
var inst_33662 = frontend.state.get_current_repo();
var inst_33663 = frontend.state.input_idle_QMARK_(inst_33662);
var state_33683__$1 = state_33683;
if(cljs.core.truth_(inst_33663)){
var statearr_33707_33938 = state_33683__$1;
(statearr_33707_33938[(1)] = (9));

} else {
var statearr_33708_33941 = state_33683__$1;
(statearr_33708_33941[(1)] = (10));

}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_33684 === (10))){
var inst_33667 = cljs.core.async.timeout((2000));
var state_33683__$1 = state_33683;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_33683__$1,(12),inst_33667);
} else {
if((state_val_33684 === (8))){
var _ = (function (){var statearr_33709 = state_33683;
(statearr_33709[(4)] = cljs.core.rest((state_33683[(4)])));

return statearr_33709;
})();
var state_33683__$1 = state_33683;
var ex33705 = (state_33683__$1[(2)]);
var statearr_33710_33944 = state_33683__$1;
(statearr_33710_33944[(5)] = ex33705);


if((ex33705 instanceof Error)){
var statearr_33713_33948 = state_33683__$1;
(statearr_33713_33948[(1)] = (7));

(statearr_33713_33948[(5)] = null);

} else {
throw ex33705;

}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
return null;
}
}
}
}
}
}
}
}
}
}
}
}
});
return (function() {
var frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto__ = null;
var frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto____0 = (function (){
var statearr_33720 = [null,null,null,null,null,null,null,null,null,null,null,null];
(statearr_33720[(0)] = frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto__);

(statearr_33720[(1)] = (1));

return statearr_33720;
});
var frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto____1 = (function (state_33683){
while(true){
var ret_value__27574__auto__ = (function (){try{while(true){
var result__27575__auto__ = switch__27572__auto__(state_33683);
if(cljs.core.keyword_identical_QMARK_(result__27575__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__27575__auto__;
}
break;
}
}catch (e33721){var ex__27576__auto__ = e33721;
var statearr_33722_33964 = state_33683;
(statearr_33722_33964[(2)] = ex__27576__auto__);


if(cljs.core.seq((state_33683[(4)]))){
var statearr_33723_33967 = state_33683;
(statearr_33723_33967[(1)] = cljs.core.first((state_33683[(4)])));

} else {
throw ex__27576__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__27574__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__33969 = state_33683;
state_33683 = G__33969;
continue;
} else {
return ret_value__27574__auto__;
}
break;
}
});
frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto__ = function(state_33683){
switch(arguments.length){
case 0:
return frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto____0.call(this);
case 1:
return frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto____1.call(this,state_33683);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto__.cljs$core$IFn$_invoke$arity$0 = frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto____0;
frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto__.cljs$core$IFn$_invoke$arity$1 = frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto____1;
return frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__27573__auto__;
})()
})();
var state__27597__auto__ = (function (){var statearr_33724 = f__27596__auto__();
(statearr_33724[(6)] = c__27595__auto___33898);

return statearr_33724;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__27597__auto__);
}));


return chan;
});

//# sourceMappingURL=frontend.db.react.js.map
