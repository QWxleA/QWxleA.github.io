goog.provide('frontend.db.react');
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47847#","p1__47847#",691054323,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Symbol(null,"p1__47847#","p1__47847#",691054323,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47847_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),p1__47847_SHARP_);
}),cljs.core.uuid_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47861#","p1__47861#",-731680566,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Symbol(null,"p1__47861#","p1__47861#",-731680566,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47861_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),p1__47861_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47869#","p1__47869#",-1951510657,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Symbol(null,"p1__47869#","p1__47869#",-1951510657,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47869_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),p1__47869_SHARP_);
}),cljs.core.uuid_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47877#","p1__47877#",-763894094,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Symbol(null,"p1__47877#","p1__47877#",-763894094,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","uuid?","cljs.core/uuid?",-15131116,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47877_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),p1__47877_SHARP_);
}),cljs.core.uuid_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47883#","p1__47883#",476046290,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Symbol(null,"p1__47883#","p1__47883#",476046290,null)))),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Symbol(null,"%","%",-950237169,null)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47883_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),p1__47883_SHARP_);
})], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47884#","p1__47884#",-1484701472,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Symbol(null,"p1__47884#","p1__47884#",-1484701472,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47884_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),p1__47884_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47891#","p1__47891#",1227665245,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Symbol(null,"p1__47891#","p1__47891#",1227665245,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47891_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),p1__47891_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47895#","p1__47895#",372025057,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Symbol(null,"p1__47895#","p1__47895#",372025057,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47895_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),p1__47895_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47899#","p1__47899#",-593293642,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Symbol(null,"p1__47899#","p1__47899#",-593293642,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47899_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),p1__47899_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","tuple","cljs.spec.alpha/tuple",-415901908,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"p1__47906#","p1__47906#",-2081797420,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Symbol(null,"p1__47906#","p1__47906#",-2081797420,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","=","cljs.core/=",-1891498332,null),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Symbol(null,"%","%",-950237169,null))),new cljs.core.Symbol("cljs.core","int?","cljs.core/int?",50730120,null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (p1__47906_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),p1__47906_SHARP_);
}),cljs.core.int_QMARK_], null)));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137),new cljs.core.Symbol("cljs.core","any?","cljs.core/any?",-2068111842,null),cljs.core.any_QMARK_);
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","or","cljs.spec.alpha/or",-831679639,null),new cljs.core.Keyword(null,"block","block",664686210),new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword(null,"page-blocks","page-blocks",1869088690),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword(null,"block-and-children","block-and-children",-1704740034),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Keyword(null,"block-direct-children","block-direct-children",-339838656),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Keyword(null,"journals","journals",-1915761091),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Keyword(null,"page->pages","page->pages",-1318891992),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Keyword(null,"page<-pages","page<-pages",-1333370234),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Keyword(null,"page<-blocks-or-block<-blocks","page<-blocks-or-block<-blocks",-1655594354),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Keyword(null,"page-unlinked-refs","page-unlinked-refs",-816566385),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Keyword(null,"block<-block-ids","block<-block-ids",-1800303244),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Keyword(null,"custom","custom",340151948),new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137)),cljs.spec.alpha.or_spec_impl(new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"block","block",664686210),new cljs.core.Keyword(null,"page-blocks","page-blocks",1869088690),new cljs.core.Keyword(null,"block-and-children","block-and-children",-1704740034),new cljs.core.Keyword(null,"block-direct-children","block-direct-children",-339838656),new cljs.core.Keyword(null,"journals","journals",-1915761091),new cljs.core.Keyword(null,"page->pages","page->pages",-1318891992),new cljs.core.Keyword(null,"page<-pages","page<-pages",-1333370234),new cljs.core.Keyword(null,"page<-blocks-or-block<-blocks","page<-blocks-or-block<-blocks",-1655594354),new cljs.core.Keyword(null,"page-unlinked-refs","page-unlinked-refs",-816566385),new cljs.core.Keyword(null,"block<-block-ids","block<-block-ids",-1800303244),new cljs.core.Keyword(null,"custom","custom",340151948)], null),new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137)], null),new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),new cljs.core.Keyword("frontend.db.react","journals","frontend.db.react/journals",-1864001064),new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),new cljs.core.Keyword("frontend.db.react","page-unlinked-refs","frontend.db.react/page-unlinked-refs",2088680220),new cljs.core.Keyword("frontend.db.react","block<-block-ids","frontend.db.react/block<-block-ids",562274831),new cljs.core.Keyword("frontend.db.react","custom","frontend.db.react/custom",-544456137)], null),null));
cljs.spec.alpha.def_impl(new cljs.core.Keyword("frontend.db.react","affected-keys","frontend.db.react/affected-keys",1966619951),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword("cljs.spec.alpha","kind-form","cljs.spec.alpha/kind-form",-1047104697),null,new cljs.core.Keyword("cljs.spec.alpha","cpred","cljs.spec.alpha/cpred",-693471218),(function (G__47920){
return cljs.core.coll_QMARK_(G__47920);
}),new cljs.core.Keyword("cljs.spec.alpha","conform-all","cljs.spec.alpha/conform-all",45201917),true,new cljs.core.Keyword("cljs.spec.alpha","describe","cljs.spec.alpha/describe",1883026911),cljs.core.list(new cljs.core.Symbol("cljs.spec.alpha","coll-of","cljs.spec.alpha/coll-of",1019430407,null),new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912))], null),null));
if((typeof frontend !== 'undefined') && (typeof frontend.db !== 'undefined') && (typeof frontend.db.react !== 'undefined') && (typeof frontend.db.react.query_state !== 'undefined')){
} else {
frontend.db.react.query_state = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);
}
if((typeof frontend !== 'undefined') && (typeof frontend.db !== 'undefined') && (typeof frontend.db.react !== 'undefined') && (typeof frontend.db.react.query_components !== 'undefined')){
} else {
frontend.db.react.query_components = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);
}
frontend.db.react.set_new_result_BANG_ = (function frontend$db$react$set_new_result_BANG_(k,new_result){
var temp__5720__auto__ = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,new cljs.core.Keyword(null,"result","result",1415092211)], null));
if(cljs.core.truth_(temp__5720__auto__)){
var result_atom = temp__5720__auto__;
return cljs.core.reset_BANG_(result_atom,new_result);
} else {
return null;
}
});
frontend.db.react.swap_new_result_BANG_ = (function frontend$db$react$swap_new_result_BANG_(k,f){
var temp__5720__auto__ = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,new cljs.core.Keyword(null,"result","result",1415092211)], null));
if(cljs.core.truth_(temp__5720__auto__)){
var result_atom = temp__5720__auto__;
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(result_atom,f);
} else {
return null;
}
});
frontend.db.react.kv = (function frontend$db$react$kv(key,value){
return cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword("db","id","db/id",-1388397098),(-1),new cljs.core.Keyword("db","ident","db/ident",-737096),key,key,value]);
});
frontend.db.react.remove_key_BANG_ = (function frontend$db$react$remove_key_BANG_(repo_url,key){
frontend.db.utils.transact_BANG_.cljs$core$IFn$_invoke$arity$2(repo_url,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("db.fn","retractEntity","db.fn/retractEntity",-1423535441),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("db","ident","db/ident",-737096),key], null)], null)], null));

return frontend.db.react.set_new_result_BANG_(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [repo_url,new cljs.core.Keyword(null,"kv","kv",-1099920440),key], null),null);
});
frontend.db.react.clear_query_state_BANG_ = (function frontend$db$react$clear_query_state_BANG_(){
return cljs.core.reset_BANG_(frontend.db.react.query_state,cljs.core.PersistentArrayMap.EMPTY);
});
frontend.db.react.clear_query_state_without_refs_and_embeds_BANG_ = (function frontend$db$react$clear_query_state_without_refs_and_embeds_BANG_(){
var state = cljs.core.deref(frontend.db.react.query_state);
var state__$1 = cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p__47941){
var vec__47944 = p__47941;
var vec__47947 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__47944,(0),null);
var _repo = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__47947,(0),null);
var k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__47947,(1),null);
var _v = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__47944,(1),null);
return cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"custom","custom",340151948),null,new cljs.core.Keyword("block","block","block/block",851743253),null,new cljs.core.Keyword(null,"blocks","blocks",-610462153),null], null), null),k);
}),state));
return cljs.core.reset_BANG_(frontend.db.react.query_state,state__$1);
});
frontend.db.react.add_q_BANG_ = (function frontend$db$react$add_q_BANG_(k,query,inputs,result_atom,transform_fn,query_fn,inputs_fn){
cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4(frontend.db.react.query_state,cljs.core.assoc,k,new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,"query","query",-1288509510),query,new cljs.core.Keyword(null,"inputs","inputs",865803858),inputs,new cljs.core.Keyword(null,"result","result",1415092211),result_atom,new cljs.core.Keyword(null,"transform-fn","transform-fn",1106801327),transform_fn,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760),query_fn,new cljs.core.Keyword(null,"inputs-fn","inputs-fn",-1909882296),inputs_fn], null));

return result_atom;
});
frontend.db.react.remove_q_BANG_ = (function frontend$db$react$remove_q_BANG_(k){
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(frontend.db.react.query_state,cljs.core.dissoc,k);
});
frontend.db.react.add_query_component_BANG_ = (function frontend$db$react$add_query_component_BANG_(key,component){
if(cljs.core.truth_((function (){var and__4251__auto__ = key;
if(cljs.core.truth_(and__4251__auto__)){
return component;
} else {
return and__4251__auto__;
}
})())){
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4(frontend.db.react.query_components,cljs.core.assoc,component,key);
} else {
return null;
}
});
frontend.db.react.remove_query_component_BANG_ = (function frontend$db$react$remove_query_component_BANG_(component){
var temp__5720__auto___48267 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_components),component);
if(cljs.core.truth_(temp__5720__auto___48267)){
var query_48268 = temp__5720__auto___48267;
var matched_queries_48269 = cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__47953_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(query_48268,p1__47953_SHARP_);
}),cljs.core.vals(cljs.core.deref(frontend.db.react.query_components)));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2((1),cljs.core.count(matched_queries_48269))){
frontend.db.react.remove_q_BANG_(query_48268);
} else {
}
} else {
}

return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3(frontend.db.react.query_components,cljs.core.dissoc,component);
});
frontend.db.react.remove_custom_query_BANG_ = (function frontend$db$react$remove_custom_query_BANG_(repo,query){
return frontend.db.react.remove_q_BANG_(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [repo,new cljs.core.Keyword(null,"custom","custom",340151948),query], null));
});
frontend.db.react.query_entity_in_component = (function frontend$db$react$query_entity_in_component(var_args){
var G__47965 = arguments.length;
switch (G__47965) {
case 1:
return frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$1 = (function (id_or_lookup_ref){
return frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$2(frontend.state.get_current_repo(),id_or_lookup_ref);
}));

(frontend.db.react.query_entity_in_component.cljs$core$IFn$_invoke$arity$2 = (function (repo,id_or_lookup_ref){
var k = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"entity","entity",-450970276),id_or_lookup_ref], null);
var result_atom = new cljs.core.Keyword(null,"result","result",1415092211).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),k));
var temp__5720__auto___48278 = frontend.db.react._STAR_query_component_STAR_;
if(cljs.core.truth_(temp__5720__auto___48278)){
var component_48279 = temp__5720__auto___48278;
frontend.db.react.add_query_component_BANG_(k,component_48279);
} else {
}

var temp__5720__auto__ = frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo);
if(cljs.core.truth_(temp__5720__auto__)){
var db = temp__5720__auto__;
var result = (datascript.core.entity.cljs$core$IFn$_invoke$arity$2 ? datascript.core.entity.cljs$core$IFn$_invoke$arity$2(db,id_or_lookup_ref) : datascript.core.entity.call(null,db,id_or_lookup_ref));
var result_atom__$1 = (function (){var or__4253__auto__ = result_atom;
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
})();
(result_atom__$1.state = result);

return frontend.db.react.add_q_BANG_(k,null,null,result_atom__$1,cljs.core.identity,cljs.core.identity,cljs.core.identity);
} else {
return null;
}
}));

(frontend.db.react.query_entity_in_component.cljs$lang$maxFixedArity = 2);

frontend.db.react.get_query_cached_result = (function frontend$db$react$get_query_cached_result(k){
return new cljs.core.Keyword(null,"result","result",1415092211).cljs$core$IFn$_invoke$arity$1(cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(frontend.db.react.query_state),k));
});
frontend.db.react.q = (function frontend$db$react$q(var_args){
var args__4870__auto__ = [];
var len__4864__auto___48280 = arguments.length;
var i__4865__auto___48281 = (0);
while(true){
if((i__4865__auto___48281 < len__4864__auto___48280)){
args__4870__auto__.push((arguments[i__4865__auto___48281]));

var G__48282 = (i__4865__auto___48281 + (1));
i__4865__auto___48281 = G__48282;
continue;
} else {
}
break;
}

var argseq__4871__auto__ = ((((4) < args__4870__auto__.length))?(new cljs.core.IndexedSeq(args__4870__auto__.slice((4)),(0),null)):null);
return frontend.db.react.q.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),(arguments[(2)]),(arguments[(3)]),argseq__4871__auto__);
});

(frontend.db.react.q.cljs$core$IFn$_invoke$arity$variadic = (function (repo,k,p__47983,query,inputs){
var map__47984 = p__47983;
var map__47984__$1 = cljs.core.__destructure_map(map__47984);
var use_cache_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__47984__$1,new cljs.core.Keyword(null,"use-cache?","use-cache?",-81331778),true);
var transform_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$3(map__47984__$1,new cljs.core.Keyword(null,"transform-fn","transform-fn",1106801327),cljs.core.identity);
var query_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__47984__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
var inputs_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__47984__$1,new cljs.core.Keyword(null,"inputs-fn","inputs-fn",-1909882296));
var disable_reactive_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__47984__$1,new cljs.core.Keyword(null,"disable-reactive?","disable-reactive?",-1162731342));
if(cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","react-query-keys","frontend.db.react/react-query-keys",1617725912),k)){
} else {
throw (new Error("Assert failed: (s/valid? :frontend.db.react/react-query-keys k)"));
}

var kv_QMARK_ = ((cljs.core.vector_QMARK_(k)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"kv","kv",-1099920440),cljs.core.first(k))));
var k__$1 = cljs.core.vec(cljs.core.cons(repo,k));
var temp__5720__auto__ = frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo);
if(cljs.core.truth_(temp__5720__auto__)){
var db = temp__5720__auto__;
var result_atom = frontend.db.react.get_query_cached_result(k__$1);
var temp__5720__auto___48288__$1 = frontend.db.react._STAR_query_component_STAR_;
if(cljs.core.truth_(temp__5720__auto___48288__$1)){
var component_48289 = temp__5720__auto___48288__$1;
frontend.db.react.add_query_component_BANG_(k__$1,component_48289);
} else {
}

if(cljs.core.truth_((function (){var and__4251__auto__ = use_cache_QMARK_;
if(cljs.core.truth_(and__4251__auto__)){
return result_atom;
} else {
return and__4251__auto__;
}
})())){
return result_atom;
} else {
var result = (cljs.core.truth_(query_fn)?(query_fn.cljs$core$IFn$_invoke$arity$3 ? query_fn.cljs$core$IFn$_invoke$arity$3(db,null,null) : query_fn.call(null,db,null,null)):(cljs.core.truth_(inputs_fn)?(function (){var inputs__$1 = (inputs_fn.cljs$core$IFn$_invoke$arity$0 ? inputs_fn.cljs$core$IFn$_invoke$arity$0() : inputs_fn.call(null));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs__$1);
})():((kv_QMARK_)?(function (){var G__47985 = db;
var G__47986 = cljs.core.last(k__$1);
return (datascript.core.entity.cljs$core$IFn$_invoke$arity$2 ? datascript.core.entity.cljs$core$IFn$_invoke$arity$2(G__47985,G__47986) : datascript.core.entity.call(null,G__47985,G__47986));
})():((cljs.core.seq(inputs))?cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs):(datascript.core.q.cljs$core$IFn$_invoke$arity$2 ? datascript.core.q.cljs$core$IFn$_invoke$arity$2(query,db) : datascript.core.q.call(null,query,db))
))));
var result__$1 = (transform_fn.cljs$core$IFn$_invoke$arity$1 ? transform_fn.cljs$core$IFn$_invoke$arity$1(result) : transform_fn.call(null,result));
var result_atom__$1 = (function (){var or__4253__auto__ = result_atom;
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
})();
(result_atom__$1.state = result__$1);

if(cljs.core.truth_(disable_reactive_QMARK_)){
return result_atom__$1;
} else {
return frontend.db.react.add_q_BANG_(k__$1,query,inputs,result_atom__$1,transform_fn,query_fn,inputs_fn);
}
}
} else {
return null;
}
}));

(frontend.db.react.q.cljs$lang$maxFixedArity = (4));

/** @this {Function} */
(frontend.db.react.q.cljs$lang$applyTo = (function (seq47978){
var G__47979 = cljs.core.first(seq47978);
var seq47978__$1 = cljs.core.next(seq47978);
var G__47980 = cljs.core.first(seq47978__$1);
var seq47978__$2 = cljs.core.next(seq47978__$1);
var G__47981 = cljs.core.first(seq47978__$2);
var seq47978__$3 = cljs.core.next(seq47978__$2);
var G__47982 = cljs.core.first(seq47978__$3);
var seq47978__$4 = cljs.core.next(seq47978__$3);
var self__4851__auto__ = this;
return self__4851__auto__.cljs$core$IFn$_invoke$arity$variadic(G__47979,G__47980,G__47981,G__47982,seq47978__$4);
}));

frontend.db.react.get_current_page = (function frontend$db$react$get_current_page(){
var match = new cljs.core.Keyword(null,"route-match","route-match",-1450985937).cljs$core$IFn$_invoke$arity$1(cljs.core.deref(frontend.state.state));
var route_name = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(match,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"data","data",-232669377),new cljs.core.Keyword(null,"name","name",1843675177)], null));
var page = (function (){var G__47989 = route_name;
var G__47989__$1 = (((G__47989 instanceof cljs.core.Keyword))?G__47989.fqn:null);
switch (G__47989__$1) {
case "page":
return cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(match,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"path-params","path-params",-48130597),new cljs.core.Keyword(null,"name","name",1843675177)], null));

break;
case "file":
return cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(match,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"path-params","path-params",-48130597),new cljs.core.Keyword(null,"path","path",-188191168)], null));

break;
default:
return frontend.date.journal_name.cljs$core$IFn$_invoke$arity$0();

}
})();
if(cljs.core.truth_(page)){
var page_name = (frontend.util.page_name_sanity_lc.cljs$core$IFn$_invoke$arity$1 ? frontend.util.page_name_sanity_lc.cljs$core$IFn$_invoke$arity$1(page) : frontend.util.page_name_sanity_lc.call(null,page));
return frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("block","name","block/name",1619760316),page_name], null));
} else {
return null;
}
});
/**
 * Get affected queries through transaction datoms.
 */
frontend.db.react.get_affected_queries_keys = (function frontend$db$react$get_affected_queries_keys(p__47996){
var map__47997 = p__47996;
var map__47997__$1 = cljs.core.__destructure_map(map__47997);
var tx_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__47997__$1,new cljs.core.Keyword(null,"tx-data","tx-data",934159761));
var db_before = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__47997__$1,new cljs.core.Keyword(null,"db-before","db-before",-553691536));
var _PERCENT_ = (function (){var blocks = cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"v","v",21465059),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (datom){
return cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword("block","left","block/left",-443712566),null,new cljs.core.Keyword("block","parent","block/parent",-918309064),null,new cljs.core.Keyword("block","page","block/page",822314108),null], null), null),new cljs.core.Keyword(null,"a","a",-2123407586).cljs$core$IFn$_invoke$arity$1(datom));
}),tx_data)));
var refs = cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"v","v",21465059),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (datom){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("block","refs","block/refs",-1214495349),new cljs.core.Keyword(null,"a","a",-2123407586).cljs$core$IFn$_invoke$arity$1(datom));
}),tx_data)));
var other_blocks = cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"e","e",1381269198),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (datom){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("block",cljs.core.namespace(new cljs.core.Keyword(null,"a","a",-2123407586).cljs$core$IFn$_invoke$arity$1(datom)));
}),tx_data));
var blocks__$1 = cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.concat.cljs$core$IFn$_invoke$arity$2(blocks,other_blocks));
var affected_keys = cljs.core.concat.cljs$core$IFn$_invoke$arity$variadic(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic((function (block_id){
var block_id__$1 = (cljs.core.truth_((function (){var and__4251__auto__ = typeof block_id === 'string';
if(and__4251__auto__){
return frontend.util.uuid_string_QMARK_(block_id);
} else {
return and__4251__auto__;
}
})())?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("block","uuid","block/uuid",-1991494552),block_id], null):block_id);
var temp__5720__auto__ = frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$1(block_id__$1);
if(cljs.core.truth_(temp__5720__auto__)){
var block = temp__5720__auto__;
var page_id = (function (){var or__4253__auto__ = (cljs.core.truth_(new cljs.core.Keyword("block","name","block/name",1619760316).cljs$core$IFn$_invoke$arity$1(block))?new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(block):null);
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","page","block/page",822314108).cljs$core$IFn$_invoke$arity$1(block));
}
})();
var blocks__$2 = new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block","frontend.db.react/block",1552179739),new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(block)], null)], null);
var others = (cljs.core.truth_(page_id)?(function (){var db_after_parent_uuid = new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","parent","block/parent",-918309064).cljs$core$IFn$_invoke$arity$1(block));
var db_before_parent_uuid = new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","parent","block/parent",-918309064).cljs$core$IFn$_invoke$arity$1((function (){var G__48006 = db_before;
var G__48007 = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("block","uuid","block/uuid",-1991494552),new cljs.core.Keyword("block","uuid","block/uuid",-1991494552).cljs$core$IFn$_invoke$arity$1(block)], null);
return (datascript.core.entity.cljs$core$IFn$_invoke$arity$2 ? datascript.core.entity.cljs$core$IFn$_invoke$arity$2(G__48006,G__48007) : datascript.core.entity.call(null,G__48006,G__48007));
})()));
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),page_id], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),page_id], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),db_after_parent_uuid], null),(cljs.core.truth_((function (){var and__4251__auto__ = db_before_parent_uuid;
if(cljs.core.truth_(and__4251__auto__)){
return cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(db_before_parent_uuid,db_after_parent_uuid);
} else {
return and__4251__auto__;
}
})())?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","block-direct-children","frontend.db.react/block-direct-children",94659787),db_before_parent_uuid], null):null)], null);
})():null);
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(blocks__$2,others);
} else {
return null;
}
}),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([blocks__$1], 0)),(function (){var temp__5720__auto__ = new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(frontend.db.react.get_current_page());
if(cljs.core.truth_(temp__5720__auto__)){
var current_page_id = temp__5720__auto__;
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page->pages","frontend.db.react/page->pages",-1398203725),current_page_id], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page<-pages","frontend.db.react/page<-pages",-577219055),current_page_id], null)], null);
} else {
return null;
}
})(),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (ref){
var entity = frontend.db.utils.entity.cljs$core$IFn$_invoke$arity$1(ref);
if(cljs.core.truth_(new cljs.core.Keyword("block","name","block/name",1619760316).cljs$core$IFn$_invoke$arity$1(entity))){
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),ref], null);
} else {
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("frontend.db.react","page-blocks","frontend.db.react/page-blocks",1515328263),new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("block","page","block/page",822314108).cljs$core$IFn$_invoke$arity$1(entity))], null);
}
}),refs)], 0));
var others = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (v){
return cljs.core.vec(cljs.core.rest(v));
}),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (ks){
return cljs.core.contains_QMARK_(new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("frontend.db.react","page<-blocks-or-block<-blocks","frontend.db.react/page<-blocks-or-block<-blocks",-1997031897),null,new cljs.core.Keyword("frontend.db.react","block-and-children","frontend.db.react/block-and-children",-1481509175),null], null), null),cljs.core.second(ks));
}),cljs.core.keys(cljs.core.deref(frontend.db.react.query_state))));
return cljs.core.set(frontend.util.concat_without_nil.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([affected_keys,others], 0)));
})();
if(cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("frontend.db.react","affected-keys","frontend.db.react/affected-keys",1966619951),_PERCENT_)){
} else {
throw (new Error("Assert failed: (s/valid? :frontend.db.react/affected-keys %)"));
}

return _PERCENT_;
});
frontend.db.react.execute_query_BANG_ = (function frontend$db$react$execute_query_BANG_(graph,db,k,tx,p__48016){
var map__48017 = p__48016;
var map__48017__$1 = cljs.core.__destructure_map(map__48017);
var query = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48017__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var inputs = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48017__$1,new cljs.core.Keyword(null,"inputs","inputs",865803858));
var transform_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48017__$1,new cljs.core.Keyword(null,"transform-fn","transform-fn",1106801327));
var query_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48017__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
var inputs_fn = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48017__$1,new cljs.core.Keyword(null,"inputs-fn","inputs-fn",-1909882296));
var result = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48017__$1,new cljs.core.Keyword(null,"result","result",1415092211));
var new_result = (function (){var G__48018 = (cljs.core.truth_(query_fn)?(function (){var result__$1 = (query_fn.cljs$core$IFn$_invoke$arity$3 ? query_fn.cljs$core$IFn$_invoke$arity$3(db,tx,result) : query_fn.call(null,db,tx,result));
if(cljs.core.coll_QMARK_(result__$1)){
return cljs.core.doall.cljs$core$IFn$_invoke$arity$1(result__$1);
} else {
return result__$1;
}
})():(cljs.core.truth_(inputs_fn)?(function (){var inputs__$1 = (inputs_fn.cljs$core$IFn$_invoke$arity$0 ? inputs_fn.cljs$core$IFn$_invoke$arity$0() : inputs_fn.call(null));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs__$1);
})():(((query instanceof cljs.core.Keyword))?frontend.db.utils.get_key_value.cljs$core$IFn$_invoke$arity$2(graph,query):((cljs.core.seq(inputs))?cljs.core.apply.cljs$core$IFn$_invoke$arity$4(datascript.core.q,query,db,inputs):(datascript.core.q.cljs$core$IFn$_invoke$arity$2 ? datascript.core.q.cljs$core$IFn$_invoke$arity$2(query,db) : datascript.core.q.call(null,query,db))
))));
return (transform_fn.cljs$core$IFn$_invoke$arity$1 ? transform_fn.cljs$core$IFn$_invoke$arity$1(G__48018) : transform_fn.call(null,G__48018));
})();
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new_result,result)){
return null;
} else {
return frontend.db.react.set_new_result_BANG_(k,new_result);
}
});
/**
 * Re-compute corresponding queries (from tx) and refresh the related react components.
 */
frontend.db.react.refresh_BANG_ = (function frontend$db$react$refresh_BANG_(repo_url,p__48025){
var map__48026 = p__48025;
var map__48026__$1 = cljs.core.__destructure_map(map__48026);
var tx = map__48026__$1;
var tx_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48026__$1,new cljs.core.Keyword(null,"tx-data","tx-data",934159761));
var tx_meta = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48026__$1,new cljs.core.Keyword(null,"tx-meta","tx-meta",1159283194));
if(cljs.core.truth_((function (){var and__4251__auto__ = repo_url;
if(cljs.core.truth_(and__4251__auto__)){
return ((cljs.core.seq(tx_data)) && (cljs.core.not(new cljs.core.Keyword(null,"skip-refresh?","skip-refresh?",878432095).cljs$core$IFn$_invoke$arity$1(tx_meta))));
} else {
return and__4251__auto__;
}
})())){
var db = frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo_url);
var affected_keys = frontend.db.react.get_affected_queries_keys(tx);
var seq__48032 = cljs.core.seq(cljs.core.deref(frontend.db.react.query_state));
var chunk__48033 = null;
var count__48034 = (0);
var i__48035 = (0);
while(true){
if((i__48035 < count__48034)){
var vec__48068 = chunk__48033.cljs$core$IIndexed$_nth$arity$2(null,i__48035);
var k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48068,(0),null);
var cache = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48068,(1),null);
var custom_QMARK__48483 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"custom","custom",340151948),cljs.core.second(k));
var kv_QMARK__48491 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"kv","kv",-1099920440),cljs.core.second(k));
if(cljs.core.truth_((function (){var and__4251__auto__ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(k),repo_url);
if(and__4251__auto__){
var or__4253__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(affected_keys,cljs.core.vec(cljs.core.rest(k)));
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return ((custom_QMARK__48483) || (kv_QMARK__48491));
}
} else {
return and__4251__auto__;
}
})())){
var map__48073_48514 = cache;
var map__48073_48515__$1 = cljs.core.__destructure_map(map__48073_48514);
var query_48516 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48073_48515__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var query_fn_48517 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48073_48515__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
if(cljs.core.truth_((function (){var or__4253__auto__ = query_48516;
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return query_fn_48517;
}
})())){
try{var f_48518 = ((function (seq__48032,chunk__48033,count__48034,i__48035,map__48073_48514,map__48073_48515__$1,query_48516,query_fn_48517,custom_QMARK__48483,kv_QMARK__48491,vec__48068,k,cache,db,affected_keys,map__48026,map__48026__$1,tx,tx_data,tx_meta){
return (function (){
return frontend.db.react.execute_query_BANG_(repo_url,db,k,tx,cache);
});})(seq__48032,chunk__48033,count__48034,i__48035,map__48073_48514,map__48073_48515__$1,query_48516,query_fn_48517,custom_QMARK__48483,kv_QMARK__48491,vec__48068,k,cache,db,affected_keys,map__48026,map__48026__$1,tx,tx_data,tx_meta))
;
if(((custom_QMARK__48483) && (((cljs.core.not(new cljs.core.Keyword(null,"cards-query?","cards-query?",1220374615).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(query_48516)))) && (cljs.core.not(frontend.state.edit_in_query_component())))))){
cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2(frontend.state.get_reactive_custom_queries_chan(),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [f_48518,query_48516], null));
} else {
f_48518();
}
}catch (e48074){if((e48074 instanceof Error)){
var e_48519 = e48074;
console.error(e_48519);
} else {
throw e48074;

}
}} else {
}
} else {
}


var G__48520 = seq__48032;
var G__48521 = chunk__48033;
var G__48522 = count__48034;
var G__48523 = (i__48035 + (1));
seq__48032 = G__48520;
chunk__48033 = G__48521;
count__48034 = G__48522;
i__48035 = G__48523;
continue;
} else {
var temp__5720__auto__ = cljs.core.seq(seq__48032);
if(temp__5720__auto__){
var seq__48032__$1 = temp__5720__auto__;
if(cljs.core.chunked_seq_QMARK_(seq__48032__$1)){
var c__4679__auto__ = cljs.core.chunk_first(seq__48032__$1);
var G__48524 = cljs.core.chunk_rest(seq__48032__$1);
var G__48525 = c__4679__auto__;
var G__48526 = cljs.core.count(c__4679__auto__);
var G__48527 = (0);
seq__48032 = G__48524;
chunk__48033 = G__48525;
count__48034 = G__48526;
i__48035 = G__48527;
continue;
} else {
var vec__48079 = cljs.core.first(seq__48032__$1);
var k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48079,(0),null);
var cache = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48079,(1),null);
var custom_QMARK__48528 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"custom","custom",340151948),cljs.core.second(k));
var kv_QMARK__48529 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"kv","kv",-1099920440),cljs.core.second(k));
if(cljs.core.truth_((function (){var and__4251__auto__ = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.first(k),repo_url);
if(and__4251__auto__){
var or__4253__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(affected_keys,cljs.core.vec(cljs.core.rest(k)));
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return ((custom_QMARK__48528) || (kv_QMARK__48529));
}
} else {
return and__4251__auto__;
}
})())){
var map__48086_48530 = cache;
var map__48086_48531__$1 = cljs.core.__destructure_map(map__48086_48530);
var query_48532 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48086_48531__$1,new cljs.core.Keyword(null,"query","query",-1288509510));
var query_fn_48533 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48086_48531__$1,new cljs.core.Keyword(null,"query-fn","query-fn",-646736760));
if(cljs.core.truth_((function (){var or__4253__auto__ = query_48532;
if(cljs.core.truth_(or__4253__auto__)){
return or__4253__auto__;
} else {
return query_fn_48533;
}
})())){
try{var f_48534 = ((function (seq__48032,chunk__48033,count__48034,i__48035,map__48086_48530,map__48086_48531__$1,query_48532,query_fn_48533,custom_QMARK__48528,kv_QMARK__48529,vec__48079,k,cache,seq__48032__$1,temp__5720__auto__,db,affected_keys,map__48026,map__48026__$1,tx,tx_data,tx_meta){
return (function (){
return frontend.db.react.execute_query_BANG_(repo_url,db,k,tx,cache);
});})(seq__48032,chunk__48033,count__48034,i__48035,map__48086_48530,map__48086_48531__$1,query_48532,query_fn_48533,custom_QMARK__48528,kv_QMARK__48529,vec__48079,k,cache,seq__48032__$1,temp__5720__auto__,db,affected_keys,map__48026,map__48026__$1,tx,tx_data,tx_meta))
;
if(((custom_QMARK__48528) && (((cljs.core.not(new cljs.core.Keyword(null,"cards-query?","cards-query?",1220374615).cljs$core$IFn$_invoke$arity$1(cljs.core.meta(query_48532)))) && (cljs.core.not(frontend.state.edit_in_query_component())))))){
cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2(frontend.state.get_reactive_custom_queries_chan(),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [f_48534,query_48532], null));
} else {
f_48534();
}
}catch (e48091){if((e48091 instanceof Error)){
var e_48535 = e48091;
console.error(e_48535);
} else {
throw e48091;

}
}} else {
}
} else {
}


var G__48536 = cljs.core.next(seq__48032__$1);
var G__48537 = null;
var G__48538 = (0);
var G__48539 = (0);
seq__48032 = G__48536;
chunk__48033 = G__48537;
count__48034 = G__48538;
i__48035 = G__48539;
continue;
}
} else {
return null;
}
}
break;
}
} else {
return null;
}
});
frontend.db.react.set_key_value = (function frontend$db$react$set_key_value(repo_url,key,value){
if(cljs.core.truth_(value)){
return frontend.db.utils.transact_BANG_.cljs$core$IFn$_invoke$arity$2(repo_url,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [frontend.db.react.kv(key,value)], null));
} else {
return frontend.db.react.remove_key_BANG_(repo_url,key);
}
});
frontend.db.react.sub_key_value = (function frontend$db$react$sub_key_value(var_args){
var G__48100 = arguments.length;
switch (G__48100) {
case 1:
return frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$1 = (function (key){
return frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$2(frontend.state.get_current_repo(),key);
}));

(frontend.db.react.sub_key_value.cljs$core$IFn$_invoke$arity$2 = (function (repo_url,key){
if(cljs.core.truth_(frontend.db.conn.get_db.cljs$core$IFn$_invoke$arity$1(repo_url))){
var m = (function (){var G__48103 = frontend.db.react.q.cljs$core$IFn$_invoke$arity$variadic(repo_url,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"kv","kv",-1099920440),key], null),cljs.core.PersistentArrayMap.EMPTY,key,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([key], 0));
if((G__48103 == null)){
return null;
} else {
return frontend.util.react(G__48103);
}
})();
var temp__5718__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(m,key);
if(cljs.core.truth_(temp__5718__auto__)){
var result = temp__5718__auto__;
return result;
} else {
return m;
}
} else {
return null;
}
}));

(frontend.db.react.sub_key_value.cljs$lang$maxFixedArity = 2);

frontend.db.react.run_custom_queries_when_idle_BANG_ = (function frontend$db$react$run_custom_queries_when_idle_BANG_(){
var chan = frontend.state.get_reactive_custom_queries_chan();
var c__41861__auto___48541 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__41862__auto__ = (function (){var switch__41838__auto__ = (function (state_48161){
var state_val_48162 = (state_48161[(1)]);
if((state_val_48162 === (7))){
var inst_48122 = (state_48161[(7)]);
var inst_48126 = (state_48161[(2)]);
var inst_48128 = [cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("custom-query","failed","custom-query/failed",310909234)),"\n",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_48122)].join('');
var inst_48129 = console.error(inst_48128);
var inst_48130 = console.error(inst_48126);
var state_48161__$1 = (function (){var statearr_48172 = state_48161;
(statearr_48172[(8)] = inst_48129);

return statearr_48172;
})();
var statearr_48173_48542 = state_48161__$1;
(statearr_48173_48542[(2)] = inst_48130);

(statearr_48173_48542[(1)] = (6));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (1))){
var state_48161__$1 = state_48161;
var statearr_48174_48543 = state_48161__$1;
(statearr_48174_48543[(2)] = null);

(statearr_48174_48543[(1)] = (2));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (4))){
var inst_48119 = (state_48161[(2)]);
var inst_48121 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(inst_48119,(0),null);
var inst_48122 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(inst_48119,(1),null);
var state_48161__$1 = (function (){var statearr_48182 = state_48161;
(statearr_48182[(9)] = inst_48121);

(statearr_48182[(7)] = inst_48122);

return statearr_48182;
})();
var statearr_48186_48544 = state_48161__$1;
(statearr_48186_48544[(2)] = null);

(statearr_48186_48544[(1)] = (5));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (6))){
var inst_48155 = (state_48161[(2)]);
var state_48161__$1 = (function (){var statearr_48189 = state_48161;
(statearr_48189[(10)] = inst_48155);

return statearr_48189;
})();
var statearr_48191_48545 = state_48161__$1;
(statearr_48191_48545[(2)] = null);

(statearr_48191_48545[(1)] = (2));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (3))){
var inst_48158 = (state_48161[(2)]);
var state_48161__$1 = state_48161;
return cljs.core.async.impl.ioc_helpers.return_chan(state_48161__$1,inst_48158);
} else {
if((state_val_48162 === (12))){
var inst_48121 = (state_48161[(9)]);
var inst_48122 = (state_48161[(7)]);
var inst_48145 = (state_48161[(2)]);
var inst_48147 = cljs.core.PersistentVector.EMPTY_NODE;
var inst_48148 = [inst_48121,inst_48122];
var inst_48149 = (new cljs.core.PersistentVector(null,2,(5),inst_48147,inst_48148,null));
var inst_48150 = cljs.core.async.put_BANG_.cljs$core$IFn$_invoke$arity$2(chan,inst_48149);
var state_48161__$1 = (function (){var statearr_48195 = state_48161;
(statearr_48195[(11)] = inst_48145);

return statearr_48195;
})();
var statearr_48196_48546 = state_48161__$1;
(statearr_48196_48546[(2)] = inst_48150);

(statearr_48196_48546[(1)] = (11));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (2))){
var state_48161__$1 = state_48161;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_48161__$1,(4),chan);
} else {
if((state_val_48162 === (11))){
var inst_48152 = (state_48161[(2)]);
var _ = (function (){var statearr_48198 = state_48161;
(statearr_48198[(4)] = cljs.core.rest((state_48161[(4)])));

return statearr_48198;
})();
var state_48161__$1 = state_48161;
var statearr_48200_48547 = state_48161__$1;
(statearr_48200_48547[(2)] = inst_48152);

(statearr_48200_48547[(1)] = (6));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (9))){
var inst_48121 = (state_48161[(9)]);
var inst_48141 = (inst_48121.cljs$core$IFn$_invoke$arity$0 ? inst_48121.cljs$core$IFn$_invoke$arity$0() : inst_48121.call(null));
var state_48161__$1 = state_48161;
var statearr_48202_48548 = state_48161__$1;
(statearr_48202_48548[(2)] = inst_48141);

(statearr_48202_48548[(1)] = (11));


return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (5))){
var _ = (function (){var statearr_48206 = state_48161;
(statearr_48206[(4)] = cljs.core.cons((8),(state_48161[(4)])));

return statearr_48206;
})();
var inst_48137 = frontend.state.get_current_repo();
var inst_48138 = frontend.state.input_idle_QMARK_(inst_48137);
var state_48161__$1 = state_48161;
if(cljs.core.truth_(inst_48138)){
var statearr_48207_48549 = state_48161__$1;
(statearr_48207_48549[(1)] = (9));

} else {
var statearr_48208_48550 = state_48161__$1;
(statearr_48208_48550[(1)] = (10));

}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
if((state_val_48162 === (10))){
var inst_48143 = cljs.core.async.timeout((2000));
var state_48161__$1 = state_48161;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_48161__$1,(12),inst_48143);
} else {
if((state_val_48162 === (8))){
var _ = (function (){var statearr_48211 = state_48161;
(statearr_48211[(4)] = cljs.core.rest((state_48161[(4)])));

return statearr_48211;
})();
var state_48161__$1 = state_48161;
var ex48203 = (state_48161__$1[(2)]);
var statearr_48212_48551 = state_48161__$1;
(statearr_48212_48551[(5)] = ex48203);


if((ex48203 instanceof Error)){
var statearr_48214_48552 = state_48161__$1;
(statearr_48214_48552[(1)] = (7));

(statearr_48214_48552[(5)] = null);

} else {
throw ex48203;

}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
} else {
return null;
}
}
}
}
}
}
}
}
}
}
}
}
});
return (function() {
var frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto__ = null;
var frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto____0 = (function (){
var statearr_48218 = [null,null,null,null,null,null,null,null,null,null,null,null];
(statearr_48218[(0)] = frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto__);

(statearr_48218[(1)] = (1));

return statearr_48218;
});
var frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto____1 = (function (state_48161){
while(true){
var ret_value__41840__auto__ = (function (){try{while(true){
var result__41841__auto__ = switch__41838__auto__(state_48161);
if(cljs.core.keyword_identical_QMARK_(result__41841__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__41841__auto__;
}
break;
}
}catch (e48221){var ex__41842__auto__ = e48221;
var statearr_48222_48553 = state_48161;
(statearr_48222_48553[(2)] = ex__41842__auto__);


if(cljs.core.seq((state_48161[(4)]))){
var statearr_48223_48554 = state_48161;
(statearr_48223_48554[(1)] = cljs.core.first((state_48161[(4)])));

} else {
throw ex__41842__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__41840__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__48555 = state_48161;
state_48161 = G__48555;
continue;
} else {
return ret_value__41840__auto__;
}
break;
}
});
frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto__ = function(state_48161){
switch(arguments.length){
case 0:
return frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto____0.call(this);
case 1:
return frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto____1.call(this,state_48161);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto__.cljs$core$IFn$_invoke$arity$0 = frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto____0;
frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto__.cljs$core$IFn$_invoke$arity$1 = frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto____1;
return frontend$db$react$run_custom_queries_when_idle_BANG__$_state_machine__41839__auto__;
})()
})();
var state__41863__auto__ = (function (){var statearr_48225 = f__41862__auto__();
(statearr_48225[(6)] = c__41861__auto___48541);

return statearr_48225;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__41863__auto__);
}));


return chan;
});

//# sourceMappingURL=frontend.db.react.js.map
