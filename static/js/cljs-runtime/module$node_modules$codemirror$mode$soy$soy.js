shadow$provide.module$node_modules$codemirror$mode$soy$soy=function(global,require,module,exports){(function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("module$node_modules$codemirror$lib$codemirror"),require("module$node_modules$codemirror$mode$htmlmixed$htmlmixed")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed"],mod):mod(CodeMirror)})(function(CodeMirror){var paramData={noEndTag:!0,soyState:"param-def"},tags={alias:{noEndTag:!0},
delpackage:{noEndTag:!0},namespace:{noEndTag:!0,soyState:"namespace-def"},"@param":paramData,"@param?":paramData,"@inject":paramData,"@inject?":paramData,"@state":paramData,template:{soyState:"templ-def",variableScope:!0},literal:{},msg:{},fallbackmsg:{noEndTag:!0,reduceIndent:!0},select:{},plural:{},let:{soyState:"var-def"},"if":{},elseif:{noEndTag:!0,reduceIndent:!0},"else":{noEndTag:!0,reduceIndent:!0},"switch":{},"case":{noEndTag:!0,reduceIndent:!0},"default":{noEndTag:!0,reduceIndent:!0},foreach:{variableScope:!0,
soyState:"for-loop"},ifempty:{noEndTag:!0,reduceIndent:!0},"for":{variableScope:!0,soyState:"for-loop"},call:{soyState:"templ-ref"},param:{soyState:"param-ref"},print:{noEndTag:!0},deltemplate:{soyState:"templ-def",variableScope:!0},delcall:{soyState:"templ-ref"},log:{},element:{variableScope:!0}},indentingTags=Object.keys(tags).filter(function(tag){return!tags[tag].noEndTag||tags[tag].reduceIndent});CodeMirror.defineMode("soy",function(config){function last(array){return array[array.length-1]}function tokenUntil(stream,
state,untilRegExp){if(stream.sol()){for(var indent=0;indent<state.indent&&stream.eat(/\s/);indent++);if(indent)return null}indent=stream.string;if(untilRegExp=untilRegExp.exec(indent.substr(stream.pos)))stream.string=indent.substr(0,stream.pos+untilRegExp.index);untilRegExp=stream.hideFirstChars(state.indent,function(){var localState=last(state.localStates);return localState.mode.token(stream,localState.state)});stream.string=indent;return untilRegExp}function prepend(list,element){return{element,
next:list}}function popcontext(state){state.context&&(state.context.scope&&(state.variables=state.context.scope),state.context=state.context.previousContext)}function ref(list,name,loose){a:{for(;list;){if(list.element===name){name=!0;break a}list=list.next}name=!1}return name?"variable-2":loose?"variable":"variable-2 error"}function Context(previousContext,tag,scope){this.previousContext=previousContext;this.tag=tag;this.kind=null;this.scope=scope}function expression(stream,state){var match;if(stream.match(/[[]/))return state.soyState.push("list-literal"),
state.context=new Context(state.context,"list-literal",state.variables),state.lookupVariables=!1,null;if(stream.match(/map\b/))return state.soyState.push("map-literal"),"keyword";if(stream.match(/record\b/))return state.soyState.push("record-literal"),"keyword";if(stream.match(/([\w]+)(?=\()/))return"variable callee";if(match=stream.match(/^["']/))return state.soyState.push("string"),state.quoteKind=match[0],"string";if(stream.match(/^[(]/))return state.soyState.push("open-parentheses"),null;if(stream.match(/(null|true|false)(?!\w)/)||
stream.match(/0x([0-9a-fA-F]{2,})/)||stream.match(/-?([0-9]*[.])?[0-9]+(e[0-9]*)?/))return"atom";if(stream.match(/(\||[+\-*\/%]|[=!]=|\?:|[<>]=?)/))return"operator";if(match=stream.match(/^\$([\w]+)/))return ref(state.variables,match[1],!state.lookupVariables);if(match=stream.match(/^\w+/))return/^(?:as|and|or|not|in|if)$/.test(match[0])?"keyword":null;stream.next();return null}var textMode=CodeMirror.getMode(config,"text/plain"),modes={html:CodeMirror.getMode(config,{name:"text/html",multilineTagIndentFactor:2,
multilineTagIndentPastTag:!1}),attributes:textMode,text:textMode,uri:textMode,trusted_resource_uri:textMode,css:CodeMirror.getMode(config,"text/css"),js:CodeMirror.getMode(config,{name:"text/javascript",statementIndent:2*config.indentUnit})};return{startState:function(){return{soyState:[],variables:prepend(null,"ij"),scopes:null,indent:0,quoteKind:null,context:null,lookupVariables:!0,localStates:[{mode:modes.html,state:CodeMirror.startState(modes.html)}]}},copyState:function(state){return{tag:state.tag,
soyState:state.soyState.concat([]),variables:state.variables,context:state.context,indent:state.indent,quoteKind:state.quoteKind,lookupVariables:state.lookupVariables,localStates:state.localStates.map(function(localState){return{mode:localState.mode,state:CodeMirror.copyState(localState.mode,localState.state)}})}},token:function(stream,state){var match;switch(last(state.soyState)){case "comment":stream.match(/^.*?\*\//)?state.soyState.pop():stream.skipToEnd();if(!state.context||!state.context.scope)for(var paramRe=
/@param\??\s+(\S+)/g,current=stream.current();match=paramRe.exec(current);)state.variables=prepend(state.variables,match[1]);return"comment";case "string":return match=stream.match(/^.*?(["']|\\[\s\S])/),match?match[1]==state.quoteKind&&(state.quoteKind=null,state.soyState.pop()):stream.skipToEnd(),"string"}if(!state.soyState.length||"literal"!=last(state.soyState)){if(stream.match(/^\/\*/))return state.soyState.push("comment"),"comment";if(stream.match(stream.sol()?/^\s*\/\/.*/:/^\s+\/\/.*/))return"comment"}switch(last(state.soyState)){case "templ-def":if(stream.match(/^\.?([\w]+(?!\.[\w]+)*)/))return state.soyState.pop(),
"def";stream.next();return null;case "templ-ref":if(match=stream.match(/(\.?[a-zA-Z_][a-zA-Z_0-9]+)+/))return state.soyState.pop(),"."==match[0][0]?"variable-2":"variable";if(match=stream.match(/^\$([\w]+)/))return state.soyState.pop(),ref(state.variables,match[1],!state.lookupVariables);stream.next();return null;case "namespace-def":if(stream.match(/^\.?([\w\.]+)/))return state.soyState.pop(),"variable";stream.next();return null;case "param-def":if(match=stream.match(/^\w+/))return state.variables=
prepend(state.variables,match[0]),state.soyState.pop(),state.soyState.push("param-type"),"def";stream.next();return null;case "param-ref":if(stream.match(/^\w+/))return state.soyState.pop(),"property";stream.next();return null;case "open-parentheses":return stream.match(/[)]/)?(state.soyState.pop(),null):expression(stream,state);case "param-type":paramRe=stream.peek();if(-1!="}]\x3d\x3e,".indexOf(paramRe))return state.soyState.pop(),null;if("["==paramRe)return state.soyState.push("param-type-record"),
null;if("("==paramRe)return state.soyState.push("param-type-template"),null;if("\x3c"==paramRe)return state.soyState.push("param-type-parameter"),null;if(stream.match(/^([\w]+|[?])/))return"type";stream.next();return null;case "param-type-record":paramRe=stream.peek();if("]"==paramRe)return state.soyState.pop(),null;if(stream.match(/^\w+/))return state.soyState.push("param-type"),"property";stream.next();return null;case "param-type-parameter":if(stream.match(/^[>]/))return state.soyState.pop(),null;
if(stream.match(/^[<,]/))return state.soyState.push("param-type"),null;stream.next();return null;case "param-type-template":if(stream.match(/[>]/))return state.soyState.pop(),state.soyState.push("param-type"),null;if(stream.match(/^\w+/))return state.soyState.push("param-type"),"def";stream.next();return null;case "var-def":if(match=stream.match(/^\$([\w]+)/))return state.variables=prepend(state.variables,match[1]),state.soyState.pop(),"def";stream.next();return null;case "for-loop":if(stream.match(/\bin\b/))return state.soyState.pop(),
"keyword";if("$"==stream.peek())return state.soyState.push("var-def"),null;stream.next();return null;case "record-literal":if(stream.match(/^[)]/))return state.soyState.pop(),null;if(stream.match(/[(,]/))return state.soyState.push("map-value"),state.soyState.push("record-key"),null;stream.next();return null;case "map-literal":if(stream.match(/^[)]/))return state.soyState.pop(),null;if(stream.match(/[(,]/))return state.soyState.push("map-value"),state.soyState.push("map-value"),null;stream.next();
return null;case "list-literal":return stream.match(/\]/)?(state.soyState.pop(),state.lookupVariables=!0,popcontext(state),null):stream.match(/\bfor\b/)?(state.lookupVariables=!0,state.soyState.push("for-loop"),"keyword"):expression(stream,state);case "record-key":if(stream.match(/[\w]+/))return"property";if(stream.match(/^[:]/))return state.soyState.pop(),null;stream.next();return null;case "map-value":return")"==stream.peek()||","==stream.peek()||stream.match(/^[:)]/)?(state.soyState.pop(),null):
expression(stream,state);case "import":if(stream.eat(";"))return state.soyState.pop(),state.indent-=2*config.indentUnit,null;if(stream.match(/\w+(?=\s+as)/))return"variable";if(match=stream.match(/\w+/))return/(from|as)/.test(match[0])?"keyword":"def";if(match=stream.match(/^["']/))return state.soyState.push("string"),state.quoteKind=match[0],"string";stream.next();return null;case "tag":return current=(paramRe="/"==state.tag[0])?state.tag.substring(1):state.tag,stream.match(/^\/?}/)?((current="/}"==
stream.current())&&!paramRe&&popcontext(state),"/template"==state.tag||"/deltemplate"==state.tag?(state.variables=prepend(null,"ij"),state.indent=0):state.indent-=config.indentUnit*(current||-1==indentingTags.indexOf(state.tag)?2:1),state.soyState.pop(),"keyword"):stream.match(/^([\w?]+)(?==)/)?(state.context&&state.context.tag==current&&"kind"==stream.current()&&(match=stream.match(/^="([^"]+)/,!1))&&(paramRe=match[1],state.context.kind=paramRe,current=modes[paramRe]||modes.html,paramRe=last(state.localStates),
paramRe.mode.indent&&(state.indent+=paramRe.mode.indent(paramRe.state,"","")),state.localStates.push({mode:current,state:CodeMirror.startState(current)})),"attribute"):expression(stream,state);case "literal":return stream.match(/^(?=\{\/literal})/)?(state.soyState.pop(),this.token(stream,state)):tokenUntil(stream,state,/\{\/literal}/)}if(stream.match(/^\{literal}/))return state.indent+=config.indentUnit,state.soyState.push("literal"),state.context=new Context(state.context,"literal",state.variables),
"keyword";if(match=stream.match(/^\{([/@\\]?\w+\??)(?=$|[\s}]|\/[/*])/)){stream=state.tag;state.tag=match[1];paramRe="/"==state.tag[0];var indentingTag=!!tags[state.tag];current=paramRe?state.tag.substring(1):state.tag;match=tags[current];"/switch"!=state.tag&&(state.indent+=((paramRe||match&&match.reduceIndent)&&"switch"!=stream?1:2)*config.indentUnit);state.soyState.push("tag");stream=!1;match?(paramRe||match.soyState&&state.soyState.push(match.soyState),match.noEndTag||!indentingTag&&paramRe)?
paramRe&&(state.context&&state.context.tag==current?state.context&&(state.context.kind&&(state.localStates.pop(),paramRe=last(state.localStates),paramRe.mode.indent&&(state.indent-=paramRe.mode.indent(paramRe.state,"",""))),popcontext(state)):stream=!0):state.context=new Context(state.context,state.tag,match.variableScope?state.variables:null):paramRe&&(stream=!0);return(stream?"error ":"")+"keyword"}return stream.eat("{")?(state.tag="print",state.indent+=2*config.indentUnit,state.soyState.push("tag"),
"keyword"):!state.context&&stream.match(/\bimport\b/)?(state.soyState.push("import"),state.indent+=2*config.indentUnit,"keyword"):tokenUntil(stream,state,/\{|\s+\/\/|\/\*/)},indent:function(state,textAfter,line){var indent=state.indent,top=last(state.soyState);if("comment"==top)return CodeMirror.Pass;if("literal"==top)/^\{\/literal}/.test(textAfter)&&(indent-=config.indentUnit);else{if(/^\s*\{\/(template|deltemplate)\b/.test(textAfter))return 0;/^\{(\/|(fallbackmsg|elseif|else|ifempty)\b)/.test(textAfter)&&
(indent-=config.indentUnit);"switch"!=state.tag&&/^\{(case|default)\b/.test(textAfter)&&(indent-=config.indentUnit);/^\{\/switch\b/.test(textAfter)&&(indent-=config.indentUnit)}state=last(state.localStates);indent&&state.mode.indent&&(indent+=state.mode.indent(state.state,textAfter,line));return indent},innerMode:function(state){return state.soyState.length&&"literal"!=last(state.soyState)?null:last(state.localStates)},electricInput:/^\s*\{(\/|\/template|\/deltemplate|\/switch|fallbackmsg|elseif|else|case|default|ifempty|\/literal\})$/,
lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",useInnerComments:!1,fold:"indent"}},"htmlmixed");CodeMirror.registerHelper("wordChars","soy",/[\w$]/);CodeMirror.registerHelper("hintWords","soy",Object.keys(tags).concat(["css","debugger"]));CodeMirror.defineMIME("text/x-soy","soy")})}
//# sourceMappingURL=module$node_modules$codemirror$mode$soy$soy.js.map
