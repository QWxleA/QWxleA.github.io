{"version":3,"sources":["frontend/handler/history.cljs"],"mappings":";AASA,gDAAA,wDAAAA,xGAAMI;AAAN,AAAA,IAAAH,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;sBAAA,AAAAE,4CAAAF,eAAA,7EACWI;gBADX,AAAAF,4CAAAF,eAAA,vEAC2BK;UAD3B,AAAAH,4CAAAF,eAAA,jEACqCM;AADrC,AAEE,AAACC;;AACD,oBAAM,iBAAAC,oBAAKH;AAAL,AAAA,oBAAAG;AAAeJ;;AAAfI;;;AAAN,AAEE,IAAAC,qBAAqB,AAACC,oBAAgBL;AAAtC,AAAA,oBAAAI;AAAA,AAAA,oBAAAA,hBAAWJ;AAAX,AACE,IAAAI,yBAAsB,AAAA,6FAAaL;AAAnC,AAAA,oBAAAK;AAAA,AAAA,iBAAAA,bAAWE;AAAX,AACE,IAAAF,yBAAiB,iBAAAI,WAAA,mFAAA,+DAAsBF;AAAtB,AAAA,wGAAAE,uCAAAA,vIAACC,iDAAAA,2DAAAA;;AAAlB,AAAA,oBAAAL;AAAA,AAAA,YAAAA,RAAWG;AAAX,AACE,4LAAA,2CAAA,hOAACG,uEAAmBH,MAAMN,IACN,AAAA,6FAAaM,yHACI,AAAA,kGAAgBA;;AAHvD;;;AADF;;;AADF;;;AAFF;;;AASF,sCAAA,tCAAMI,oFACHC;AADH,AAEE,AAACC,mBAAUD;;AACX,mCAAA,nCAACE;;AACD,AAACC;;AACD,IAAAC,mBAA8B,AAACE;IAA/BF,uBAAA,AAAApB,4BAAAoB;0BAAA,AAAAnB,4CAAAmB,qBAAA,vFAAcC;AAAd,AACE,AAACnB,8CAAgBmB;;AACnB,0CAAA,nCAACH;;AAEH,sCAAA,tCAAMK,oFACHP;AADH,AAEE,AAACC,mBAAUD;;AACX,mCAAA,nCAACE;;AACD,IAAAM,mBAA8B,AAACC;IAA/BD,uBAAA,AAAAxB,4BAAAwB;0BAAA,AAAAvB,4CAAAuB,qBAAA,vFAAcH;AAAd,AACE,AAACnB,8CAAgBmB;;AACnB,0CAAA,nCAACH","names":["p__47623","map__47624","cljs.core/--destructure-map","cljs.core.get","frontend.handler.history/restore-cursor!","last-edit-block","container","pos","frontend.handler.ui.re_render_root_BANG_","and__5041__auto__","temp__5720__auto__","goog.dom/getElement","block-uuid","block","G__47625","frontend.db/pull","frontend.handler.editor.edit_block_BANG_","frontend.handler.history/undo!","e","frontend.util/stop","frontend.state/set-editor-op!","frontend.handler.editor.save_current_block_BANG_","map__47628","editor-cursor","frontend.modules.editor.undo-redo/undo","frontend.handler.history/redo!","map__47629","frontend.modules.editor.undo-redo/redo"],"sourcesContent":["(ns frontend.handler.history\n  (:require [frontend.db :as db]\n            [frontend.handler.editor :as editor]\n            [frontend.handler.ui :as ui-handler]\n            [frontend.modules.editor.undo-redo :as undo-redo]\n            [frontend.state :as state]\n            [frontend.util :as util]\n            [goog.dom :as gdom]))\n\n(defn restore-cursor!\n  [{:keys [last-edit-block container pos]}]\n  (ui-handler/re-render-root!)\n  (when (and container last-edit-block)\n    #_:clj-kondo/ignore\n    (when-let [container (gdom/getElement container)]\n      (when-let [block-uuid (:block/uuid last-edit-block)]\n        (when-let [block (db/pull [:block/uuid block-uuid])]\n          (editor/edit-block! block pos\n                              (:block/uuid block)\n                              {:custom-content (:block/content block)}))))))\n\n(defn undo!\n  [e]\n  (util/stop e)\n  (state/set-editor-op! :undo)\n  (editor/save-current-block!)\n  (let [{:keys [editor-cursor]} (undo-redo/undo)]\n    (restore-cursor! editor-cursor))\n  (state/set-editor-op! nil))\n\n(defn redo!\n  [e]\n  (util/stop e)\n  (state/set-editor-op! :redo)\n  (let [{:keys [editor-cursor]} (undo-redo/redo)]\n    (restore-cursor! editor-cursor))\n  (state/set-editor-op! nil))\n"]}