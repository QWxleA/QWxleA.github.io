{"version":3,"sources":["frontend/components/commit.cljs"],"mappings":";;;;AAUA,mDAAA,nDAAMA;AAAN,AAEE,IAAMC,QAAM,6FAAA,7FAACC,uDAAS,oBAAA,pBAACC;AAAvB,AACE,oBAAM,iBAAAC,oBAAKH;AAAL,AAAA,oBAAAG;AAAW,kCAAA,1BAAI,AAACC,gBAAMJ;;AAAtBG;;;AAAN,AACE,oBAAM,AAACE;AAAP,AACE,wGAAA,xGAACC,uHAAuBN;;AAD1B;;AAEA,OAACO;;AAHH;;;AAKJ,gDAAA,AAAAC,oBAAAC,qBAAA,zFAAWE,oGAYRC,MAAMM;AAZT,AAAA,AAAA,OAAAR,6BAAA,MAAA,SAAA,WAAA,sBAAA,sCAAA,CAAA,AAAAA,6BAAA,MAAA,aAAA,0BAAA,CAAA,AAAAA,6BAAA,MAAA,aAAA,8CAAA,CAAA,AAAAA,6BAAA,KAAA,MAAA,6BAAA,iCAAA,CAAA,6BAAA,AAAAA,6BAAA,QAAA,MAAA,6BAAA,oBAAA,eAAA,wDAAA,MAAA,AAAAA,6BAAA,MAAA,aAAA,qBAAA,CAAA,AAAAA,6BAAA,OAAA,aAAA,oCAAA,CAAA,AAAAA,6BAAA,SAAA,QAAA,gFAAA,8SAAA,CAAA,5WA2BiBX;GA3BjB,mFAAA,2CAAA,kEACe,WAAKa;AAAL,AACE,IAAAC,4BAAiB,oBAAA,pBAACX;AAAlB,AAAA,oBAAAW;AAAA,AAAA,mBAAAA,fAAWC;AAAX,AACE,AAAQA;;AACR,AAACC,wCAA0BD;;AAF7B;;AAGAF;WACf,AAACI,0DACA,WAAKJ;AAAL,AACE,6HAAA,0FAAA,hNAACK,8DAAgBL,4GACM,oBAAA,pBAACV,mGACG;AAAA,AACE,OAACH;;YAXnC;AA8BA,qDAAA,rDAAMoB,kHAAoBC;AAA1B,AACE,oBAAM,iBAAAjB,oBACC,AAACE;AADF,AAAA,oBAAAF;AAAA,4HAAA,2FAAA,0FAAA,xSAEC,AAACkB,cAAI,AAACC,2BAAY,yDAAA,zDAACrB,uDAASmB,qBAC5B,AAACC,cAAI,yDAAA,zDAACpB,uDAASmB,sBACf,AAACC,cAAI,yDAAA,zDAACpB,uDAASmB,qBACf,AAACC,cAAI,yDAAA,zDAACpB,uDAASmB,kBACf,AAACC,cAAI,yDAAA,zDAACpB,uDAASmB;;AANhBjB;;;AAAN,AAQE,IAAAU,qBAAoB,AAACW;AAArB,AAAA,oBAAAX;AAAA,AAAA,eAAAA,XAAWU;AAAX,AACE,oBAAU,AAACE;AAAX;;AAAA,AACE,AAACC,mBAAUN;;AACX,OAACO,6DAAiBhB;;;AAHtB;;;AARF","names":["frontend.components.commit/commit-and-push!","value","frontend.components.commit.goog$module$goog$object.get","goog.dom/getElement","and__4251__auto__","cljs.core/count","frontend.util/electron?","electron.ipc.ipc","frontend.state/close-modal!","rum.core/lazy-build","rum.core/build-defcs","daiquiri.core/create-element","frontend.components.commit/add-commit-message","state","temp__5720__auto__","input","frontend.util.cursor/move-cursor-to-end","frontend.mixins.event_mixin","frontend.mixins.on_enter","_close-fn","frontend.components.commit/show-commit-modal!","e","cljs.core/not","frontend.util/input?","repo-url","frontend.state/get-current-repo","frontend.state/get-edit-input-id","frontend.util/stop","frontend.state.set_modal_BANG_"],"sourcesContent":["(ns frontend.components.commit\n  (:require [electron.ipc :as ipc]\n            [frontend.mixins :as mixins]\n            [frontend.state :as state]\n            [frontend.util :as util]\n            [frontend.util.cursor :as cursor]\n            [goog.dom :as gdom]\n            [goog.object :as gobj]\n            [rum.core :as rum]))\n\n(defn commit-and-push!\n  []\n  (let [value (gobj/get (gdom/getElement \"commit-message\") \"value\")]\n    (when (and value (>= (count value) 1))\n      (when (util/electron?)\n        (ipc/ipc \"gitCommitAll\" value))\n      (state/close-modal!))))\n\n(rum/defcs add-commit-message <\n  {:did-update (fn [state]\n                 (when-let [input (gdom/getElement \"commit-message\")]\n                   (.focus input)\n                   (cursor/move-cursor-to-end input))\n                 state)}\n  (mixins/event-mixin\n   (fn [state]\n     (mixins/on-enter state\n                      :node (gdom/getElement \"commit-message\")\n                      :on-enter (fn []\n                                  (commit-and-push!)))))\n  [state _close-fn]\n  [:div.w-full.mx-auto.sm:max-w-lg.sm:w-96 {:style {:padding \"48px 0\"}}\n   [:div.sm:flex.sm:items-start\n    [:div.mt-3.text-center.sm:mt-0.sm:text-left.mb-2\n     [:h3#modal-headline.text-lg.leading-6.font-medium\n      \"Your commit message:\"]]]\n\n   [:input#commit-message.form-input.block.w-full.sm:text-sm.sm:leading-5.my-2\n    {:auto-focus true\n     :default-value \"\"}]\n\n   [:div.mt-5.sm:mt-4.flex\n    [:span.flex.w-full.rounded-md.shadow-sm\n     [:button.inline-flex.justify-center.w-full.rounded-md.border.border-transparent.px-4.py-2.bg-indigo-600.text-base.leading-6.font-medium.text-white.shadow-sm.hover:bg-indigo-500.focus:outline-none.focus:border-indigo-700.focus:shadow-outline-indigo.transition.ease-in-out.duration-150.sm:text-sm.sm:leading-5\n      {:type \"button\"\n       :on-click commit-and-push!}\n      \"Commit\"]]]])\n\n(defn show-commit-modal! [e]\n  (when (and\n         (util/electron?)\n         (not (util/input? (gobj/get e \"target\")))\n         (not (gobj/get e \"shiftKey\"))\n         (not (gobj/get e \"ctrlKey\"))\n         (not (gobj/get e \"altKey\"))\n         (not (gobj/get e \"metaKey\")))\n    #_:clj-kondo/ignore\n    (when-let [repo-url (state/get-current-repo)]\n      (when-not (state/get-edit-input-id)\n        (util/stop e)\n        (state/set-modal! add-commit-message)))))\n"]}