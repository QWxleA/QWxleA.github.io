{"version":3,"sources":["frontend/fs/bfs.cljs"],"mappings":"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","names":["this__4502__auto__","k__4503__auto__","this__4504__auto__","k57912","else__4505__auto__","G__57916","cljs.core.get","__extmap","this__4522__auto__","f__4523__auto__","init__4524__auto__","cljs.core.reduce","ret__4525__auto__","p__57917","vec__57918","k__4526__auto__","cljs.core.nth","v__4527__auto__","this__4517__auto__","writer__4518__auto__","opts__4519__auto__","pr-pair__4520__auto__","keyval__4521__auto__","cljs.core/pr-sequential-writer","cljs.core.concat","G__57911","cljs.core/RecordIter","cljs.core/-iterator","cljs.core/nil-iter","this__4500__auto__","__meta","this__4497__auto__","__hash","this__4506__auto__","cljs.core/count","this__4498__auto__","h__4360__auto__","coll__4499__auto__","cljs.core/hash-unordered-coll","this57913","other57914","cljs.core._EQ_","this__4512__auto__","k__4513__auto__","cljs.core/contains?","cljs.core.dissoc","cljs.core/-with-meta","cljs.core.into","cljs.core/not-empty","this__4509__auto__","this__4510__auto__","k__4511__auto__","pred__57922","cljs.core/keyword-identical?","expr__57923","cljs.core.assoc","this__4515__auto__","cljs.core/seq","this__4501__auto__","this__4507__auto__","entry__4508__auto__","cljs.core/vector?","cljs.core/-nth","cljs.core/-conj","cljs.core/PROTOCOL_SENTINEL","frontend.fs.bfs/Bfs","this__4546__auto__","cljs.core/List","writer__4547__auto__","cljs.core/-write","G__57915","extmap__4542__auto__","G__57930","cljs.core/record?","frontend.fs.bfs/->Bfs","frontend.fs.bfs/map->Bfs","_this","dir","and__4251__auto__","js/window.pfs","cljs.core/not","frontend.util/electron?","js/window.pfs.mkdir","promesa.core.catch$","error","cljs.core.println","js/window.pfs.readdir","_repo","path","opts","promesa.core.bind","___42626__auto__","promesa.protocols/-promise","stat","js/window.pfs.stat","js/window.pfs.unlink","promesa.core/rejected","js/window.workerThread.rimraf","options","js/window.pfs.readFile","cljs.core/clj->js","content","_opts","js/window.pfs.writeFile","old-path","new-path","js/window.pfs.rename","_ok-handler","_path-or-handle","_dir"],"sourcesContent":["(ns frontend.fs.bfs\n  (:require [frontend.fs.protocol :as protocol]\n            [frontend.util :as util]\n            [promesa.core :as p]))\n\n(defrecord Bfs []\n  protocol/Fs\n  (mkdir! [_this dir]\n    (when (and js/window.pfs (not (util/electron?)))\n      (->\n       (js/window.pfs.mkdir dir)\n       (p/catch (fn [error] (println \"Mkdir error: \" error))))))\n  (readdir [_this dir]\n    (when js/window.pfs\n      (js/window.pfs.readdir dir)))\n  (unlink! [_this _repo path opts]\n    (when js/window.pfs\n      (p/let [stat (js/window.pfs.stat path)]\n        (if (= (.-type stat) \"file\")\n          (js/window.pfs.unlink path opts)\n          (p/rejected \"Unlinking a directory is not allowed\")))))\n  (rmdir! [_this dir]\n    (js/window.workerThread.rimraf dir))\n  (read-file [_this dir path options]\n    (js/window.pfs.readFile (str dir \"/\" path) (clj->js options)))\n  (write-file! [_this _repo dir path content _opts]\n    (when-not (util/electron?)\n      (js/window.pfs.writeFile (str dir \"/\" path) content)))\n  (rename! [_this _repo old-path new-path]\n    (js/window.pfs.rename old-path new-path))\n  (stat [_this dir path]\n    (js/window.pfs.stat (str dir path)))\n  (open-dir [_this _ok-handler]\n    nil)\n  (get-files [_this _path-or-handle _ok-handler]\n    nil)\n  (watch-dir! [_this _dir]\n    nil))\n"]}