{"version":3,"sources":["frontend/date.cljs"],"mappings":"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","names":["frontend.date/nld-parse","s","fexpr__32789","frontend.date.goog$module$goog$object.get","js/module$node_modules$chrono_node$dist$index","frontend.date/custom-formatter","cljs_time.format.formatter","frontend.date/journal-title-formatters","cljs.core.conj","frontend.state/get-date-formatter","var_args","G__32791","frontend.date/get-date-time-string","js/Error","frontend.date.get_date_time_string","cljs-time.core/now","date-time","cljs-time.format/unparse","frontend.date/get-locale-string","e32798","cljs_time.format.parse","cljs-time.format/formatters","cljs-time.core/to-default-time-zone","_e","frontend.date/custom-formatter-2","frontend.date/get-date-time-string-2","cljs-time.local/local-now","frontend.date/custom-formatter-3","frontend.date/get-date-time-string-3","frontend.date/custom-formatter-4","frontend.date/get-date-time-string-4","frontend.date/get-weekday","date","cljs.core/clj->js","G__32818","frontend.date/get-date","frontend.date.get_date","js/Date","G__32823","frontend.date/year-month-day-padded","frontend.date.year_month_day_padded","map__32825","cljs.core/--destructure-map","cljs.core.get","year","month","day","frontend.util/zero-pad","G__32829","frontend.date/journal-name","frontend.date.journal_name","logseq.graph-parser.date-time-util/format","frontend.date/journal-name-s","e32831","lambdaisland.glogi.log","cljs.core/identity","frontend.date/today","frontend.date/tomorrow","cljs_time.core.plus","cljs-time.core/today","cljs_time.core.days","frontend.date/yesterday","cljs_time.core.minus","G__32835","frontend.date/ymd","frontend.date.ymd","sep","map__32838","frontend.date/get-local-date","hour","minute","frontend.date/get-current-time","d","js/window.navigator","cljs-bean.core/->js","frontend.date/valid?","cljs.core/some","formatter","e32843","frontend.date/valid-journal-title?","title","and__5041__auto__","logseq.graph-parser.util/capitalize-all","G__32848","frontend.date/journal-title->","journal-title","then-fn","frontend.date.journal_title__GT_","logseq.graph-parser.date-time-util/safe-journal-title-formatters","formatters","logseq.graph-parser.date-time-util/journal-title->","frontend.date/journal-title->int","logseq.graph-parser.date-time-util/journal-title->int","frontend.date/journal-day->ts","cljs-time.coerce/to-long","frontend.date/journal-title->long","p1__32851#","frontend.date/default-journal-title-formatter","frontend.date/journal-title->default","temp__5718__auto__","format","frontend.state/get-journal-file-name-format","p1__32852#","frontend.date/date->file-name","frontend.date/journal-title->custom-format","p1__32854#","frontend.date/int->local-time-2","n","cljs-time.coerce/from-long"],"sourcesContent":["(ns frontend.date\n  (:require [\"chrono-node\" :as chrono]\n            [cljs-bean.core :as bean]\n            [cljs-time.coerce :as tc]\n            [cljs-time.core :as t]\n            [cljs-time.format :as tf]\n            [cljs-time.local :as tl]\n            [frontend.state :as state]\n            [frontend.util :as util]\n            [logseq.graph-parser.util :as gp-util]\n            [logseq.graph-parser.date-time-util :as date-time-util]\n            [goog.object :as gobj]\n            [lambdaisland.glogi :as log]))\n\n(defn nld-parse\n  [s]\n  (when (string? s)\n    ((gobj/get chrono \"parseDate\") s)))\n\n(def custom-formatter (tf/formatter \"yyyy-MM-dd'T'HH:mm:ssZZ\"))\n\n(defn journal-title-formatters\n  []\n  (conj\n   #{\"do MMM yyyy\"\n     \"do MMMM yyyy\"\n     \"MMM do, yyyy\"\n     \"MMMM do, yyyy\"\n     \"E, dd-MM-yyyy\"\n     \"E, dd.MM.yyyy\"\n     \"E, MM/dd/yyyy\"\n     \"E, yyyy/MM/dd\"\n     \"EEE, dd-MM-yyyy\"\n     \"EEE, dd.MM.yyyy\"\n     \"EEE, MM/dd/yyyy\"\n     \"EEE, yyyy/MM/dd\"\n     \"EEEE, dd-MM-yyyy\"\n     \"EEEE, dd.MM.yyyy\"\n     \"EEEE, MM/dd/yyyy\"\n     \"EEEE, yyyy/MM/dd\"\n     \"dd-MM-yyyy\"\n     \"dd.MM.yyyy\"\n     \"MM/dd/yyyy\"\n     \"MM-dd-yyyy\"\n     \"MM_dd_yyyy\"\n     \"yyyy/MM/dd\"\n     \"yyyy-MM-dd\"\n     \"yyyy-MM-dd EEEE\"\n     \"yyyy_MM_dd\"\n     \"yyyyMMdd\"\n     \"yyyy\u5e74MM\u6708dd\u65e5\"}\n   (state/get-date-formatter)))\n\n(defn get-date-time-string\n  ([]\n   (get-date-time-string (t/now)))\n  ([date-time]\n   (tf/unparse custom-formatter date-time)))\n\n(defn get-locale-string\n  [s]\n  (try\n    (->> (tf/parse (tf/formatters :date-time-no-ms) s)\n        (t/to-default-time-zone)\n        (tf/unparse (tf/formatter \"MMM do, yyyy\")))\n    (catch js/Error _e\n      nil)))\n\n(def custom-formatter-2 (tf/formatter \"yyyy-MM-dd-HH-mm-ss\"))\n(defn get-date-time-string-2 []\n  (tf/unparse custom-formatter-2 (tl/local-now)))\n\n(def custom-formatter-3 (tf/formatter \"yyyy-MM-dd E HH:mm\"))\n(defn get-date-time-string-3 []\n  (tf/unparse custom-formatter-3 (tl/local-now)))\n\n(def custom-formatter-4 (tf/formatter \"yyyy-MM-dd E HH:mm:ss\"))\n(defn get-date-time-string-4 []\n  (tf/unparse custom-formatter-4 (tl/local-now)))\n\n(defn get-weekday\n  [date]\n  (.toLocaleString date \"en-us\" (clj->js {:weekday \"long\"})))\n\n(defn get-date\n  ([]\n   (get-date (js/Date.)))\n  ([date]\n   {:year (.getFullYear date)\n    :month (inc (.getMonth date))\n    :day (.getDate date)\n    :weekday (get-weekday date)}))\n\n(defn year-month-day-padded\n  ([]\n   (year-month-day-padded (get-date)))\n  ([date]\n   (let [{:keys [year month day]} date]\n     {:year year\n      :month (util/zero-pad month)\n      :day (util/zero-pad day)})))\n\n(defn journal-name\n  ([]\n   (journal-name (tl/local-now)))\n  ([date]\n   (date-time-util/format date (state/get-date-formatter))))\n\n(defn journal-name-s [s]\n  (try\n    (journal-name (tf/parse (tf/formatter \"yyyy-MM-dd\") s))\n    (catch js/Error _e\n      (log/info :parse-journal-date {:message  \"Unable to parse date to journal name, skipping.\"\n                                     :date-str s})\n      nil)))\n\n(defn today\n  []\n  (journal-name))\n\n(defn tomorrow\n  []\n  (journal-name (t/plus (t/today) (t/days 1))))\n\n(defn yesterday\n  []\n  (journal-name (t/minus (t/today) (t/days 1))))\n\n(defn ymd\n  ([]\n   (ymd (js/Date.)))\n  ([date]\n   (ymd date \"/\"))\n  ([date sep]\n   (let [{:keys [year month day]} (year-month-day-padded (get-date date))]\n     (str year sep month sep day))))\n\n(defn get-local-date\n  []\n  (let [date (js/Date.)\n        year (.getFullYear date)\n        month (inc (.getMonth date))\n        day (.getDate date)\n        hour (.getHours date)\n        minute (.getMinutes date)]\n    {:year year\n     :month month\n     :day day\n     :hour hour\n     :minute minute}))\n\n(defn get-current-time\n  []\n  (let [d (js/Date.)]\n    (.toLocaleTimeString\n     d\n     (gobj/get js/window.navigator \"language\")\n     (bean/->js {:hour \"2-digit\"\n                 :minute \"2-digit\"\n                 :hourCycle \"h23\"}))))\n\n(defn valid?\n  [s]\n  (some\n   (fn [formatter]\n     (try\n       (tf/parse (tf/formatter formatter) s)\n       (catch js/Error _e\n         false)))\n   (journal-title-formatters)))\n\n(defn valid-journal-title?\n  [title]\n  (and title\n       (valid? (gp-util/capitalize-all title))))\n\n(defn journal-title->\n  ([journal-title then-fn]\n   (journal-title-> journal-title then-fn (date-time-util/safe-journal-title-formatters (state/get-date-formatter))))\n  ([journal-title then-fn formatters]\n   (date-time-util/journal-title-> journal-title then-fn formatters)))\n\n(defn journal-title->int\n  [journal-title]\n  (date-time-util/journal-title->int\n   journal-title\n   (date-time-util/safe-journal-title-formatters (state/get-date-formatter))))\n\n(defn journal-day->ts\n  [day]\n  (when day\n    (-> (tf/parse (tf/formatter \"yyyyMMdd\") (str day))\n        (tc/to-long))))\n\n(defn journal-title->long\n  [journal-title]\n  (journal-title-> journal-title #(tc/to-long %)))\n\n(def default-journal-title-formatter (tf/formatter \"yyyy_MM_dd\"))\n\n(defn journal-title->default\n  [journal-title]\n  (let [formatter (if-let [format (state/get-journal-file-name-format)]\n                    (tf/formatter format)\n                    default-journal-title-formatter)]\n    (journal-title-> journal-title #(tf/unparse formatter %))))\n\n(defn date->file-name\n  [date]\n  (let [formatter (if-let [format (state/get-journal-file-name-format)]\n                    (tf/formatter format)\n                    default-journal-title-formatter)]\n    (tf/unparse formatter date)))\n\n(defn journal-title->custom-format\n  [journal-title]\n  (journal-title-> journal-title #(date-time-util/format % (state/get-date-formatter))))\n\n(defn int->local-time-2\n  [n]\n  (tf/unparse\n   (tf/formatter \"yyyy-MM-dd HH:mm\")\n   (t/to-default-time-zone (tc/from-long n))))\n\n(comment\n  (def default-formatter (tf/formatter \"MMM do, yyyy\"))\n  (def zh-formatter (tf/formatter \"YYYY\u5e74MM\u6708dd\u65e5\"))\n\n  (tf/show-formatters)\n\n  ;; :date 2020-05-31\n  ;; :rfc822 Sun, 31 May 2020 03:00:57 Z\n)\n"]}